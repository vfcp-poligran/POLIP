/**
 * Mixins Reutilizables
 * Funciones SCSS para patrones comunes de diseño
 */

@use 'sass:map';
@use 'variables' as *;

// ============================================
// RESPONSIVE BREAKPOINTS
// ============================================

/**
 * Mixin para media queries responsive
 * @param {string} $breakpoint - Nombre del breakpoint (xs, sm, md, lg, xl)
 * @example
 *   @include respond-to('md') {
 *     padding: 20px;
 *   }
 */
@mixin respond-to($breakpoint) {
    @if map.has-key($breakpoints, $breakpoint) {
        @media (min-width: map.get($breakpoints, $breakpoint)) {
            @content;
        }
    }

    @else {
        @warn "Breakpoint '#{$breakpoint}' no existe. Usa: xs, sm, md, lg, xl";
    }
}

/**
 * Mixin para max-width media queries
 * @param {string} $breakpoint - Nombre del breakpoint
 */
@mixin respond-to-max($breakpoint) {
    @if map.has-key($breakpoints, $breakpoint) {
        $bp-value: map.get($breakpoints, $breakpoint);

        @media (max-width: $bp-value - 1px) {
            @content;
        }
    }
}

/**
 * Mixin para rangos de breakpoints
 * @param {string} $min - Breakpoint mínimo
 * @param {string} $max - Breakpoint máximo
 */
@mixin respond-between($min, $max) {
    @if map.has-key($breakpoints, $min) and map.has-key($breakpoints, $max) {
        $min-value: map.get($breakpoints, $min);
        $max-value: map.get($breakpoints, $max);

        @media (min-width: $min-value) and (max-width: $max-value - 1px) {
            @content;
        }
    }
}

// ============================================
// ACCESIBILIDAD
// ============================================

/**
 * Touch target accesible (WCAG 2.1 Level AAA)
 * Garantiza mínimo 44x44px en móvil
 */
@mixin touch-target {
    min-width: $touch-target-min;
    min-height: $touch-target-min;

    @include respond-to('md') {
        min-width: $touch-target-desktop;
        min-height: $touch-target-desktop;
    }
}

/**
 * Área de toque extendida invisible
 * Aumenta el área clickeable sin cambiar el visual
 */
@mixin extended-touch-area($size: 8px) {
    position: relative;

    &::after {
        content: '';
        position: absolute;
        top: -$size;
        right: -$size;
        bottom: -$size;
        left: -$size;
        z-index: -1;
    }
}

/**
 * Focus visible para navegación por teclado
 */
@mixin focus-visible($color: $azul-claro, $offset: 2px) {
    &:focus-visible {
        outline: 2px solid $color;
        outline-offset: $offset;
    }
}

// ============================================
// LAYOUT
// ============================================

/**
 * Flexbox center (horizontal y vertical)
 */
@mixin flex-center {
    display: flex;
    align-items: center;
    justify-content: center;
}

/**
 * Flexbox center vertical
 */
@mixin flex-center-vertical {
    display: flex;
    align-items: center;
}

/**
 * Flexbox center horizontal
 */
@mixin flex-center-horizontal {
    display: flex;
    justify-content: center;
}

/**
 * Flexbox con gap
 */
@mixin flex-gap($gap) {
    display: flex;
    gap: $gap;
}

/**
 * Grid con auto-fit
 * @param {size} $min-width - Ancho mínimo de columna
 * @param {size} $gap - Espacio entre elementos
 */
@mixin auto-grid($min-width: 250px, $gap: spacing('md')) {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr));
    gap: $gap;
}

// ============================================
// TIPOGRAFÍA
// ============================================

/**
 * Truncate text con ellipsis
 */
@mixin truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/**
 * Truncate text con número de líneas
 * @param {number} $lines - Número de líneas antes de truncar
 */
@mixin line-clamp($lines: 2) {
    display: -webkit-box;
    -webkit-line-clamp: $lines;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/**
 * Aplicar escala tipográfica
 * @param {string} $size - Tamaño (xs, sm, base, lg, xl, 2xl, 3xl, 4xl)
 * @param {string} $weight - Peso (light, normal, medium, semibold, bold)
 * @param {string} $line-height - Line height (tight, normal, relaxed)
 */
@mixin typography($size: 'base', $weight: 'normal', $line-height: 'normal') {
    font-size: map.get($font-sizes, $size);
    font-weight: map.get($font-weights, $weight);
    line-height: map.get($line-heights, $line-height);
}

// ============================================
// EFECTOS VISUALES
// ============================================

/**
 * Card elevation con sombra
 * @param {number} $level - Nivel de elevación (1-4)
 */
@mixin card-elevation($level: 1) {
    @if $level ==1 {
        box-shadow: $shadow-sm;
    }

    @else if $level ==2 {
        box-shadow: $shadow-md;
    }

    @else if $level ==3 {
        box-shadow: $shadow-lg;
    }

    @else {
        box-shadow: $shadow-xl;
    }
}

/**
 * Smooth transition
 * @param {string} $property - Propiedad a animar (default: all)
 * @param {duration} $duration - Duración (default: $transition-base)
 * @param {function} $easing - Función de easing (default: $ease-in-out)
 */
@mixin transition($property: all, $duration: $transition-base, $easing: $ease-in-out) {
    transition: $property $duration $easing;
}

/**
 * Hover lift effect
 * @param {size} $distance - Distancia de elevación
 */
@mixin hover-lift($distance: 2px) {
    @include transition(transform);

    &:hover {
        transform: translateY(-$distance);
    }
}

/**
 * Glassmorphism effect
 * @param {color} $bg-color - Color de fondo
 * @param {number} $opacity - Opacidad (0-1)
 * @param {size} $blur - Blur del backdrop
 */
@mixin glassmorphism($bg-color: white, $opacity: 0.1, $blur: 10px) {
    background: rgba($bg-color, $opacity);
    backdrop-filter: blur($blur);
    -webkit-backdrop-filter: blur($blur);
}

// ============================================
// POSICIONAMIENTO
// ============================================

/**
 * Absolute center
 */
@mixin absolute-center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

/**
 * Absolute full
 * Cubre todo el contenedor padre
 */
@mixin absolute-full {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
}

/**
 * Fixed full
 * Cubre toda la ventana
 */
@mixin fixed-full {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
}

// ============================================
// UTILIDADES
// ============================================

/**
 * Hide scrollbar pero mantener funcionalidad
 */
@mixin hide-scrollbar {
    scrollbar-width: none; // Firefox
    -ms-overflow-style: none; // IE/Edge

    &::-webkit-scrollbar {
        display: none; // Chrome/Safari
    }
}

/**
 * Custom scrollbar
 * @param {size} $width - Ancho del scrollbar
 * @param {color} $track-color - Color del track
 * @param {color} $thumb-color - Color del thumb
 */
@mixin custom-scrollbar($width: 8px, $track-color: $gris-claro, $thumb-color: $gris-medio) {
    &::-webkit-scrollbar {
        width: $width;
        height: $width;
    }

    &::-webkit-scrollbar-track {
        background: $track-color;
        border-radius: $radius-full;
    }

    &::-webkit-scrollbar-thumb {
        background: $thumb-color;
        border-radius: $radius-full;

        &:hover {
            background: darken($thumb-color, 10%);
        }
    }
}

/**
 * Aspect ratio
 * @param {number} $width - Ancho
 * @param {number} $height - Alto
 */
@mixin aspect-ratio($width: 16, $height: 9) {
    aspect-ratio: $width / $height;

    // Fallback para navegadores antiguos
    @supports not (aspect-ratio: 1) {
        &::before {
            content: '';
            display: block;
            padding-top: percentage($height / $width);
        }
    }
}

/**
 * Reset de lista
 */
@mixin reset-list {
    margin: 0;
    padding: 0;
    list-style: none;
}

/**
 * Reset de botón
 */
@mixin reset-button {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    font: inherit;
    color: inherit;
}