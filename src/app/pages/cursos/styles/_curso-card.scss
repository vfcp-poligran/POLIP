/**
 * Estilos para Cards de Curso
 * Diseño moderno con barra de color, jerarquía visual y estadísticas
 */

@use 'sass:color';
@use 'sass:map';
@use '../styles/variables' as *;
@use '../styles/mixins' as *;
@use '../../../shared/styles/breakpoints' as bp;
@use '../../../shared/styles/typography-mixins' as typo; // Typography mixins

// ============================================
// CARD PRINCIPAL
// ============================================

.curso-card {
    margin-bottom: spacing('md');
    border-radius: $radius-lg;
    overflow: visible; // Permite que los tooltips se vean fuera de la card
    @include card-elevation(2);
    @include transition(all, $transition-base);

    &:hover {
        @include card-elevation(3);
        transform: translateY(-2px);
    }
}

// ============================================
// HEADER
// ============================================

.curso-card-header {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.375rem 0.625rem; // Mobile (XS) default ~6px 10px

    @include bp.respond-to(sm) {
        padding: 0.5rem 0.75rem; // ~8px 12px
    }

    @include bp.respond-to(md) {
        padding: 0.625rem 0.875rem; // ~10px 14px
    }

    @include bp.respond-to(lg) {
        padding: 0.75rem 1rem; // ~12px 16px
    }

    .curso-header-info {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 0.5rem;

        .header-icon {
            font-size: 1.25rem;
            color: var(--ion-color-primary);
        }

        // USANDO NUEVO SISTEMA TIPOGRÁFICO
        .header-main-title {
            margin: 0;
            @include typo.typography-card-header;
            color: $azul-oscuro;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
    }

    .header-info-item {
        display: flex;
        align-items: center;
        gap: 4px;
        @include typography('xs', 'bold');
        color: var(--ion-color-primary) !important;

        .label {
            color: inherit;
            font-weight: font-weight('bold');
        }

        .value {
            color: inherit;
            font-weight: font-weight('bold');
        }
    }
}

.curso-title-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: spacing('sm');
}

.curso-nombre {
    @include typography('lg', 'semibold', 'tight');
    color: $azul-oscuro;
    margin: 0;
    flex: 1;
    @include truncate;
}

.curso-status-chip {
    margin-left: spacing('sm');
    flex-shrink: 0;
}

// ============================================
// ESTADÍSTICAS
// ============================================

.curso-stats {
    display: flex;
    gap: spacing('lg');
    margin-top: spacing('sm');
    padding-top: spacing('sm');
    border-top: 1px solid rgba($azul-oscuro, 0.1);

    .stat-item {
        @include flex-center-vertical;
        gap: spacing('xs');
        color: rgba($azul-oscuro, 0.7);

        ion-icon {
            font-size: 1.25rem;
            color: $azul-claro;
        }

        .stat-label {
            @include typography('sm', 'normal');
        }

        .stat-value {
            @include typography('lg', 'semibold');
            color: $azul-oscuro;
        }
    }
}

// ============================================
// INFORMACIÓN SECUNDARIA
// ============================================

.curso-info-row {
    display: flex;
    gap: spacing('md');
    margin-top: spacing('sm');
    flex-wrap: wrap;

    .info-item {
        @include flex-center-vertical;
        gap: spacing('xs');
        @include typography('sm', 'normal');
        color: rgba($azul-oscuro, 0.6);

        ion-icon {
            font-size: 1rem;
            color: rgba($azul-claro, 0.7);
        }

        strong {
            color: $azul-oscuro;
            font-weight: map.get($font-weights, 'medium');
        }
    }
}

// ============================================
// ACCIONES
// ============================================

.card-actions {
    position: relative;
    @include flex-gap(spacing('xs'));

    ion-button {
        --padding-start: #{spacing('sm')};
        --padding-end: #{spacing('sm')};

        &::part(native) {
            @include touch-target;
        }
    }
}

// ============================================
// CONTENT
// ============================================

.curso-card-content {
    padding: 0 spacing('sm') spacing('sm');
    border: none !important;
    box-shadow: none;
}

// ============================================
// RESPONSIVE
// ============================================

@include respond-to-max('md') {
    .curso-card-header {
        padding: spacing('sm');

        .curso-nombre {
            font-size: font-size('base');
        }
    }

    .curso-stats {
        flex-direction: column;
        gap: spacing('sm');

        .stat-item {
            .stat-label {
                font-size: font-size('xs');
            }

            .stat-value {
                font-size: font-size('base');
            }
        }
    }

    .curso-info-row {
        flex-direction: column;
        gap: spacing('xs');

        .info-item {
            font-size: font-size('xs');
        }
    }

    .card-actions {
        top: spacing('sm');
        right: spacing('sm');

        ion-button {
            --padding-start: #{spacing('xs')};
            --padding-end: #{spacing('xs')};
        }
    }

    .curso-card-content {
        padding: 0 spacing('sm') spacing('sm');
    }
}

// ============================================
// ESTADOS
// ============================================

.curso-card {

    // Estado activo
    &.active {
        border: 2px solid $azul-claro;

        &::before {
            height: 6px;
        }
    }

    // Estado sin datos
    &.no-data {
        opacity: 0.8;

        &::before {
            background: linear-gradient(90deg, $azul-claro, color.adjust($azul-claro, $lightness: 10%));
        }
    }

    // Estado de carga
    &[aria-busy="true"] {
        pointer-events: none;
        opacity: 0.6;
    }

    // Estado nuevo (Creación)
    &.es-nuevo {
        border: none;
        background: rgba($azul-claro, 0.05);
        @include card-elevation(4);
    }
}

@keyframes pulse-border-new {

    0%,
    100% {
        border-color: rgba($color-success, 0.4);
    }

    50% {
        border-color: rgba($color-success, 0.8);
    }
}

// ============================================
// ANIMACIONES
// ============================================

@keyframes pulse-border {

    0%,
    100% {
        border-color: $azul-claro;
    }

    50% {
        border-color: color.adjust($azul-claro, $lightness: 20%);
    }
}

.curso-card.active {
    animation: pulse-border 2s ease-in-out infinite;
}

// ============================================
// ACCESIBILIDAD
// ============================================

.curso-card {
    @include focus-visible($azul-claro, 3px);

    // Mejorar contraste en modo oscuro
    @media (prefers-color-scheme: dark) {
        background: rgba(255, 255, 255, 0.05);

        .curso-nombre {
            color: color.adjust($azul-claro, $lightness: 20%);
        }

        .curso-stats .stat-item {
            color: rgba(255, 255, 255, 0.7);

            .stat-value {
                color: white;
            }
        }
    }

    // Alto contraste
    @media (prefers-contrast: high) {
        border: 2px solid currentColor;

        &::before {
            height: 6px;
        }
    }
}