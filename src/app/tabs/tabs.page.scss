/* ============================================================
   CONFIGURACIÓN DE LAYOUT SIN ION-SPLIT-PANE
   Layout simple: ion-menu (móvil) + ion-card sidebar (desktop)
   ============================================================ */

/* Host element - usar flexbox para layout */
:host {
  display: flex;
  flex-direction: row;
  width: 100%;
  height: 100%;
  position: relative;
}

/* Desktop sidebar styles removed (unused) */


/* Contenedor principal - SOLO div sin ion-tabs */
.shell-container {
  width: 100%;
  height: 100%;
  position: relative;

  // En desktop, agregar padding-top para la navegación fija
  @media (min-width: 992px) {
    padding-top: 64px; // Altura de desktop-nav-bar
  }
}

div#main-content.main-content-area,
div.main-content-area {
  display: block;
  width: 100%;
  height: 100%;
  position: relative;
  overflow: hidden;
  transition: right 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);

  /* FIX: Padding dinámico para compensar Header Móvil + Notch */
  padding-top: calc(48px + env(safe-area-inset-top));

  &.full-width {
    right: 0 !important;
  }


  @media (min-width: 992px) {
    position: fixed;
    top: 0; // Start from top
    bottom: 0;
    left: 0;
    right: 360px;
    width: auto;
    z-index: 1;
    padding-top: 64px; // Add padding to account for fixed nav bar
  }

  @media (min-width: 1600px) {
    right: 420px;
  }

  ion-router-outlet {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: auto;
    height: 100%;
    pointer-events: auto;
    overflow: hidden;
  }
}

/* ion-menu solo visible en móvil (desktop usa .desktop-sidebar) */
.sidebar-menu {
  --background: var(--azul-oscuro, #0f385a);
  --width: 220px;
  --max-width: 240px;

  ion-content {
    --background: var(--azul-oscuro, #0f385a);
  }

  ion-header ion-toolbar {
    --background: var(--azul-oscuro, #0f385a);
    --color: white;
    padding: 8px 12px;
  }

  /* Título de la app en el sidebar */
  .sidebar-app-title {
    font-size: 0.95rem;
    font-weight: 600;
    letter-spacing: 0.3px;
    color: #ffffff;
  }

  ion-footer ion-toolbar {
    --background: var(--azul-oscuro, #0f385a);
    --color: white;
    padding: 6px 12px;
  }
}

/* ========================================
   MOBILE HEADER - Top Bar
   ======================================== */
.mobile-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 100;

  ion-toolbar {
    --background: var(--azul-oscuro, #0f385a);
    --color: white;
    --min-height: 48px;
    --padding-start: 8px;
    --padding-end: 8px;
  }

  .mobile-app-title {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 8px;
    font-size: 0.95rem;
    font-weight: 600;

    .header-logo-avatar {
      width: 28px;
      height: 28px;
    }

    .app-title-stack {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      line-height: 1;
      gap: 1px;

      .title-main {
        font-size: 0.95rem;
        font-weight: 700;
        letter-spacing: 0.5px;
        line-height: 1.1;
      }

      .title-sub {
        font-size: 0.6rem;
        font-weight: 500;
        letter-spacing: 0.3px;
        opacity: 0.9;
        line-height: 1.1;
      }
    }

    span {
      letter-spacing: 0.3px;
    }
  }

  ion-button {
    --color: white;

    ion-icon {
      font-size: 22px;
    }
  }

  // Landscape móvil - más compacto
  @media (max-height: 500px) and (orientation: landscape) {
    ion-toolbar {
      --min-height: 40px;
    }

    .mobile-app-title {
      font-size: 0.85rem;

      .header-logo-avatar {
        width: 24px;
        height: 24px;
      }
    }

    ion-button ion-icon {
      font-size: 20px;
    }
  }
}

/* ========================================
   DESKTOP NAV BAR
   ======================================== */
.desktop-nav-bar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 64px;
  padding: 0 24px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  background: var(--azul-oscuro, #0f385a);
  color: #ffffff;
  z-index: 90;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);

  ion-buttons {
    display: flex;
    gap: 4px;
  }

  ion-button {
    --color: #ffffff;
    --background: transparent;
    --background-hover: rgba(255, 255, 255, 0.15);
    --border-radius: 8px;
    margin: 0;

    &[fill='solid'] {
      --background: #ffffff;
      --color: var(--azul-oscuro, #0f385a);
    }
  }

  .desktop-nav-brand {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 600;
    letter-spacing: 0.3px;

    .header-logo-avatar {
      width: 36px;
      height: 36px;
    }

    .app-title-stack {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      line-height: 1;
      gap: 1px;

      .title-main {
        font-size: 1.25rem;
        font-weight: 700;
        letter-spacing: 0.5px;
        line-height: 1.1;
      }

      .title-sub {
        font-size: 0.75rem;
        font-weight: 500;
        letter-spacing: 0.3px;
        opacity: 0.9;
        line-height: 1.1;
      }
    }
  }
}

@media (max-width: 991px) {
  .desktop-nav-bar {
    display: none;
  }
}

/* ========================================
   MOBILE BOTTOM TAB BAR
   Clean, standardized styles without hacks
   WCAG compliant touch targets (48px minimum)
   ======================================== */
.mobile-bottom-tabs {
  // Positioning
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 100;

  // Styling
  --background: var(--azul-oscuro, #0f385a);
  --border: none;
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.15);

  // Sizing - WCAG touch target
  height: calc(56px + env(safe-area-inset-bottom, 0px));
  padding-bottom: env(safe-area-inset-bottom, 0px);

  ion-tab-button {
    // Colors
    --color: rgba(255, 255, 255, 0.65);
    --color-selected: #ffffff;
    --background: transparent;
    --background-focused: rgba(255, 255, 255, 0.1);

    // Sizing - touch target
    min-height: 48px;
    padding-block: 6px;

    // Animation
    transition: color 0.2s ease;

    ion-icon {
      font-size: 22px;
      margin-bottom: 2px;
    }

    ion-label {
      font-size: 0.65rem;
      font-weight: 500;
      text-transform: none;
      letter-spacing: 0.2px;
    }

    // Selected state
    &.tab-selected {
      --color: var(--azul-claro, #1fb2de);

      ion-icon {
        transform: scale(1.08);
      }
    }

    // Hover state
    &:hover:not(.tab-selected) {
      --color: rgba(255, 255, 255, 0.85);
    }
  }

  // Landscape optimization
  @media (orientation: landscape) and (max-height: 500px) {
    height: calc(48px + env(safe-area-inset-bottom, 0px));

    ion-tab-button {
      min-height: 44px;
      padding-block: 4px;

      ion-icon {
        font-size: 20px;
        margin-bottom: 1px;
      }

      ion-label {
        font-size: 0.6rem;
      }
    }
  }

  // Tablet adjustments
  @media (min-width: 768px) and (max-width: 991px) {
    height: calc(52px + env(safe-area-inset-bottom, 0px));

    ion-tab-button {
      min-height: 48px;

      ion-icon {
        font-size: 20px;
      }

      ion-label {
        font-size: 0.62rem;
      }
    }
  }
}

/* Ajuste del contenido principal cuando hay bottom tabs */
.main-content-area.has-bottom-tabs {
  padding-top: 48px; // Espacio para header
  padding-bottom: 56px; // Espacio para bottom tabs

  @media (max-height: 500px) and (orientation: landscape) {
    padding-top: 40px;
    padding-bottom: 48px;
  }

  @media (min-width: 768px) and (max-width: 1024px) {
    padding-bottom: 52px;
  }
}

// ========================================
// BARRA DE BÚSQUEDA FLOTANTE
// ========================================
.floating-search-container {
  position: fixed;
  top: 20px;
  left: 100px;
  right: 20px;
  z-index: 100;
  background: var(--azul-oscuro);
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  padding: 8px;
  animation: slideInFromLeft 0.3s ease-out;

  @media (max-width: 768px) {
    left: 80px;
  }

  @media (max-width: 480px) {
    left: 70px;
    right: 10px;
  }
}

.floating-searchbar {
  --background: rgba(255, 255, 255, 0.95);
  --border-radius: 6px;
  --box-shadow: none;
}

@keyframes slideInFromLeft {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }

  to {
    opacity: 1;
    transform: translateX(0);
  }
}

// ========================================
// PANEL DE BÚSQUEDA MÓVIL DESPLEGABLE
// ========================================
.mobile-search-panel {
  background: var(--azul-oscuro, #0f385a);
  padding: 8px 12px 12px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);

  .global-searchbar {
    --background: rgba(255, 255, 255, 0.95);
    --border-radius: 8px;
    --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    --placeholder-color: #666;
    --icon-color: var(--azul-oscuro);
    margin: 0;
    padding: 0;
  }

  .search-results-panel {
    margin-top: 8px;
    max-height: 300px;
    overflow-y: auto;
    background: rgba(255, 255, 255, 0.98);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);

    .search-result-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.06);
      cursor: pointer;
      transition: background 0.15s ease;

      &:last-child {
        border-bottom: none;
      }

      &:hover, &:active {
        background: rgba(31, 178, 222, 0.08);
      }

      ion-icon {
        font-size: 20px;
        color: var(--azul-oscuro);
        flex-shrink: 0;

        &.chevron {
          color: #999;
          font-size: 16px;
          margin-left: auto;
        }
      }

      .result-info {
        flex: 1;
        min-width: 0;

        .result-name {
          display: block;
          font-size: 0.9rem;
          font-weight: 500;
          color: #333;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .result-meta {
          display: block;
          font-size: 0.75rem;
          color: #666;
          margin-top: 2px;
        }
      }
    }
  }
}

// Ajuste del contenido cuando el panel de búsqueda está abierto
.main-content-area.search-open {
  padding-top: calc(48px + 60px + env(safe-area-inset-top)); // Header + Search panel
}

// ========================================
// LOGO EN SIDEBAR
// ========================================
.sidebar-logo-container {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 8px;
  margin-bottom: 8px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  background: rgba(255, 255, 255, 0.95);
  border-radius: 8px;

  .sidebar-logo {
    width: 48px;
    height: 48px;
    object-fit: contain;
    transition: transform 0.3s ease;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));

    &:hover {
      transform: scale(1.05);
    }
  }

  @media (max-width: 768px) {
    padding: 12px 0 8px 0;

    .sidebar-logo {
      width: 40px;
      height: 40px;
    }
  }

  @media (max-width: 480px) {
    padding: 10px 0 8px 0;

    .sidebar-logo {
      width: 36px;
      height: 36px;
    }
  }
}

// ========================================
// SIDEBAR NAVEGACIÓN
// ========================================
.sidebar-nav-buttons {
  display: flex;
  flex-direction: column;
  gap: 2px;
  width: 100%;
  margin-top: 0;
  flex: 1;
}

.sidebar-tab {
  --width: 56px;
  --height: 56px;
  --min-height: 56px;
  width: 56px;
  height: 56px;
  border-radius: 8px;
  background: transparent;
  transition: all 0.2s ease;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  margin: 6px auto;

  ion-icon {
    font-size: 31.2px;
    color: rgba(255, 255, 255, 0.65);
    transition: all 0.2s ease;
  }

  &:hover {
    background: rgba(255, 255, 255, 0.08);
    transform: translateY(-1px);

    ion-icon {
      color: rgba(255, 255, 255, 0.9);
    }
  }

  &.tab-selected,
  &.active {
    background: #ffffff;
    border-radius: 8px;

    ion-icon {
      color: var(--azul-claro);
      transform: scale(1.05);
    }

    &::before {
      display: none;
    }
  }
}

.sidebar-controls {
  display: flex;
  flex-direction: column;
  gap: 4px;
  width: 100%;
  margin-top: auto;
  padding-top: 12px;
  border-top: 1px solid rgba(255, 255, 255, 0.08);
}

.sidebar-control-button {
  width: 100%;
  height: 44px;
  --padding-start: 0;
  --padding-end: 0;

  ion-icon {
    font-size: 20px;
    color: rgba(255, 255, 255, 0.65);
  }

  &:hover ion-icon {
    color: rgba(255, 255, 255, 0.9);
  }
}

// ========================================


// ========================================
// LOGO CONTAINER (Legacy)
// ========================================
.logo-container {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 50;
  width: 100%;
  padding: 8px 0;
  flex-shrink: 0;
  order: 0;


  .app-logo {
    width: 48px;
    height: auto;
    max-width: 100%;
    object-fit: contain;
  }

  @media (max-width: 768px) {
    padding: 3px 0;
  }
}

// ========================================
// LOGO
// ========================================
.app-logo {
  height: 50px;
  width: 95px;
  object-fit: contain;

  @media (max-width: 768px) and (min-width: 481px) {
    height: 40px;
    width: 75px;
  }

  @media (max-width: 480px) {
    height: 28px;
    width: 55px;
  }

  @media (max-width: 960px) and (orientation: landscape) {
    height: 24px;
    width: 48px;
  }
}

// ========================================
// ION-CONTENT & ION-HEADER
// ========================================

ion-header {
  position: relative;
  z-index: 10;
}





// ========================================
// CONFIGURATION SEGMENT TABS IN HEADER
// ========================================
.config-segment {
  --background: transparent;
  margin: 0;
  padding: 0;
  background: transparent;
  display: flex;
  align-items: center;
  min-height: 96.6px;
  position: relative;
  left: auto;
  margin-left: auto;
  z-index: 5;
  gap: 5px;
  overflow-x: auto;
  overflow-y: hidden;
  max-width: 60%;
  order: 3;

  /* Mejora progresiva: ocultar scrollbar en navegadores compatibles */
  /* Webkit browsers (Safari, Chrome, Edge) */
  &::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
  }

  /* Fallback: IE and very old browsers */
  -ms-overflow-style: none;

  /* Additional webkit fallback for iOS Safari */
  &::-webkit-scrollbar-track {
    background: transparent;
  }

  &::-webkit-scrollbar-thumb {
    background: transparent;
  }

  // RESPONSIVE: Pantallas muy grandes
  @media (min-width: 1920px) {
    left: 480px;
    max-width: calc(100vw - 500px);
  }

  // RESPONSIVE: Pantallas grandes
  @media (max-width: 1919px) and (min-width: 1600px) {
    left: 480px;
    gap: 4px;
    max-width: calc(100vw - 500px);
  }

  // RESPONSIVE: Pantallas medianas-grandes
  @media (max-width: 1599px) and (min-width: 1200px) {
    left: 480px;
    gap: 3px;
    max-width: calc(100vw - 500px);
  }

  // RESPONSIVE: Tabletas - Mostrar con scroll
  @media (max-width: 1199px) and (min-width: 768px) {
    left: 320px;
    gap: 2px;
    max-width: calc(100vw - 340px);
    flex-wrap: nowrap; // No envolver
  }

  // RESPONSIVE: MÓVILES EN LANDSCAPE PERMANENTE
  // Ajuste dinámico de íconos para pantallas móviles
  @media (max-width: 1023px) {
    position: fixed;
    top: 96.6px; // Justo debajo del header
    left: 0;
    right: 0;
    width: 100%;
    max-width: 100%;
    min-height: 50px; // Reducido para landscape
    background: var(--azul-oscuro);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding: 3.8px 7.6px; // Reducido 5%: 4px → 3.8px, 8px → 7.6px
    z-index: 50;
    /* Reducido - solo debe estar sobre contenido, no bloquear */
    display: flex;
    justify-content: space-around;
    align-items: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    gap: 4px;
  }

  // RESPONSIVE: Pantallas muy pequeñas (landscape móvil típico)
  @media (max-width: 800px) {
    min-height: 48px;
    padding: 2.85px 5.7px; // Reducido 5%: 3px → 2.85px, 6px → 5.7px
  }

  ion-segment-button {
    --color: #ffffff;
    --color-checked: #ffffff;
    --color-hover: #ffffff;
    --background: transparent;
    --background-checked: transparent;
    --background-hover: transparent;
    --border-radius: 0;
    --padding-start: 2px;
    --padding-end: 2px;
    --padding-top: 2px;
    --padding-bottom: 2px;
    --indicator-height: 0;
    margin: 2px;
    padding: 2px;
    width: 140px; // Aumentado para que quepa "Calificaciones"
    min-width: 140px;
    max-width: 140px;
    height: 96.6px;
    min-height: 96.6px;
    max-height: 96.6px;
    border: none;
    position: relative;

    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 4px;
    flex-shrink: 0;

    // RESPONSIVE: Pantallas medianas-grandes
    @media (max-width: 1599px) and (min-width: 1400px) {
      width: 135px; // Aumentado
      min-width: 135px;
      max-width: 135px;
    }

    // RESPONSIVE: Tabletas grandes
    @media (max-width: 1399px) and (min-width: 1200px) {
      width: 125px; // Aumentado
      min-width: 125px;
      max-width: 125px;
    }

    // RESPONSIVE: Tabletas medianas
    @media (max-width: 1199px) and (min-width: 1024px) {
      width: 115px; // Aumentado
      min-width: 115px;
      max-width: 115px;
    }

    // RESPONSIVE: Tabletas pequeñas
    @media (max-width: 1023px) and (min-width: 768px) {
      width: 105px; // Aumentado
      min-width: 105px;
      max-width: 105px;
    }

    // RESPONSIVE: MÓVILES LANDSCAPE PERMANENTE
    // Ajuste dinámico según ancho de pantalla
    @media (max-width: 767px) {
      width: calc((100vw - 32px) / 4); // Distribuir en 4 columnas dinámicamente
      min-width: 60px;
      max-width: 100px;
      height: 48px; // Reducido para landscape
      min-height: 48px;
      max-height: 48px;
    }

    // RESPONSIVE: Pantallas muy pequeñas (landscape móvil típico)
    @media (max-width: 800px) and (min-width: 600px) {
      width: calc((100vw - 40px) / 4);
      min-width: 70px;
      max-width: 110px;
    }

    // RESPONSIVE: Pantallas ultra pequeñas
    @media (max-width: 599px) {
      width: calc((100vw - 24px) / 4);
      min-width: 55px;
      max-width: 90px;
      height: 46px;
      min-height: 46px;
      max-height: 46px;
    }

    ion-label {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
      color: #ffffff;
      font-weight: 600;
      font-size: 0.18rem; // Reducido 10% adicional: 0.2 * 0.9 = 0.18rem
      padding: 0;
      margin: 0;
      text-align: center;
      white-space: nowrap; // Sin saltos de línea
      line-height: 1.1;
      max-width: 100%;
      overflow: visible;

      // RESPONSIVE: Desktop grande
      @media (min-width: 1400px) {
        font-size: 0.2025rem; // Reducido 10% adicional: 0.225 * 0.9 = 0.2025rem
      }

      // RESPONSIVE: Reducir fuente en pantallas más pequeñas
      @media (max-width: 1199px) and (min-width: 1024px) {
        font-size: 0.171rem; // Reducido 10% adicional: 0.19 * 0.9 = 0.171rem
      }

      @media (max-width: 1023px) and (min-width: 768px) {
        font-size: 0.1575rem; // Reducido 10% adicional: 0.175 * 0.9 = 0.1575rem
      }

      // RESPONSIVE: MÓVILES LANDSCAPE - Fuentes ajustadas
      @media (max-width: 767px) {
        font-size: 0.55rem;
        gap: 2px;
        font-weight: 600;
        line-height: 1;
      }

      @media (max-width: 599px) {
        font-size: 0.5rem;
        gap: 2px;
      }

      ion-icon {
        font-size: 0.3384rem; // Reducido 40%: 0.564 * 0.6 = 0.3384rem
        color: #ffffff;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 10.64px; // Reducido 40%: 17.74 * 0.6 = 10.64px
        height: 10.64px;
        border-radius: 50%;
        flex-shrink: 0;
        box-sizing: border-box;
        padding: 2.18px; // Reducido 40%: 3.63 * 0.6 = 2.18px
        margin: 0;

        // RESPONSIVE: Desktop extra grande (1920px+) - Círculos más grandes
        @media (min-width: 1920px) {
          width: 13.2px; // Reducido 40%: 22 * 0.6 = 13.2px
          height: 13.2px;
          font-size: 0.42rem; // Reducido 40%: 0.7 * 0.6 = 0.42rem
          padding: 2.7px; // Reducido 40%: 4.5 * 0.6 = 2.7px
        }

        // RESPONSIVE: Desktop grande (1400-1919px) - Círculos grandes
        @media (min-width: 1400px) and (max-width: 1919px) {
          width: 12px; // Reducido 40%: 20 * 0.6 = 12px
          height: 12px;
          font-size: 0.384rem; // Reducido 40%: 0.64 * 0.6 = 0.384rem
          padding: 2.52px; // Reducido 40%: 4.2 * 0.6 = 2.52px
        }

        // RESPONSIVE: Desktop medio (1200-1399px) - Círculos medianos-grandes
        @media (min-width: 1200px) and (max-width: 1399px) {
          width: 11.4px; // Reducido 40%: 19 * 0.6 = 11.4px
          height: 11.4px;
          font-size: 0.3648rem; // Reducido 40%: 0.608 * 0.6 = 0.3648rem
          padding: 2.4px; // Reducido 40%: 4 * 0.6 = 2.4px
        }

        // RESPONSIVE: Desktop compacto (1024-1199px) - Círculos medianos
        @media (min-width: 1024px) and (max-width: 1199px) {
          width: 10.8px; // Reducido 40%: 18 * 0.6 = 10.8px
          height: 10.8px;
          font-size: 0.3456rem; // Reducido 40%: 0.576 * 0.6 = 0.3456rem
          padding: 2.28px; // Reducido 40%: 3.8 * 0.6 = 2.28px
        }

        // RESPONSIVE: Tabletas (768-1023px) - Círculos reducidos
        @media (min-width: 768px) and (max-width: 1023px) {
          width: 9.6px; // Reducido 40%: 16 * 0.6 = 9.6px
          height: 9.6px;
          font-size: 0.3072rem; // Reducido 40%: 0.512 * 0.6 = 0.3072rem
          padding: 2.04px; // Reducido 40%: 3.4 * 0.6 = 2.04px
        }

        // RESPONSIVE: MÓVILES LANDSCAPE - Íconos compactos
        @media (max-width: 767px) {
          font-size: 0.6rem; // Reducido 40%: 1 * 0.6 = 0.6rem
          width: 19.2px; // Reducido 40%: 32 * 0.6 = 19.2px
          height: 19.2px;
          padding: 3.6px; // Reducido 40%: 6 * 0.6 = 3.6px
        }

        @media (max-width: 599px) {
          font-size: 0.51rem; // Reducido 40%: 0.85 * 0.6 = 0.51rem
          width: 15.6px; // Reducido 40%: 26 * 0.6 = 15.6px
          height: 15.6px;
          padding: 2.7px; // Reducido 40%: 4.5 * 0.6 = 2.7px
        }

        // RESPONSIVE: Móviles muy pequeños (<400px) - Círculos mínimos
        @media (max-width: 399px) {
          font-size: 0.45rem; // Reducido 40%: 0.75 * 0.6 = 0.45rem
          width: 14.4px; // Reducido 40%: 24 * 0.6 = 14.4px
          height: 14.4px;
          padding: 2.4px; // Reducido 40%: 4 * 0.6 = 2.4px
        }
      }
    }

    &:hover:not(.segment-button-checked) {
      ion-label ion-icon {
        transform: scale(1.1);
      }
    }

    &.segment-button-checked {
      ion-label ion-icon {
        transform: scale(1.05);
      }
    }
  }

  // Colores específicos para cada tab
  ion-segment-button[value="nuevo"] ion-label ion-icon {
    background: var(--azul-claro);

    &:hover {
      box-shadow: 0 4px 12px rgba(31, 178, 222, 0.4);
    }
  }

  ion-segment-button[value="nuevo"].segment-button-checked ion-label ion-icon {
    box-shadow: 0 4px 16px rgba(31, 178, 222, 0.6);
  }

  ion-segment-button[value="herramientas"] ion-label ion-icon {
    background: var(--verde);

    &:hover {
      box-shadow: 0 4px 12px rgba(166, 206, 56, 0.4);
    }
  }

  ion-segment-button[value="herramientas"].segment-button-checked ion-label ion-icon {
    box-shadow: 0 4px 16px rgba(166, 206, 56, 0.6);
  }

  ion-segment-button[value="calificaciones"] ion-label ion-icon {
    background: var(--naranja);

    &:hover {
      box-shadow: 0 4px 12px rgba(251, 175, 23, 0.4);
    }
  }

  ion-segment-button[value="calificaciones"].segment-button-checked ion-label ion-icon {
    box-shadow: 0 4px 16px rgba(251, 175, 23, 0.6);
  }

  ion-segment-button[value="sistema"] ion-label ion-icon {
    background: var(--magenta);

    &:hover {
      box-shadow: 0 4px 12px rgba(236, 6, 119, 0.4);
    }
  }

  ion-segment-button[value="sistema"].segment-button-checked ion-label ion-icon {
    box-shadow: 0 4px 16px rgba(236, 6, 119, 0.6);
  }
}

// Estilo para los botones de tab circulares - Botón Home MEJORADO CON TAMAÑO DE CONFIGURACIÓN
ion-tab-button.circular-tab {
  --color: #ffffff;
  --color-selected: #ffffff;
  --background: transparent;
  --padding-start: 0;
  --padding-end: 0;
  --padding-top: 0;
  --padding-bottom: 0;
  background: linear-gradient(145deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.04));
  -webkit-backdrop-filter: blur(10px);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  height: auto;
  width: auto;
  padding: 0;
  margin: 0;

  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 4px;
  overflow: visible;
  flex-shrink: 0;
  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);

  // Botón de Inicio - CUADRADO PERFECTO con círculo completo
  &.inicio-tab {
    position: relative;
    margin-left: 4px;
    margin-top: 0;
    order: 2;
    flex-basis: auto;
    display: flex;
    align-self: center;
    margin-bottom: 0;
    z-index: 100;
    /* Reducido - solo para hover sobre otros botones */
    flex-shrink: 0;
    margin-right: 12px;

    // Variable para tamaño dinámico
    --tab-size: 56px;

    // DIMENSIONES BASE: CUADRADO PERFECTO MÁS GRANDE
    width: var(--tab-size);
    height: var(--tab-size);
    min-width: var(--tab-size);
    min-height: var(--tab-size);
    max-width: var(--tab-size);
    max-height: var(--tab-size);

    padding: 6px; // Más espacio para el círculo
    border-radius: 12px; // Esquinas redondeadas proporcionales
    gap: 0;
    box-sizing: border-box;

    // NUEVO: Borde cuadrado visible alrededor del círculo
    border: 2px solid rgba(255, 255, 255, 0.5);
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.3), 0 4px 12px rgba(0, 0, 0, 0.2);

    // RESPONSIVE: Desktop base - Cuadrado perfecto MÁS GRANDE
    @media (min-width: 769px) {
      --tab-size: 60px;
      padding: 6px;
      margin-left: 6px;
      margin-right: 12px;
      margin-top: 0;
    }

    // RESPONSIVE: Desktop medio (1024-1199px)
    @media (min-width: 1024px) and (max-width: 1199px) {
      --tab-size: 64px;
      padding: 7px;
      margin-left: 6px;
      margin-right: 14px;
    }

    // RESPONSIVE: Desktop grande (1200-1399px)
    @media (min-width: 1200px) and (max-width: 1399px) {
      --tab-size: 68px;
      padding: 8px;
      margin-left: 8px;
      margin-right: 16px;
    }

    // RESPONSIVE: Desktop extra grande (1400-1919px)
    @media (min-width: 1400px) and (max-width: 1919px) {
      --tab-size: 72px;
      padding: 8px;
      margin-left: 8px;
      margin-right: 18px;
    }

    // RESPONSIVE: Desktop ultra grande (1920px+)
    @media (min-width: 1920px) {
      --tab-size: 76px;
      padding: 9px;
      margin-left: 10px;
      margin-right: 20px;
    }

    // RESPONSIVE: Tabletas (481-768px)
    @media (max-width: 768px) and (min-width: 481px) {
      --tab-size: 52px;
      padding: 6px;
      margin-left: 4px;
      margin-right: 4px;
      margin-top: 0;
    }

    // RESPONSIVE: Móviles (max-width: 480px)
    @media (max-width: 480px) {
      --tab-size: 48px;
      padding: 5px;
      margin-left: 3px;
      margin-right: 3px;
      margin-top: 0;
    }

    // RESPONSIVE: Móviles pequeños (max-width: 360px)
    @media (max-width: 360px) {
      --tab-size: 44px;
      padding: 5px;
      margin-left: 2px;
      margin-right: 2px;
      margin-top: 0;
    }

    // RESPONSIVE: Landscape móvil - Ultra compacto
    @media (max-width: 960px) and (orientation: landscape) {
      --tab-size: 46px;
      padding: 5px;
      margin-left: 3px;
      margin-right: 3px;
      margin-top: 0;
    }

    // Efectos hover - Mejorar el borde cuadrado
    &:hover {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.18), rgba(255, 255, 255, 0.10));
      border-color: rgba(255, 255, 255, 0.6); // Borde más visible en hover
      transform: scale(1.02);
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.3), 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    &.tab-selected {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.22), rgba(255, 255, 255, 0.14));
      border-color: rgba(255, 255, 255, 0.8); // Borde muy visible cuando está seleccionado
      transform: scale(1.04);
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.4), 0 8px 20px rgba(0, 0, 0, 0.25);
    }
  }

  .button-inner {
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 0; // Sin padding
    display: flex;
    gap: 0; // Sin gap
    height: 100%;
    width: 100%;

    // RESPONSIVE: Desktop - Sin gap
    @media (min-width: 769px) {
      gap: 0;
      justify-content: center;
      align-items: center;
    }
  }

  ion-icon {
    margin: 0;
    flex-shrink: 0;
    color: #ffffff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    transition: all 0.3s ease;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);

    // RESPONSIVE: Desktop base (769-1023px)
    @media (min-width: 769px) and (max-width: 1023px) {
      font-size: 1.2rem; // Reducido
      width: 38px; // Círculo más pequeño en cuadrado de 60px
      height: 38px;
      padding: 8px;
    }

    // RESPONSIVE: Desktop medio (1024-1199px)
    @media (min-width: 1024px) and (max-width: 1199px) {
      font-size: 1.3rem; // Reducido
      width: 40px; // Círculo más pequeño en cuadrado de 64px
      height: 40px;
      padding: 9px;
    }

    // RESPONSIVE: Desktop grande (1200-1399px)
    @media (min-width: 1200px) and (max-width: 1399px) {
      font-size: 1.4rem; // Reducido
      width: 42px; // Círculo más pequeño en cuadrado de 68px
      height: 42px;
      padding: 10px;
    }

    // RESPONSIVE: Desktop extra grande (1400-1919px)
    @media (min-width: 1400px) and (max-width: 1919px) {
      font-size: 1.5rem; // Reducido
      width: 44px; // Círculo más pequeño en cuadrado de 72px
      height: 44px;
      padding: 11px;
    }

    // RESPONSIVE: Desktop ultra grande (1920px+)
    @media (min-width: 1920px) {
      font-size: 1.6rem; // Reducido
      width: 46px; // Círculo más pequeño en cuadrado de 76px
      height: 46px;
      padding: 12px;
    }

    // RESPONSIVE: Tabletas (481-768px)
    @media (max-width: 768px) and (min-width: 481px) {
      font-size: 1rem; // Reducido
      width: 32px; // Círculo más pequeño en cuadrado de 52px
      height: 32px;
      padding: 7px;
    }

    // RESPONSIVE: Móviles (max-width: 480px)
    @media (max-width: 480px) {
      font-size: 0.9rem; // Reducido
      width: 30px; // Círculo más pequeño en cuadrado de 48px
      height: 30px;
      padding: 6px;
    }

    // RESPONSIVE: Móviles pequeños (max-width: 360px)
    @media (max-width: 360px) {
      font-size: 0.8rem; // Reducido
      width: 26px; // Círculo más pequeño en cuadrado de 44px
      height: 26px;
      padding: 5px;
    }

    // RESPONSIVE: Landscape móvil - Compacto
    @media (max-width: 960px) and (orientation: landscape) {
      font-size: 0.9rem; // Reducido
      width: 28px; // Círculo más pequeño en cuadrado de 46px
      height: 28px;
      padding: 6px;
    }
  }

  .home-label {
    display: block;
    color: #ffffff;
    font-weight: 500; // Igual que configuración
    text-align: center;
    margin: 0;
    padding: 0;
    white-space: nowrap;
    overflow: visible;
    text-overflow: none;
    transition: all 0.3s ease;

    @media (min-width: 769px) {
      display: none;
    }

    @media (max-width: 768px) {
      font-size: 0.55rem;
      line-height: 1.0;
    }

    @media (max-width: 480px) {
      font-size: 0.5rem;
    }

    @media (max-width: 360px) {
      font-size: 0.45rem;
    }

    @media (max-width: 960px) and (orientation: landscape) {
      font-size: 0.45rem;
    }
  }
}

// ========================================
// LÓGICA DE COLORES PARA TABS CIRCULARES
// ========================================
ion-tab-button[tab="inicio"].circular-tab {
  ion-icon {
    background: var(--magenta);
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  &:hover ion-icon {
    transform: scale(1.08);
    filter: brightness(1.1);
  }

  &.tab-selected ion-icon {
    transform: scale(1.05);
    filter: brightness(1.15);
  }
}

// ========================================
// CONTENEDOR DE BÚSQUEDA DESPLEGABLE - DEBAJO DEL CUSTOM-TAB-BAR
// ========================================
.search-container {
  display: flex;
  align-items: center;
  transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  order: 4; // Posicionado después del config-options-container
  flex-shrink: 0; // No se contrae cuando se expande

  // Estado inicial: solo muestra el botón de lupa
  background: transparent;
  border: none;
  box-shadow: none;

  // RESPONSIVE: Animaciones optimizadas según dispositivo
  @media (prefers-reduced-motion: reduce) {
    transition: none;
  }

  // RESPONSIVE: Optimización para dispositivos táctiles
  @media (hover: none) and (pointer: coarse) {
    // Área táctil mínima recomendada
    min-height: 44px;
    min-width: 44px;
  }

  // RESPONSIVE: Desktop - Como elemento independiente en el tab-bar
  @media (min-width: 769px) {
    display: flex;
    visibility: visible;
    margin-left: 16px; // Espaciado desde el config-options-container
    position: relative; // Posicionamiento relativo para la expansión
  }

  @media (min-width: 1024px) {
    margin-left: 20px;
  }

  @media (min-width: 1200px) {
    margin-left: 24px;
  }

  @media (min-width: 1400px) {
    margin-left: 28px;
  }

  @media (min-width: 1920px) {
    margin-left: 32px;
  }

  // RESPONSIVE: Móviles - ocultar en el desktop menu, se mostrará en el sidebar móvil
  @media (max-width: 768px) {
    display: none; // Ocultar en móviles dentro del desktop-menu
  }

  .search-button {
    --background: linear-gradient(145deg, var(--azul-claro), #1a8cb8);
    --color: white;
    --border-radius: 50%;
    --box-shadow: 0 6px 18px rgba(31, 178, 222, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.2);
    --ripple-color: rgba(255, 255, 255, 0.5);
    margin: 0;
    transition: all 0.3s ease;
    border-radius: 50%;
    flex-shrink: 0;
    border: 2px solid rgba(255, 255, 255, 0.6);
    -webkit-backdrop-filter: blur(8px);
    backdrop-filter: blur(8px);

    // RESPONSIVE: Tamaños base y móvil
    height: 44px; // Tamaño mínimo táctil
    width: 44px;

    // RESPONSIVE: Desktop base
    @media (min-width: 769px) and (max-width: 1023px) {
      height: 52px;
      width: 52px;
    }

    // RESPONSIVE: Desktop medio
    @media (min-width: 1024px) and (max-width: 1199px) {
      height: 56px;
      width: 56px;
    }

    // RESPONSIVE: Desktop grande
    @media (min-width: 1200px) and (max-width: 1399px) {
      height: 60px;
      width: 60px;
    }

    // RESPONSIVE: Desktop extra grande
    @media (min-width: 1400px) and (max-width: 1919px) {
      height: 64px;
      width: 64px;
    }

    // RESPONSIVE: Desktop ultra grande
    @media (min-width: 1920px) {
      height: 68px;
      width: 68px;
    }

    ion-icon {
      transition: transform 0.3s ease;
      font-size: 22px; // Base responsive

      // RESPONSIVE: Móvil pequeño
      @media (max-width: 480px) {
        font-size: 20px;
      }

      // RESPONSIVE: Tabletas
      @media (min-width: 481px) and (max-width: 768px) {
        font-size: 24px;
      }

      // RESPONSIVE: Desktop base
      @media (min-width: 769px) and (max-width: 1023px) {
        font-size: 26px;
      }

      // RESPONSIVE: Desktop medio
      @media (min-width: 1024px) and (max-width: 1199px) {
        font-size: 28px;
      }

      // RESPONSIVE: Desktop grande
      @media (min-width: 1200px) and (max-width: 1399px) {
        font-size: 30px;
      }

      // RESPONSIVE: Desktop extra grande
      @media (min-width: 1400px) and (max-width: 1919px) {
        font-size: 32px;
      }

      // RESPONSIVE: Desktop ultra grande
      @media (min-width: 1920px) {
        font-size: 34px;
      }

      // RESPONSIVE: Animaciones reducidas
      @media (prefers-reduced-motion: reduce) {
        transition: none;
      }
    }

    &:hover {
      --background: linear-gradient(145deg, #0ea5e9, var(--azul-oscuro));
      --box-shadow: 0 8px 24px rgba(31, 178, 222, 0.5), 0 0 0 2px rgba(255, 255, 255, 0.4);
      transform: scale(1.12);
      border-color: rgba(255, 255, 255, 0.8);

      ion-icon {
        transform: rotate(90deg);
      }
    }

    &:active {
      transform: scale(0.95);
    }

    // En móvil
    @media (max-width: 768px) {
      height: 44px;
      width: 44px;
      --background: transparent;

      ion-icon {
        font-size: 22px;
      }
    }
  }

  .header-searchbar {
    --background: rgba(255, 255, 255, 0.9);
    --color: var(--azul-oscuro);
    --placeholder-color: rgba(15, 56, 90, 0.7);
    --border-radius: 20px;
    --box-shadow: 0 2px 8px rgba(31, 178, 222, 0.2);
    --icon-color: var(--azul-claro);
    --clear-button-color: var(--azul-claro);
    border: 1px solid rgba(31, 178, 222, 0.2);

    width: 0;
    opacity: 0;
    overflow: hidden;
    margin-left: 0;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    border: none;

    // RESPONSIVE: Base height
    height: 36px;

    // RESPONSIVE: Tabletas
    @media (min-width: 481px) and (max-width: 768px) {
      height: 38px;
      margin-left: 6px;
    }

    // RESPONSIVE: Desktop base
    @media (min-width: 769px) and (max-width: 1023px) {
      height: 40px;
      margin-left: 8px;
    }

    // RESPONSIVE: Desktop medio
    @media (min-width: 1024px) and (max-width: 1199px) {
      height: 44px;
      margin-left: 10px;
    }

    // RESPONSIVE: Desktop grande
    @media (min-width: 1200px) and (max-width: 1399px) {
      height: 48px;
      margin-left: 12px;
    }

    // RESPONSIVE: Desktop extra grande
    @media (min-width: 1400px) and (max-width: 1919px) {
      height: 52px;
      margin-left: 14px;
    }

    // RESPONSIVE: Desktop ultra grande
    @media (min-width: 1920px) {
      height: 56px;
      margin-left: 16px;
    }

    // RESPONSIVE: Móviles pequeños
    @media (max-width: 480px) {
      height: 32px;
      margin-left: 4px;
    }

    // RESPONSIVE: Animaciones reducidas
    @media (prefers-reduced-motion: reduce) {
      transition: width 0.2s ease, opacity 0.2s ease;
    }

    // Estilos internos del searchbar
    .searchbar-input-container {
      @media (min-width: 769px) {
        height: 46px;
      }

      @media (min-width: 1200px) {
        height: 50px;
      }

      @media (min-width: 1400px) {
        height: 54px;
      }

      @media (max-width: 768px) {
        height: 36px;
      }
    }

    .searchbar-input {
      --padding-start: 20px;
      --padding-end: 20px;
      font-weight: 500;
      text-align: left;
      letter-spacing: 0.2px;

      // RESPONSIVE: Tipografía escalada
      @media (min-width: 769px) {
        font-size: 15px;
      }

      @media (min-width: 1200px) {
        font-size: 16px;
        --padding-start: 24px;
        --padding-end: 24px;
      }

      @media (min-width: 1400px) {
        font-size: 17px;
        --padding-start: 28px;
        --padding-end: 28px;
      }

      @media (max-width: 768px) {
        font-size: 14px;
        --padding-start: 16px;
        --padding-end: 16px;
      }

      &::placeholder {
        font-style: italic;
        opacity: 0.6;
        font-weight: 400;
      }

      /* Asegurar alineación izquierda al recibir foco */
      &:focus {
        text-align: left;
      }
    }

    /* Estilo directo para el input nativo */
    input {
      text-align: left;
      direction: ltr;
    }



    &:hover {
      --background: rgba(255, 255, 255, 1);
      --box-shadow: 0 4px 16px rgba(31, 178, 222, 0.3);
      border-color: var(--azul-claro);
      transform: translateY(-1px);
    }

    &:focus-within {
      --background: rgba(255, 255, 255, 1);
      --box-shadow: 0 0 0 3px rgba(31, 178, 222, 0.2), 0 4px 16px rgba(31, 178, 222, 0.3);
      border-color: var(--azul-claro);
    }
  }

  // Estado expandido: muestra el cuadro de búsqueda desplegable
  &.expanded {

    // RESPONSIVE: Desktop - expansión como elemento independiente
    @media (min-width: 769px) {
      position: absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      width: clamp(300px, 35vw, 400px);
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(248, 250, 252, 0.95));
      -webkit-backdrop-filter: blur(25px);
      backdrop-filter: blur(25px);
      border: 2px solid rgba(31, 178, 222, 0.3);
      box-shadow: 0 8px 32px rgba(31, 178, 222, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.5);
      border-radius: 25px;
      z-index: 200;
      /* Reducido - modal debe estar sobre contenido pero no bloquear fuera */
    }

    @media (min-width: 1024px) {
      width: clamp(320px, 38vw, 450px);
      border-radius: 26px;
      box-shadow: 0 10px 35px rgba(31, 178, 222, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.6);
    }

    @media (min-width: 1200px) {
      width: clamp(360px, 40vw, 500px);
      border-radius: 27px;
      box-shadow: 0 12px 40px rgba(31, 178, 222, 0.35), 0 0 0 1px rgba(255, 255, 255, 0.7);
    }

    @media (min-width: 1400px) {
      width: clamp(400px, 42vw, 550px);
      border-radius: 28px;
      box-shadow: 0 14px 45px rgba(31, 178, 222, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.8);
    }

    @media (min-width: 1920px) {
      width: clamp(450px, 45vw, 600px);
      border-radius: 30px;
      box-shadow: 0 16px 50px rgba(31, 178, 222, 0.45), 0 0 0 2px rgba(255, 255, 255, 0.9);
    }

    // RESPONSIVE: Móviles - expansión horizontal centrada
    @media (max-width: 768px) {
      width: clamp(280px, 85vw, 360px);
      background: linear-gradient(145deg, rgba(31, 178, 222, 0.25), rgba(31, 178, 222, 0.15));
      box-shadow: 0 6px 20px rgba(31, 178, 222, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.2);
      transform: translateX(-50%);
      border: 2px solid rgba(31, 178, 222, 0.4);
    }

    @media (max-width: 480px) {
      width: clamp(240px, 90vw, 320px);
    }

    @media (max-width: 360px) {
      width: clamp(200px, 95vw, 280px);
    }

    .search-button {
      --background: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
      border: 2px solid var(--azul-claro);

      ion-icon {
        transform: rotate(90deg);
        color: var(--azul-oscuro);
        filter: drop-shadow(0 1px 2px rgba(31, 178, 222, 0.3));
      }
    }

    .header-searchbar {
      width: auto; // Toma el espacio disponible
      opacity: 1;
      flex: 1; // Ocupa el espacio restante
      --background: transparent;
      --box-shadow: none;
      border: none;

      @media (max-width: 768px) {
        width: 200px;
      }

      @media (max-width: 480px) {
        width: 160px;
      }

      @media (max-width: 360px) {
        width: 120px;
      }
    }

    // En móvil muy pequeño, mover el contenedor más hacia la izquierda
    @media (max-width: 480px) {
      left: 140px;
    }

    @media (max-width: 360px) {
      left: 120px;
    }
  }
}

// ========================================
// CONTENEDOR DE OPCIONES DE CONFIGURACIÓN - CON MENÚ HAMBURGUESA
// ========================================
.config-options-container {
  position: relative;
  display: flex;
  align-items: center;
  order: 3; // Después del botón inicio (order: 2)
  margin-left: 8px; // Espaciado desde el botón inicio
  z-index: 50;
  flex-shrink: 1; // Permite contraerse si es necesario

  // RESPONSIVE: Asegurar que se mantenga el flujo horizontal
  @media (min-width: 769px) {
    flex-wrap: nowrap;
    gap: 0; // Sin gap entre elementos para control preciso
  }

  // RESPONSIVE: Alineación y espaciado completo
  @media (min-width: 769px) and (max-width: 1023px) {
    margin-left: 10px; // Espaciado base desktop
  }

  @media (min-width: 1024px) and (max-width: 1199px) {
    margin-left: 12px; // Desktop medio
  }

  @media (min-width: 1200px) and (max-width: 1399px) {
    margin-left: 16px; // Desktop grande
  }

  @media (min-width: 1400px) and (max-width: 1919px) {
    margin-left: 20px; // Desktop extra grande
  }

  @media (min-width: 1920px) {
    margin-left: 24px; // Desktop ultra grande
  }

  // RESPONSIVE: Móvil - Posicionamiento específico
  @media (max-width: 768px) and (min-width: 481px) {
    margin-left: 6px; // Tabletas
    margin-right: 8px;
  }

  @media (max-width: 480px) {
    margin-left: 4px; // Móviles pequeños
    margin-right: 6px;
  }

  // RESPONSIVE: Landscape móvil
  @media (max-width: 960px) and (orientation: landscape) {
    margin-left: 6px;
    margin-right: 4px;
  }

  // Botón del menú hamburguesa - RESPONSIVE COMPLETO
  .mobile-menu-button {
    --background: transparent;
    --color: white;
    --border-radius: 8px;
    --box-shadow: none;
    --ripple-color: rgba(255, 255, 255, 0.3);
    height: 48px;
    width: 48px;
    margin: 0;
    display: none; // Oculto por defecto
    transition: all 0.2s ease;

    ion-icon {
      font-size: 24px;
      transition: transform 0.2s ease;
    }

    &:hover {
      --background: rgba(255, 255, 255, 0.15);
      transform: scale(1.05);
    }

    // RESPONSIVE: Mostrar en móviles con tamaños específicos
    @media (max-width: 768px) and (min-width: 481px) {
      display: flex;
      height: 52px; // Ligeramente más grande en tabletas
      width: 52px;

      ion-icon {
        font-size: 26px;
      }
    }

    @media (max-width: 480px) {
      display: flex;
      height: 44px; // Más compacto en móviles pequeños
      width: 44px;

      ion-icon {
        font-size: 22px;
      }
    }

    // RESPONSIVE: Landscape móvil - muy compacto
    @media (max-width: 960px) and (orientation: landscape) {
      display: flex;
      height: 40px;
      width: 40px;

      ion-icon {
        font-size: 20px;
      }
    }
  }

  // Overlay del menú móvil
  .mobile-menu-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 140;
    /* Reducido - overlay no debe bloquear contenido de página */
    cursor: pointer;

    // Solo visible en móviles
    @media (min-width: 769px) {
      display: none;
    }
  }
}

// ========================================
// SEGMENTO DE CONFIGURACIÓN EN EL HEADER - DESKTOP Y MÓVIL SEPARADOS
// ========================================
.config-segment-header {
  --background: transparent;
  display: flex;
  gap: 12px; // Reducido para mejor distribución en Desktop
  margin: 0;
  align-items: flex-start;

  // RESPONSIVE: Espaciado progresivo y completo
  @media (min-width: 769px) and (max-width: 1023px) {
    gap: 18px; // Desktop base - espaciado cómodo
  }

  @media (min-width: 1024px) and (max-width: 1199px) {
    gap: 20px; // Desktop medio - más espacio
  }

  @media (min-width: 1200px) and (max-width: 1399px) {
    gap: 24px; // Desktop grande - espacioso
  }

  @media (min-width: 1400px) and (max-width: 1919px) {
    gap: 28px; // Desktop extra grande - muy espacioso
  }

  @media (min-width: 1920px) {
    gap: 32px; // Desktop ultra grande - máximo espacio
  }

  // RESPONSIVE: Pantallas ultrawide (21:9, 32:9)
  @media (min-width: 2560px) {
    gap: 36px; // Espaciado extra para pantallas muy anchas
    max-width: 80%; // Limitar ancho para mejor usabilidad
  }

  // RESPONSIVE: Pantallas 4K y superiores
  @media (min-width: 3840px) {
    gap: 40px;
    font-size: 1.1em; // Texto ligeramente más grande
    max-width: 70%; // Aún más limitado en pantallas enormes
  }

  // RESPONSIVE: Móvil - gaps específicos
  @media (max-width: 768px) {
    gap: 8px; // Compacto para móviles
    flex-wrap: wrap; // Permitir wrap si es necesario
  }

  // RESPONSIVE: Landscape móvil - ultra compacto
  @media (max-width: 960px) and (orientation: landscape) {
    gap: 6px;
    align-items: center;
  }

  // RESPONSIVE: Zoom del sistema (150%+)
  @media (min-resolution: 1.5dppx) {
    gap: calc(var(--gap-base, 20px) * 0.85); // Reduce gap en zoom alto
  }

  // RESPONSIVE: Preferencia por contraste alto
  @media (prefers-contrast: high) {
    filter: contrast(1.2);
  }

  // RESPONSIVE: Modo oscuro del sistema
  @media (prefers-color-scheme: dark) {
    // Ya tenemos modo oscuro, pero podemos optimizar
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
  }

  // RESPONSIVE: Desktop - Layout horizontal alineado a la derecha del botón inicio
  &.desktop-menu {
    @media (min-width: 769px) {
      position: relative;
      flex-direction: row; // Mantener horizontal
      height: auto;
      padding: 0;
      display: flex;
      justify-content: flex-start;
      align-items: center; // Centrar verticalmente con el botón inicio
      gap: 18px; // Espaciado base desktop optimizado
    }

    // RESPONSIVE: Desktop medio optimizado
    @media (min-width: 1024px) and (max-width: 1199px) {
      gap: 20px; // Espaciado medio
    }

    // RESPONSIVE: Pantallas grandes
    @media (min-width: 1200px) and (max-width: 1399px) {
      gap: 24px; // Espaciado grande
    }

    // RESPONSIVE: Pantallas extra grandes
    @media (min-width: 1400px) and (max-width: 1919px) {
      gap: 28px; // Espaciado extra grande
    }

    // RESPONSIVE: Pantallas ultra grandes
    @media (min-width: 1920px) {
      gap: 32px; // Espaciado máximo
    }

    // RESPONSIVE: Móvil - Ocultar con transiciones suaves
    @media (max-width: 768px) {
      display: none;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    // RESPONSIVE: Landscape móvil - también ocultar
    @media (max-width: 960px) and (orientation: landscape) {
      display: none;
    }

    // RESPONSIVE: Mostrar con transición en desktop
    @media (min-width: 769px) {
      opacity: 1;
      visibility: visible;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    // RESPONSIVE: Optimización para dispositivos con movimiento reducido
    @media (prefers-reduced-motion: reduce) {
      transition: none;
      animation: none;
    }

    // RESPONSIVE: Mejor rendimiento en dispositivos de gama media
    @media (max-width: 1024px) {
      will-change: opacity, visibility;
      backface-visibility: hidden;
    }
  }

  .config-tab-button {
    --color: #ffffff;
    --color-selected: #ffffff;
    --background: transparent;
    --padding-start: 0;
    --padding-end: 0;
    --padding-top: 0;
    --padding-bottom: 0;
    --indicator-height: 0;
    background: transparent;
    padding: 0;
    margin: 0;
    position: relative;
    display: flex;
    align-items: center;
    gap: 6px;
    overflow: visible;
    flex-shrink: 0;
    border-radius: 8px;
    transition: all 0.3s ease;

    // Variables por defecto
    --config-btn-width: auto;
    --config-btn-height: auto;
    --config-btn-padding: 0;
    --config-btn-radius: 8px;

    // RESPONSIVE: Desktop - RECTÁNGULOS REDUCIDOS 20% (era 135px)
    @media (min-width: 769px) {
      flex-direction: column;
      justify-content: center;
      align-items: center;

      --config-btn-width: 108px;
      --config-btn-height: 90px;
      --config-btn-padding: 9px 10px;
      --config-btn-radius: 18px;

      width: var(--config-btn-width);
      height: var(--config-btn-height);
      min-width: var(--config-btn-width);
      min-height: var(--config-btn-height);
      max-width: var(--config-btn-width);
      max-height: var(--config-btn-height);
      padding: var(--config-btn-padding);
      border-radius: var(--config-btn-radius);

      border: 2px solid rgba(255, 255, 255, 0.5);
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.3), 0 4px 12px rgba(0, 0, 0, 0.2);
      box-sizing: border-box;
    }

    // RESPONSIVE: Desktop medio (1024-1199px) - REDUCIDO 20%
    @media (min-width: 1024px) and (max-width: 1199px) {
      --config-btn-width: 115px;
      --config-btn-height: 96px;
      --config-btn-padding: 10px 12px;
      --config-btn-radius: 19px;
    }

    // RESPONSIVE: Desktop grande (1200-1399px) - REDUCIDO 20%
    @media (min-width: 1200px) and (max-width: 1399px) {
      --config-btn-width: 122px;
      --config-btn-height: 102px;
      --config-btn-padding: 12px 14px;
      --config-btn-radius: 20px;
    }

    // RESPONSIVE: Desktop extra grande (1400-1919px) - REDUCIDO 20%
    @media (min-width: 1400px) and (max-width: 1919px) {
      --config-btn-width: 130px;
      --config-btn-height: 108px;
      --config-btn-padding: 12px 16px;
      --config-btn-radius: 22px;
    }

    // RESPONSIVE: Desktop ultra grande (1920px+) - REDUCIDO 20%
    @media (min-width: 1920px) {
      --config-btn-width: 137px;
      --config-btn-height: 114px;
      --config-btn-padding: 14px 18px;
      --config-btn-radius: 24px;
    }

    // RESPONSIVE: Móvil - 50% MÁS ANCHO
    @media (max-width: 768px) and (min-width: 481px) {
      --config-btn-width: 117px;
      --config-btn-height: 78px;
      --config-btn-padding: 8px 12px;
      --config-btn-radius: 15px;

      flex-direction: column;
      justify-content: center;
      align-items: center;
      border: 2px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.2), 0 3px 8px rgba(0, 0, 0, 0.15);
    }

    // RESPONSIVE: Móvil pequeño (≤480px) - 50% más ancho
    @media (max-width: 480px) {
      --config-btn-width: 108px;
      --config-btn-height: 72px;
      --config-btn-padding: 6px 10px;
      --config-btn-radius: 12px;

      flex-direction: column;
      justify-content: center;
      align-items: center;
      border: 2px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.2), 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    // Íconos con círculos aumentados 30%
    ion-icon {
      font-size: 1.3rem; // Aumentado 30% de 1rem
      color: #ffffff;
      background: var(--ion-color-primary);
      border-radius: 50%;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);

      // Dimensiones base del círculo del ícono - AUMENTADO 30%
      width: 31px;
      height: 31px;
      padding: 6px;

      // RESPONSIVE: Desktop base - Círculo aumentado 30%
      @media (min-width: 769px) {
        font-size: 1.3rem; // 30% más de 1rem
        width: 36px; // 30% más de 28px
        height: 36px;
        padding: 8px; // Padding proporcional
      }

      // RESPONSIVE: Desktop medio - Aumentado 30%
      @media (min-width: 1024px) and (max-width: 1199px) {
        font-size: 1.43rem; // 30% más de 1.1rem
        width: 39px; // 30% más de 30px
        height: 39px;
        padding: 9px; // Padding proporcional
      }

      // RESPONSIVE: Desktop grande - Aumentado 30%
      @media (min-width: 1200px) and (max-width: 1399px) {
        font-size: 1.56rem; // 30% más de 1.2rem
        width: 42px; // 30% más de 32px
        height: 42px;
        padding: 10px; // Padding proporcional
      }

      // RESPONSIVE: Desktop extra grande - Aumentado 30%
      @media (min-width: 1400px) and (max-width: 1919px) {
        font-size: 1.69rem; // 30% más de 1.3rem
        width: 44px; // 30% más de 34px
        height: 44px;
        padding: 11px; // Padding proporcional
      }

      // RESPONSIVE: Desktop ultra grande - Aumentado 30%
      @media (min-width: 1920px) {
        font-size: 1.82rem; // 30% más de 1.4rem
        width: 47px; // 30% más de 36px
        height: 47px;
        padding: 12px; // Padding proporcional
      }

      // RESPONSIVE: Móvil - Círculo aumentado 30%
      @media (max-width: 768px) and (min-width: 481px) {
        font-size: 1.17rem; // 30% más de 0.9rem
        width: 29px; // 30% más de 22px
        height: 29px;
        padding: 6px; // Padding proporcional
      }

      // RESPONSIVE: Móvil pequeño - Aumentado 30%
      @media (max-width: 480px) {
        font-size: 1.04rem; // 30% más de 0.8rem
        width: 26px; // 30% más de 20px
        height: 26px;
        padding: 5px; // Padding proporcional
      }
    }

    // Etiquetas para botones más grandes - texto reducido 50%
    ion-label {
      font-size: 0.375rem; // Reducido 50% de 0.75rem
      font-weight: 600;
      color: #ffffff;
      text-align: center;
      line-height: 1.1; // Ligero aumento para mejor legibilidad
      margin: 0;
      margin-top: 3px;
      flex-shrink: 0;
      white-space: nowrap;
      overflow: visible; // Permitir que se vea el texto completo
      text-overflow: clip; // Sin ellipsis
      max-width: 100%;
      transition: all 0.3s ease;

      // RESPONSIVE: Desktop - Texto reducido 50% en botones de 135px ancho
      @media (min-width: 769px) {
        font-size: 0.45rem; // Reducido 50% de 0.9rem
        font-weight: 700;
        line-height: 1.1;
        margin-top: 3px;
        max-width: 125px; // Casi todo el ancho del botón (135px)
        word-wrap: break-word;
      }

      // RESPONSIVE: Desktop medio - Texto reducido 50% en botones de 144px ancho
      @media (min-width: 1024px) and (max-width: 1199px) {
        font-size: 0.475rem; // Reducido 50% de 0.95rem
        max-width: 130px; // Casi todo el ancho del botón (144px)
        line-height: 1.2;
      }

      // RESPONSIVE: Desktop grande - Texto reducido 50% en botones de 153px ancho
      @media (min-width: 1200px) and (max-width: 1399px) {
        font-size: 0.5rem; // Reducido 50% de 1rem
        max-width: 140px; // Casi todo el ancho del botón (153px)
        line-height: 1.2;
      }

      // RESPONSIVE: Desktop extra grande - Texto reducido 50% en botones de 162px ancho
      @media (min-width: 1400px) and (max-width: 1919px) {
        font-size: 0.525rem; // Reducido 50% de 1.05rem
        max-width: 150px; // Casi todo el ancho del botón (162px)
        line-height: 1.2;
      }

      // RESPONSIVE: Desktop ultra grande - Texto reducido 50% en botones de 171px ancho
      @media (min-width: 1920px) {
        font-size: 0.55rem; // Reducido 50% de 1.1rem
        max-width: 160px; // Casi todo el ancho del botón (171px)
        line-height: 1.2;
      }

      // RESPONSIVE: Móvil - MOSTRAR ETIQUETAS en botones de 117px ancho
      @media (max-width: 768px) and (min-width: 481px) {
        display: block; // Mostrar ya que los botones son de 117px ancho
        font-size: 0.4rem; // Reducido 50% de 0.8rem
        max-width: 105px; // Casi todo el ancho del botón (117px)
        line-height: 1.1;
        margin-top: 2px;
      }

      // RESPONSIVE: Móvil pequeño - botones de 108px ancho
      @media (max-width: 480px) {
        display: block; // Mostrar ya que los botones son de 108px ancho
        font-size: 0.375rem; // Reducido 50% de 0.75rem
        max-width: 95px; // Casi todo el ancho del botón (108px)
        line-height: 1.1;
        margin-top: 2px;
      }
    }

    // Colores para cada opción
    &[value="nuevo"] ion-icon {
      background: var(--azul-claro);
    }

    &[value="herramientas"] ion-icon {
      background: var(--verde);
    }

    &[value="calificaciones"] ion-icon {
      background: var(--naranja);
    }

    &[value="sistema"] ion-icon {
      background: var(--magenta);
    }

    // Efectos hover optimizados para botones cuadrados como el inicio
    &:hover {
      transform: scale(1.02); // Efecto sutil en todo el botón
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.6), 0 6px 18px rgba(0, 0, 0, 0.3);

      ion-icon {
        filter: brightness(1.15);
        transform: scale(1.05);
      }
    }

    // Estado seleccionado optimizado
    &.segment-button-checked {
      transform: scale(1.01);
      box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.8), 0 8px 22px rgba(0, 0, 0, 0.4);

      ion-icon {
        filter: brightness(1.25);
        transform: scale(1.03);
      }
    }

    // RESPONSIVE: Optimizaciones adicionales para dispositivos específicos
    @media (hover: none) and (pointer: coarse) {

      // Dispositivos táctiles - mejor feedback táctil
      &:hover {
        transform: none !important;
        background: rgba(255, 255, 255, 0.15) !important;
      }

      &:active {
        background: rgba(255, 255, 255, 0.3) !important;
        transform: scale(0.95) !important;
        transition: all 0.1s ease !important;
      }
    }

    // RESPONSIVE: Dispositivos con hover preciso (ratón)
    @media (hover: hover) and (pointer: fine) {
      &:hover {
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
      }
    }

    // RESPONSIVE: Optimización para conexiones lentas
    @media (prefers-reduced-data: reduce) {
      box-shadow: none !important;
      text-shadow: none !important;

      ion-icon {
        box-shadow: none !important;
      }
    }

    // RESPONSIVE: Dispositivos con animaciones reducidas
    @media (prefers-reduced-motion: reduce) {
      transition: none !important;
      animation: none !important;

      ion-icon {
        transition: none !important;
      }

      ion-label {
        transition: none !important;
      }
    }

    // RESPONSIVE: Pantallas de alta densidad
    @media (-webkit-min-device-pixel-ratio: 2),
    (min-resolution: 192dpi) {
      transform: translateZ(0); // Aceleración hardware
      backface-visibility: hidden;
      -webkit-font-smoothing: antialiased;

      ion-icon {
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
      }
    }
  }
}

// ========================================
// BARRA LATERAL MÓVIL
// ========================================
.mobile-sidebar {
  position: fixed;
  top: 0;
  right: 0;
  width: 280px;
  height: 100vh;
  background: var(--azul-oscuro);
  z-index: 1001;
  transform: translateX(100%);
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: -4px 0 16px rgba(0, 0, 0, 0.3);

  // Safe areas
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-right: env(safe-area-inset-right);

  // Estado expandido
  &.expanded {
    transform: translateX(0);
  }

  // Solo visible en móviles
  @media (min-width: 769px) {
    display: none;
  }

  .mobile-sidebar-content {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 20px;
  }

  .mobile-sidebar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 32px;
    padding-bottom: 16px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);

    h3 {
      color: #ffffff;
      font-size: 1.2rem;
      font-weight: 600;
      margin: 0;
    }

    .close-button {
      --color: #ffffff;
      --background: transparent;
      --border-radius: 50%;
      width: 40px;
      height: 40px;
      margin: 0;

      ion-icon {
        font-size: 24px;
      }
    }
  }

  .mobile-sidebar-options {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
  }

  .sidebar-option {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 16px 20px;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    background: transparent;
    border: 1px solid transparent;

    ion-icon {
      font-size: 24px;
      color: #ffffff;
      width: 24px;
      height: 24px;
      flex-shrink: 0;
    }

    span {
      color: #ffffff;
      font-size: 16px;
      font-weight: 500;
      flex: 1;
    }

    &:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(-4px);
    }

    &.active {
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--azul-claro);

      ion-icon {
        color: var(--azul-claro);
      }

      span {
        color: var(--azul-claro);
        font-weight: 600;
      }
    }
  }
}

// Overlay para la barra lateral
.mobile-sidebar-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.5);
  z-index: 140;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

  &.expanded {
    opacity: 1;
    visibility: visible;
  }

  @media (min-width: 769px) {
    display: none;
  }
}

.config-tab-button {
  --color: #ffffff;
  --color-selected: #ffffff;
  --background: transparent;
  --padding-start: 0;
  --padding-end: 0;
  --padding-top: 0;
  --padding-bottom: 0;
  --indicator-height: 0;
  background: transparent;
  padding: 0 !important;
  margin: 0 !important;
  position: relative;
  display: flex !important;
  align-items: center !important;
  gap: 6px;
  overflow: visible;
  flex-shrink: 0;
  border-radius: 8px;
  transition: all 0.3s ease;

  // RESPONSIVE: Desktop - Layout vertical CON ÍCONOS MÁS GRANDES
  @media (min-width: 769px) {
    flex-direction: column !important;
    justify-content: center !important;
    height: 120px !important; // Aumentado para acomodar íconos más grandes
    min-height: 120px !important;
    max-height: 120px !important;
    width: 110px !important; // Aumentado para acomodar íconos más grandes
    min-width: 110px !important;
    max-width: 110px !important;
    padding: 10px !important;
  }

  // RESPONSIVE: Móvil - Layout horizontal con íconos más grandes
  @media (max-width: 768px) {
    flex-direction: row !important;
    justify-content: flex-start !important;
    height: 56px !important; // Aumentado para acomodar íconos más grandes
    width: 100% !important;
    padding: 10px 14px !important; // Padding aumentado
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    gap: 10px; // Gap aumentado

    &:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateX(2px); // Movimiento más sutil
    }

    &.segment-button-checked {
      background: rgba(255, 255, 255, 0.25);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
  }

  // RESPONSIVE: Móviles pequeños - Aún más compacto
  @media (max-width: 480px) {
    height: 44px !important;
    padding: 6px 10px !important;
    gap: 6px;
  }

  // RESPONSIVE: Pantallas muy pequeñas
  @media (max-width: 360px) {
    height: 40px !important;
    padding: 5px 8px !important;
    gap: 5px;
  }

  // RESPONSIVE: Tablet
  @media (max-width: 1024px) {
    width: 90px !important;
    min-width: 90px !important;
    max-width: 90px !important;
  }

  // RESPONSIVE: Móvil
  @media (max-width: 768px) {
    width: 80px !important;
    min-width: 80px !important;
    max-width: 80px !important;
    gap: 4px;
  }

  // RESPONSIVE: Móvil pequeño
  @media (max-width: 480px) {
    width: 72px !important;
    min-width: 72px !important;
    max-width: 72px !important;
    height: 84.7px !important;
    min-height: 84.7px !important;
    max-height: 84.7px !important;
    gap: 3px;
  }

  // RESPONSIVE: Móvil muy pequeño
  @media (max-width: 360px) {
    width: 65px !important;
    min-width: 65px !important;
    max-width: 65px !important;
    gap: 2px;
  }

  // RESPONSIVE: Landscape móvil
  @media (max-width: 960px) and (orientation: landscape) {
    width: 68px !important;
    min-width: 68px !important;
    max-width: 68px !important;
    height: 72.6px !important;
    min-height: 72.6px !important;
    max-height: 72.6px !important;
    gap: 2px;
  }

  ion-icon {
    color: #ffffff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    flex-shrink: 0;

    // RESPONSIVE: Desktop base - MISMO TAMAÑO QUE INICIO
    @media (min-width: 769px) {
      font-size: 1.4rem;
      width: 40px;
      height: 40px;
      padding: 10px;
    }

    // RESPONSIVE: Desktop medio
    @media (min-width: 1024px) and (max-width: 1199px) {
      font-size: 1.5rem;
      width: 42px;
      height: 42px;
      padding: 11px;
    }

    // RESPONSIVE: Desktop grande
    @media (min-width: 1200px) and (max-width: 1399px) {
      font-size: 1.6rem;
      width: 44px;
      height: 44px;
      padding: 12px;
    }

    // RESPONSIVE: Desktop extra grande
    @media (min-width: 1400px) and (max-width: 1919px) {
      font-size: 1.7rem;
      width: 46px;
      height: 46px;
      padding: 13px;
    }

    // RESPONSIVE: Desktop ultra grande
    @media (min-width: 1920px) {
      font-size: 1.8rem;
      width: 48px;
      height: 48px;
      padding: 14px;
    }

    // RESPONSIVE: Móvil - Íconos MÁS GRANDES
    @media (max-width: 768px) {
      font-size: 1.2rem; // Aumentado para mejor visibilidad
      width: 40px !important; // Más grande
      height: 40px !important;
      min-width: 40px !important;
      min-height: 40px !important;
      max-width: 40px !important;
      max-height: 40px !important;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2); // Borde sutil
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1); // Sombra sutil
    }

    // RESPONSIVE: Móviles pequeños - Íconos muy compactos
    @media (max-width: 480px) {
      font-size: 0.9rem; // Tamaño fijo más controlado
      width: 28px;
      height: 28px;
      padding: 4px;
    }

    // RESPONSIVE: Pantallas muy pequeñas - Ultra compacto
    @media (max-width: 360px) {
      font-size: 0.8rem;
      width: 24px;
      height: 24px;
      padding: 3px;
    }

    // RESPONSIVE: Landscape móvil - Muy compacto
    @media (max-width: 960px) and (orientation: landscape) {
      font-size: 0.85rem;
      width: 26px;
      height: 26px;
      padding: 4px;
    }
  }

  ion-label {
    color: #ffffff;
    font-weight: 600;
    margin: 0;
    padding: 0;
    text-transform: none;
    transition: all 0.3s ease;

    // RESPONSIVE: Desktop - Layout vertical centrado
    @media (min-width: 769px) {
      font-size: 0.55rem;
      text-align: center;
      line-height: 1.2;
      display: block;
      max-width: 90px;
      white-space: nowrap;
      overflow: visible;
      text-overflow: clip;
      margin-bottom: 2px;
      padding: 0 2px;
    }

    // RESPONSIVE: Móvil - Layout horizontal con fuente optimizada
    @media (max-width: 768px) {
      font-size: 0.75rem; // Reducido para evitar desbordamiento
      text-align: left;
      line-height: 1.2;
      display: block;
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: none;
    }

    // RESPONSIVE: Móviles pequeños - Fuente muy compacta
    @media (max-width: 480px) {
      font-size: 0.65rem; // Fuente fija más pequeña para mejor control
      line-height: 1.1;
    }

    // RESPONSIVE: Pantallas muy pequeñas - Ultra compacto
    @media (max-width: 360px) {
      font-size: 0.6rem; // Fuente mínima para pantallas muy pequeñas
      line-height: 1.0;
    }

    // RESPONSIVE: Landscape móvil - Fuente compacta
    @media (max-width: 960px) and (orientation: landscape) {
      font-size: 0.65rem;
      line-height: 1.0;
    }
  }

  // Colores para cada opción
  &[value="nuevo"] ion-icon {
    background: var(--azul-claro);
  }

  &[value="herramientas"] ion-icon {
    background: var(--verde);
  }

  &[value="calificaciones"] ion-icon {
    background: var(--naranja);
  }

  &[value="sistema"] ion-icon {
    background: var(--magenta);
  }

  // Efectos hover optimizados para botones cuadrados
  &:hover {
    transform: scale(1.02); // Efecto sutil en todo el botón
    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.6), 0 6px 18px rgba(0, 0, 0, 0.3);

    ion-icon {
      filter: brightness(1.15);
      transform: scale(1.05);
    }
  }

  // Estado seleccionado optimizado
  &.segment-button-checked {
    transform: scale(1.01);
    box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.8), 0 8px 22px rgba(0, 0, 0, 0.4);

    ion-icon {
      filter: brightness(1.25);
      transform: scale(1.03);
    }
  }
}

// ========================================
// PANEL DE SEGUIMIENTO (RESUMEN GLOBAL)
// ========================================
.panel-seguimiento-global {
  position: fixed;
  right: 0;
  top: 64px;
  bottom: 0;
  width: 360px;
  background: var(--ion-card-background, #ffffff); // Theme-aware
  border-left: 1px solid var(--ion-border-color, rgba(0, 0, 0, 0.08));
  display: flex !important;
  flex-direction: column;
  overflow: hidden;
  box-shadow: -4px 0 20px rgba(0, 0, 0, 0.05);
  z-index: 80;
  margin: 0;
  border-radius: 0;
  animation: slideInRight 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);

  @media (min-width: 1600px) {
    width: 420px;
  }

  ion-card-header.panel-seguimiento-header {
    background: linear-gradient(135deg, var(--azul-oscuro) 0%, #0d2e47 100%);
    padding: 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    --background: transparent;

    ion-card-title {
      color: #ffffff;
      margin: 0;
      font-size: 0.95rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
      letter-spacing: 0.3px;

      ion-icon {
        font-size: 1.25rem;
        color: var(--azul-claro);
      }
    }

    .header-close-btn {
      --color: #ffffff;
      margin: 0;
      opacity: 0.8;

      &:hover {
        opacity: 1;
      }
    }
  }

  ion-card-content.panel-seguimiento-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    background: var(--ion-card-background, #ffffff); // Theme-aware
  }

  // Estadísticas Rápidas
  .stats-grid-global {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin-bottom: 24px;

    .stat-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 12px 8px;
      background: var(--ion-color-step-50, #f8fafc); // Theme-aware
      border-radius: 12px;
      border: 1px solid var(--ion-border-color, rgba(15, 56, 90, 0.05));

      .stat-value {
        font-size: 1.25rem;
        font-weight: 800;
        color: var(--azul-oscuro);
        line-height: 1;
        margin-bottom: 4px;
      }

      .stat-label {
        font-size: 0.65rem;
        font-weight: 600;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
    }
  }

  .info-divider {
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.06), transparent);
    margin: 20px 0;
  }

  // Novedades Summary
  .summary-section {
    .section-title-premium {
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--azul-oscuro);
      margin: 0 0 16px 0;
      text-transform: uppercase;
      letter-spacing: 0.8px;
    }

    .tipo-summary-list {
      display: flex;
      flex-direction: column;
      gap: 10px;

      .tipo-summary-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 14px;
        background: var(--ion-card-background, #ffffff); // Theme-aware
        border-radius: 12px;
        border: 1px solid var(--ion-border-color, rgba(0, 0, 0, 0.05));
        transition: all 0.2s ease;

        &:hover {
          transform: translateX(4px);
          border-color: rgba(15, 56, 90, 0.15);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
        }

        .tipo-icon {
          width: 36px;
          height: 36px;
          border-radius: 10px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 1.15rem;
        }

        .tipo-name {
          flex: 1;
          font-size: 0.85rem;
          font-weight: 600;
          color: #334155;
        }

        .tipo-count {
          padding: 4px 10px;
          border-radius: 20px;
          font-size: 0.75rem;
          font-weight: 700;
        }
      }

      .empty-summary {
        text-align: center;
        padding: 40px 20px;
        color: #94a3b8;

        ion-icon {
          font-size: 3rem;
          margin-bottom: 12px;
          opacity: 0.2;
        }

        p {
          font-size: 0.85rem;
          margin: 0;
        }
      }
    }
  }

  .panel-actions-global {
    margin-top: 32px;
    display: flex;
    flex-direction: column;
    gap: 12px;

    .btn-premium-outline {
      --border-color: var(--azul-claro);
      --color: var(--azul-claro);
      --border-radius: 12px;
      --font-weight: 600;
      height: 48px;
      margin: 0;
    }
  }
}

@keyframes pulseIn {
  0% {
    transform: scale(0.9);
    opacity: 0;
  }

  100% {
    transform: scale(1);
    opacity: 1;
  }
}

// Badge especial para cuando se visualiza un grupo diferente al seleccionado
.grupo-visualizado-badge {
  animation: blink-soft 1.5s ease-in-out infinite;
}

@keyframes blink-soft {

  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.7;
  }
}

@keyframes pulseIn {
  0% {
    transform: scale(0.9);
    opacity: 0;
  }

  50% {
    transform: scale(1.05);
  }

  100% {
    transform: scale(1);
    opacity: 1;
  }
}

// Grid de grupos con Ionic Buttons - Usando variables CSS nativas de Ionic
.grupos-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(31.2px, 1fr));
  gap: 6px;

  @media (max-height: 500px) and (orientation: landscape) {
    grid-template-columns: repeat(auto-fill, minmax(26px, 1fr));
    gap: 4px;
  }

  // Botón nativo grupo-btn - Estandarizado con _seguimiento.scss
  .grupo-btn {
    // Reset de botón nativo
    border: none;
    outline: none;
    cursor: pointer;

    // Centrado del contenido (números e iconos)
    display: flex;
    align-items: center;
    justify-content: center;

    // Dimensiones compactas
    padding: 6px 7.2px;
    margin: 0;
    min-height: 28px;
    height: 28px;
    min-width: 28px;
    border-radius: 6px;

    // Colores base
    background: transparent;
    color: var(--azul-oscuro);

    // Tipografía
    font-family: inherit;
    font-size: 0.72rem;
    font-weight: 600;
    letter-spacing: 0.3px;
    line-height: 1;

    // Transiciones suaves
    transition: all 0.2s ease;

    @media (max-height: 500px) and (orientation: landscape) {
      padding: 4px 5px;
      min-height: 24px;
      height: 24px;
      min-width: 24px;
      border-radius: 5px;
      font-size: 0.65rem;
      letter-spacing: 0.2px;
    }

    // Estados hover/active
    &:hover {
      background: rgba(15, 56, 90, 0.08);
    }

    &:active {
      background: rgba(15, 56, 90, 0.12);
      transform: scale(0.98);
    }

    // Estado activo (seleccionado) - Azul oscuro sólido
    &.activo {
      background: var(--azul-oscuro);
      color: #ffffff;
      font-weight: 700;
      transform: scale(1.03);
      box-shadow: 0 2px 8px rgba(15, 56, 90, 0.25);

      &:hover {
        background: #0d2e47;
      }
    }

    // Variante dashboard con color magenta
    &.grupo-btn-dashboard {
      color: var(--magenta, #ec0677);

      ion-icon {
        font-size: 0.78rem;
        transition: transform 0.25s ease;
      }

      &:hover {
        background: rgba(236, 6, 119, 0.08);

        ion-icon {
          transform: rotate(90deg) scale(1.1);
        }
      }

      &.activo {
        background: var(--magenta);
        color: #ffffff;

        &:hover {
          background: #c7055f;
        }
      }
    }
  }
}

// Tabla de integrantes con calificaciones - Estilo Ionic List
.integrantes-table-container {
  margin-top: 8px;
  padding: 0;
  border-top: 1px solid rgba(31, 178, 222, 0.15);
  overflow-x: auto;
  overflow-y: auto;
  max-height: 260px;

  // Tabla responsive con texto reducido 20%
  .integrantes-calificaciones-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.58rem; // Reducido 20% de 0.72rem

    &.responsive-table {
      table-layout: fixed;
    }

    thead {
      tr {
        background: linear-gradient(135deg, var(--azul-oscuro) 0%, #0d2e47 100%);
        position: sticky;
        top: 0;
        z-index: 1;

        th {
          padding: 8px 4px;
          text-align: center;
          font-weight: 600;
          color: #ffffff;
          text-transform: uppercase;
          letter-spacing: 0.3px;
          font-size: 0.52rem; // Reducido 20% de 0.65rem

          &.col-nombre {
            text-align: left;
            padding-left: 8px;
            width: 45%;
          }

          &.col-entrega {
            width: 32px;
            min-width: 32px;
          }

          &.col-total {
            width: 36px;
            min-width: 36px;

            ion-icon {
              font-size: 0.68rem; // Reducido 20%
              color: var(--amarillo);
            }
          }
        }
      }
    }

    tbody {
      .integrante-row {
        transition: all 0.2s ease;
        cursor: pointer;
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);

        &:hover {
          background-color: rgba(31, 178, 222, 0.08);
        }

        &:nth-child(even) {
          background-color: rgba(0, 0, 0, 0.015);
        }

        // Estados de estudiantes
        &.estado-ok {
          background-color: rgba(16, 185, 129, 0.1) !important;
        }

        &.estado-solo {
          background-color: rgba(255, 193, 7, 0.1) !important;
        }

        &.estado-ausente {
          background-color: rgba(239, 68, 68, 0.1) !important;

          .nombre-estudiante {
            text-decoration: line-through;
            opacity: 0.6;
          }
        }

        td {
          padding: 6px 4px;
          text-align: center;
          vertical-align: middle;

          &.col-nombre {
            text-align: left;
            padding-left: 8px;
            display: flex;
            align-items: center;
            gap: 4px;

            .estado-icono {
              font-size: 0.9rem;
              flex-shrink: 0;
            }

            .nombre-estudiante {
              display: block;
              font-weight: 500;
              color: var(--azul-oscuro);
              white-space: nowrap;
              overflow: hidden;
              text-overflow: ellipsis;
              max-width: 110px;
              line-height: 1.3;
              font-size: 0.60rem; // Reducido 20% de 0.75rem
            }
          }

          &.col-entrega {

            // Celda editable - hover y estado de edición
            &.editable-cell {
              cursor: pointer;
              transition: all 0.15s ease;
              position: relative;

              &:hover {
                background: rgba(31, 178, 222, 0.1);
              }
            }

            .calificacion-badge {
              display: inline-flex;
              align-items: center;
              justify-content: center;
              min-width: 26px;
              height: 22px;
              padding: 2px 5px;
              border-radius: 5px;
              font-weight: 700;
              font-size: 0.56rem;
              background-color: transparent;
              color: var(--azul-oscuro, #0f385a);
              border: 1px solid var(--azul-oscuro, #0f385a);

              // Estilo vacío
              &.empty {
                background-color: transparent;
                color: var(--azul-oscuro, #0f385a);
                border: 1px solid rgba(15, 56, 90, 0.3);
              }

              // Todos los estados con mismo estilo azul oscuro
              &.success,
              &.warning,
              &.danger {
                background-color: transparent;
                color: var(--azul-oscuro, #0f385a);
                border: 1px solid var(--azul-oscuro, #0f385a);
              }

              // Indicador visual de calificación desde Canvas
              &.canvas {
                position: relative;
                border: 2px solid #1fb2de;
                box-shadow: 0 0 4px rgba(31, 178, 222, 0.4);

                // Pequeño indicador de Canvas en la esquina
                &::after {
                  content: '';
                  position: absolute;
                  top: -2px;
                  right: -2px;
                  width: 8px;
                  height: 8px;
                  background-color: #1fb2de;
                  border-radius: 50%;
                  border: 1px solid #ffffff;
                }
              }
            }

            // Input de edición inline en el panel de seguimiento
            .edit-input-inline {
              width: 50px;
              height: 26px;
              padding: 2px 6px;
              border: 2px solid #1fb2de;
              border-radius: 6px;
              background: #ffffff;
              font-size: 0.75rem;
              font-weight: 700;
              text-align: center;
              color: var(--azul-oscuro);
              outline: none;
              box-shadow: 0 0 6px rgba(31, 178, 222, 0.4);

              &:focus {
                border-color: #28a745;
              }
            }
          }

          &.col-total {
            .total-badge {
              display: inline-flex;
              align-items: center;
              justify-content: center;
              min-width: 36px;
              height: 26px;
              padding: 4px 10px;
              border-radius: 6px;
              font-weight: 700;
              font-size: 0.75rem;
              background: transparent;
              color: var(--azul-claro);
            }
          }
        }
      }
    }
  }

  // Responsive: Ajustar ancho del nombre según el tamaño del panel
  @media (min-width: 1280px) {
    .integrantes-calificaciones-table {
      tbody .integrante-row td.col-nombre .nombre-estudiante {
        max-width: 160px;
      }
    }
  }

  @media (min-width: 1600px) {
    .integrantes-calificaciones-table {
      tbody .integrante-row td.col-nombre .nombre-estudiante {
        max-width: 180px;
      }
    }
  }
}

// Opciones de configuración en el panel
.config-options-panel {
  margin-bottom: 0;
  border-bottom: none;
  padding-bottom: 0;

  .config-segment-circular {
    --background: transparent;
    display: grid;
    grid-template-columns: 1fr 1fr; // 2 columnas
    gap: 20px; // Aumentado para mejor separación
    padding: 16px;
    justify-items: center;
    align-items: start;

    ion-segment-button {
      --color: #ffffff;
      --color-checked: #ffffff;
      --color-hover: #ffffff;
      --background: transparent;
      --background-checked: transparent;
      --background-hover: transparent;
      --border-radius: 0;
      --padding-start: 0;
      --padding-end: 0;
      --padding-top: 0;
      --padding-bottom: 0;
      --indicator-height: 0;
      margin: 0;
      border: none;
      position: relative;
      height: 110px; // Aumentado para mejor distribución
      width: 100%;
      max-width: 200px; // Limitar ancho máximo
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;

      ion-label {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 8px;
        color: #ffffff;
        font-weight: 600;
        font-size: 0.75rem;
        text-align: center;
        width: 100%;

        ion-icon {
          font-size: 2rem; // Aumentado para mejor visibilidad
          color: #ffffff;
          display: flex;
          align-items: center;
          justify-content: center;
          width: 70px; // Aumentado para círculos completos
          height: 70px; // Aumentado para círculos completos
          border-radius: 50%;
          flex-shrink: 0;
          box-sizing: border-box;
          padding: 15px; // Aumentado proporcionalmente
          margin: 0;
          transition: all 0.3s ease;
        }
      }

      &:hover:not(.segment-button-checked) ion-label ion-icon {
        transform: scale(1.1);
      }

      &.segment-button-checked ion-label ion-icon {
        transform: scale(1.05);
      }
    }

    // Colores específicos para cada opción
    ion-segment-button[value="nuevo"] ion-label ion-icon {
      background: var(--azul-claro);

      &:hover {
        box-shadow: 0 4px 12px rgba(31, 178, 222, 0.4);
      }
    }

    ion-segment-button[value="nuevo"].segment-button-checked ion-label ion-icon {
      box-shadow: 0 4px 16px rgba(31, 178, 222, 0.6);
    }

    ion-segment-button[value="herramientas"] ion-label ion-icon {
      background: var(--verde);

      &:hover {
        box-shadow: 0 4px 12px rgba(166, 206, 56, 0.4);
      }
    }

    ion-segment-button[value="herramientas"].segment-button-checked ion-label ion-icon {
      box-shadow: 0 4px 16px rgba(166, 206, 56, 0.6);
    }

    ion-segment-button[value="calificaciones"] ion-label ion-icon {
      background: var(--naranja);

      &:hover {
        box-shadow: 0 4px 12px rgba(251, 175, 23, 0.4);
      }
    }

    ion-segment-button[value="calificaciones"].segment-button-checked ion-label ion-icon {
      box-shadow: 0 4px 16px rgba(251, 175, 23, 0.6);
    }

    ion-segment-button[value="sistema"] ion-label ion-icon {
      background: var(--magenta);

      &:hover {
        box-shadow: 0 4px 12px rgba(236, 6, 119, 0.4);
      }
    }

    ion-segment-button[value="sistema"].segment-button-checked ion-label ion-icon {
      box-shadow: 0 4px 16px rgba(236, 6, 119, 0.6);
    }
  }
}

.panel-content-area {
  margin-top: 20px;
}

.no-comentarios {
  color: #999;
  font-style: italic;
  margin: 0;
  padding: 1rem;
}

// Ionic List para comentarios
ion-list.comentarios-lista {
  --background: transparent;
  --padding-start: 0;
  --padding-end: 0;
  background: transparent;
  padding: 0;
  margin: 0;
  max-height: 180px;
  overflow-y: auto;
}

// Ionic Card para cada comentario
ion-card.comentario-card {
  --background: rgba(255, 255, 255, 0.05);
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4.8px;
  border-left: 2px solid var(--azul-claro);
  margin: 0 0 4.8px 0;
  box-shadow: none;

  ion-card-header {
    --background: transparent;
    padding: 4.8px 7.2px;
    display: flex;
    align-items: center;
    gap: 4.8px;
    flex-wrap: wrap;

    ion-badge {
      font-size: 0.42rem;
      --padding-start: 3.6px;
      --padding-end: 3.6px;
      --padding-top: 1.8px;
      --padding-bottom: 1.8px;

      &[color="medium"] {
        --background: var(--azul-claro);
        --color: white;
      }

      &[color="primary"] {
        --background: var(--azul-oscuro);
        --color: white;
      }
    }
  }

  ion-card-content.comentario-texto {
    --background: transparent;
    padding: 4.8px 7.2px;
    color: #333;
    font-size: 0.51rem;
    line-height: 1.3;
    margin: 0;
  }
}

.rubrica-seguimiento-area {
  margin-top: 0.6rem;
  padding: 0.6rem;
  background: rgba(255, 255, 255, 0.03);
  border-radius: 4.8px;
  max-height: 240px;
  overflow-y: auto;
}

.rubrica-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.6rem;
  padding-bottom: 0.3rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);

  h3 {
    margin: 0;
    color: var(--azul-claro);
    font-size: 0.6rem;
    font-weight: 600;
  }

  ion-button {
    --color: var(--azul-claro);

    &:hover {
      --color: #fff;
    }

    .btn-label {
      margin-left: 2.4px;
      font-size: 0.45rem;
    }
  }
}

.evaluacion-seccion {
  margin-bottom: 0.6rem;

  &.evaluacion-grupal {
    background: rgba(52, 152, 219, 0.05);
    padding: 0.3rem;
    border-radius: 3.6px;
    border-left: 2px solid var(--azul-claro);
  }

  &.evaluacion-individual {
    background: rgba(155, 89, 182, 0.05);
    padding: 0.3rem;
    border-radius: 3.6px;
    border-left: 2px solid var(--magenta);
  }

  .evaluacion-header {
    margin-bottom: 0.3rem;
    padding-bottom: 0.15rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);

    h4 {
      color: var(--azul-oscuro);
      font-size: 0.51rem;
      font-weight: 700;
      margin: 0;
    }

    .timestamp {
      display: block;
      color: var(--azul-oscuro);
      opacity: 0.6;
      font-size: 0.39rem;
      margin-top: 1.2px;
    }
  }
}

.criterio-card {
  background: rgba(255, 255, 255, 0.08);
  border-radius: 3.6px;
  padding: 0.3rem;
  margin-bottom: 0.3rem;
  border: 1px solid rgba(255, 255, 255, 0.1);

  .criterio-nombre {
    color: var(--azul-oscuro);
    font-size: 0.48rem;
    font-weight: 600;
    margin: 0 0 0.24rem 0;
  }
}

.niveles-container {
  display: flex;
  flex-direction: column;
  gap: 0.18rem;
  margin-bottom: 0.24rem;
}

.nivel-item {
  display: flex;
  align-items: center;
  gap: 0.24rem;
  padding: 0.15rem 0.18rem;
  border-radius: 2.4px;
  background: rgba(255, 255, 255, 0.03);
  transition: all 0.2s ease;

  &.seleccionado {
    background: rgba(52, 152, 219, 0.15);
    border: 1px solid var(--azul-claro);
    box-shadow: 0 0 2.4px rgba(52, 152, 219, 0.3);
  }

  .nivel-circulo {
    width: 7.2px;
    height: 7.2px;
    border-radius: 50%;
    flex-shrink: 0;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  .nivel-info {
    display: flex;
    flex-direction: column;
    flex: 1;
    gap: 0.6px;

    .nivel-nombre {
      color: var(--azul-oscuro);
      font-size: 0.42rem;
      font-weight: 600;
      line-height: 1.1;
    }

    .nivel-intervalo {
      color: var(--azul-oscuro);
      opacity: 0.7;
      font-size: 0.39rem;
      line-height: 1.2;
    }
  }
}

.criterio-resultado {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.3rem 0.4rem;
  background: rgba(52, 152, 219, 0.1);
  border-radius: 4px;
  margin-top: 0.3rem;

  .nivel-calificado,
  .puntos-asignados {
    font-size: 0.7rem;
    color: var(--azul-oscuro);
    line-height: 1.3;

    strong {
      color: var(--azul-claro);
      font-weight: 700;
    }
  }
}

.criterio-comentario {
  display: flex;
  align-items: flex-start;
  gap: 0.3rem;
  margin-top: 0.3rem;
  padding: 0.3rem;
  background: rgba(166, 206, 56, 0.1);
  border-left: 2px solid var(--verde-esmeralda);
  border-radius: 4px;

  ion-icon {
    color: var(--verde-esmeralda);
    font-size: 0.85rem;
    flex-shrink: 0;
    margin-top: 1px;
  }

  p {
    margin: 0;
    color: var(--azul-oscuro);
    font-size: 0.7rem;
    line-height: 1.3;
    font-style: italic;
  }
}

.total-combinado {
  background: linear-gradient(135deg, rgba(52, 152, 219, 0.15), rgba(155, 89, 182, 0.15));
  padding: 0.6rem;
  border-radius: 6px;
  text-align: center;
  margin-top: 0.75rem;
  border: 2px solid var(--azul-claro);

  h4 {
    color: var(--azul-oscuro);
    font-size: 0.95rem;
    font-weight: 700;
    margin: 0;
  }

  .detalle-total {
    color: var(--azul-oscuro);
    opacity: 0.7;
    font-size: 0.7rem;
    margin: 0;
    margin-top: 2px;
  }
}

// Áreas de texto para seguimiento - Estilo plano y simple
.texto-seguimiento-seccion {
  margin-top: 0.45rem;
  padding: 0.3rem;
  background: transparent;
  border: none;

  &.texto-grupal {
    border-left: 1.2px solid var(--azul-claro);
  }

  &.texto-individual {
    border-left: 1.2px solid var(--magenta);
  }

  .texto-header {
    margin-bottom: 0.3rem;
    padding-bottom: 0;
    border-bottom: none;

    h4 {
      color: var(--azul-oscuro);
      font-size: 0.45rem;
      font-weight: 500;
      margin: 0;
      text-transform: none;
    }
  }

  .texto-contenido {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;

    p {
      color: var(--azul-oscuro);
      font-size: 0.42rem;
      font-weight: 400;
      line-height: 1.4;
      margin: 0;
      white-space: pre-line;
      font-family: inherit;
      padding: 0;
      background: transparent;
      border: none;
    }
  }


}

.evaluacion-seccion {
  margin-bottom: 0.6rem;

  h4 {
    color: var(--azul-oscuro);
    font-size: 0.45rem;
    font-weight: 500;
    margin: 0 0 0.3rem 0;
  }
}

.parrafo-evaluacion {
  margin-bottom: 0.45rem;
  padding-left: 0.3rem;
  border-left: 1.2px solid rgba(15, 56, 90, 0.2);

  p {
    margin: 0;
    color: var(--azul-oscuro);
    font-size: 0.42rem;
    font-weight: 400;
    line-height: 1.4;
  }

  .timestamp {
    display: none; // Ocultar timestamps para estilo más limpio
  }
}

// Estilos para el badge de entrega con Ionic Chip
.entrega-badge-container {
  margin: 0.3rem 0;
  display: flex;
  justify-content: flex-start;
}

// Ionic Chip como badge de entrega
ion-chip.entrega-badge {
  --background: var(--ion-color-tertiary);
  --color: white;
  margin: 0;
  font-size: 0.48rem;
  font-weight: 600;
  height: auto;
  padding: 3.6px 7.2px;

  ion-label {
    margin: 0;
    color: white;
    font-size: 0.48rem;

    .tipo-evaluacion {
      margin-left: 4px;
      font-size: 0.7rem;
      opacity: 0.9;
    }
  }

  &.entrega-e1 {
    --background: linear-gradient(135deg, var(--ion-color-tertiary), var(--ion-color-tertiary-shade));
  }
}

// Estilos para comentarios colapsables con Ionic Components
.comentarios-section {
  margin: 0.75rem 0;
  border: 1px solid rgba(15, 56, 90, 0.1);
  border-radius: 8px;
  overflow: hidden;
  transition: all 0.3s ease;

  // Ionic Item como header de comentarios
  ion-item.comentarios-header {
    --background: rgba(248, 249, 250, 0.8);
    --background-hover: rgba(248, 249, 250, 1);
    --padding-start: 12px;
    --padding-end: 12px;
    --min-height: 44px;
    cursor: pointer;
    transition: all 0.2s ease;

    ion-icon {
      color: var(--azul-oscuro);
      font-size: 1.1rem;
      margin-right: 8px;
    }

    ion-label.comentarios-label {
      font-size: 0.9rem;
      font-weight: 600;
      color: #666;
      margin: 0;
    }

    .comentarios-controls {
      display: flex;
      align-items: center;
      gap: 4px;

      .collapse-icon {
        font-size: 1rem;
        color: var(--azul-oscuro);
        transition: transform 0.3s ease;
      }
    }
  }

  &.comentarios-fijados {
    border-color: var(--azul-oscuro);
    box-shadow: 0 0 0 1px rgba(15, 56, 90, 0.2);
  }
}

.comentarios-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem 0.75rem;
  background: rgba(15, 56, 90, 0.05);
  cursor: pointer;
  -webkit-user-select: none;
  user-select: none;
  transition: background 0.2s ease;

  &:hover {
    background: rgba(15, 56, 90, 0.1);
  }

  .comentarios-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--azul-oscuro);

    ion-icon {
      font-size: 1rem;
    }
  }

  .comentarios-controls {
    display: flex;
    align-items: center;
    gap: 0.25rem;

    ion-button {
      --padding-start: 0.5rem;
      --padding-end: 0.5rem;
      --padding-top: 0.25rem;
      --padding-bottom: 0.25rem;
      height: auto;
      min-height: 0;

      ion-icon {
        font-size: 1rem;
      }
    }

    .collapse-icon {
      font-size: 1.2rem;
      color: var(--azul-oscuro);
      transition: transform 0.3s ease;
    }
  }
}

.comentarios-content {
  padding: 0.75rem;
  animation: slideDown 0.3s ease;
}

// ===== FORMULARIO NUEVO COMENTARIO =====
.nuevo-comentario-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 10px;
  margin-bottom: 10px;
  background: rgba(15, 56, 90, 0.03);
  border-radius: 8px;
  border: 1px dashed rgba(15, 56, 90, 0.15);

  .comentario-textarea {
    --background: white;
    --border-radius: 6px;
    --padding-start: 10px;
    --padding-end: 10px;
    --padding-top: 8px;
    --padding-bottom: 8px;
    font-size: 0.82rem;
    border: 1px solid #e0e0e0;
    border-radius: 6px;

    &.edicion {
      --background: #fffef0;
      border-color: #ffc107;
    }
  }

  .btn-agregar-comentario {
    align-self: flex-end;
    --padding-start: 12px;
    --padding-end: 12px;
    font-size: 0.75rem;
  }
}

// Acciones en comentarios existentes
.comentario-card {
  margin: 6px 0;

  ion-card-header {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;

    ion-badge {
      font-size: 0.65rem;
    }

    .comentario-acciones {
      margin-left: auto;
      display: flex;
      gap: 2px;

      ion-button {
        --padding-start: 4px;
        --padding-end: 4px;
        margin: 0;

        ion-icon {
          font-size: 0.9rem;
        }
      }
    }
  }

  .comentario-texto {
    padding: 8px 12px 12px;
    font-size: 0.8rem;
    color: #333;
    line-height: 1.4;
  }

  .comentario-edicion {
    padding: 8px 12px;

    .edicion-acciones {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 8px;

      ion-button {
        --padding-start: 10px;
        --padding-end: 10px;
        font-size: 0.72rem;
      }
    }
  }
}

@keyframes slideDown {
  from {
    max-height: 0;
    opacity: 0;
  }

  to {
    max-height: 500px;
    opacity: 1;
  }
}

// Estilo para información del integrante
.integrante-info {
  display: flex;
  align-items: center;
  gap: 0.3rem;
  margin: 0.3rem 0;
  padding: 0.3rem;
  background: rgba(15, 56, 90, 0.1);
  border-radius: 3.6px;
  font-size: 0.45rem;
  color: var(--azul-oscuro);
  font-weight: 500;

  ion-icon {
    font-size: 0.6rem;
    color: var(--azul-oscuro);
  }
}

// ========================================
// BARRA LATERAL MÓVIL
// ========================================
.mobile-sidebar {
  position: fixed;
  top: 0;
  right: 0;
  width: 280px;
  height: 100vh;
  background: var(--azul-oscuro);
  z-index: 1001;
  transform: translateX(100%);
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: -4px 0 16px rgba(0, 0, 0, 0.3);

  // Safe areas
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-right: env(safe-area-inset-right);

  // Estado expandido
  &.expanded {
    transform: translateX(0);
  }

  // Solo visible en móviles
  @media (min-width: 769px) {
    display: none;
  }

  .mobile-sidebar-content {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 20px;
  }

  .mobile-sidebar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 32px;
    padding-bottom: 16px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);

    h3 {
      color: #ffffff;
      font-size: 1.2rem;
      font-weight: 600;
      margin: 0;
    }

    .close-button {
      --color: #ffffff;
      --background: transparent;
      --border-radius: 50%;
      width: 40px;
      height: 40px;
      margin: 0;

      ion-icon {
        font-size: 24px;
      }
    }
  }

  .mobile-sidebar-options {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
  }

  .sidebar-option {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 16px 20px;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    background: transparent;
    border: 1px solid transparent;

    ion-icon {
      font-size: 24px;
      color: #ffffff;
      width: 24px;
      height: 24px;
      flex-shrink: 0;
    }

    span {
      color: #ffffff;
      font-size: 16px;
      font-weight: 500;
      flex: 1;
    }

    &:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(-4px);
    }

    &.active {
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--azul-claro);

      ion-icon {
        color: var(--azul-claro);
      }

      span {
        color: var(--azul-claro);
        font-weight: 600;
      }
    }
  }
}

// Overlay para la barra lateral
.mobile-sidebar-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.5);
  z-index: 140;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

  &.expanded {
    opacity: 1;
    visibility: visible;
  }

  @media (min-width: 769px) {
    display: none;
  }
}

// RESPONSIVE: Contenedor de búsqueda móvil separado (fuera del config-options-container)
.mobile-search-container {
  display: none; // Oculto por defecto

  @media (max-width: 768px) {
    display: flex;
    position: fixed;
    left: 50%;
    transform: translateX(-50%);
    top: calc(75px + env(safe-area-inset-top) + 8px);
    background: linear-gradient(145deg, rgba(31, 178, 222, 0.2), rgba(31, 178, 222, 0.1));
    -webkit-backdrop-filter: blur(15px);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(31, 178, 222, 0.3);
    box-shadow: 0 4px 12px rgba(31, 178, 222, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.1);
    border-radius: 24px;
    z-index: 150;
    /* Reducido - sobre contenido pero no bloquea */
    align-items: center;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    padding: 4px 8px;

    // Móviles pequeños
    @media (max-width: 480px) {
      top: calc(75px + env(safe-area-inset-top) + 6px);
      border-radius: 22px;
    }

    // Móviles muy pequeños
    @media (max-width: 360px) {
      top: calc(75px + env(safe-area-inset-top) + 4px);
      border-radius: 20px;
    }

    // Landscape móvil - posición más compacta
    @media (max-width: 960px) and (orientation: landscape) {
      top: calc(70px + env(safe-area-inset-top) + 4px);
      border-radius: 20px;
    }

    // Estado expandido móvil
    &.expanded {
      background: linear-gradient(145deg, rgba(31, 178, 222, 0.15), rgba(31, 178, 222, 0.08));
      -webkit-backdrop-filter: blur(15px);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(31, 178, 222, 0.4);
      box-shadow:
        0 8px 24px rgba(31, 178, 222, 0.25),
        0 0 0 1px rgba(255, 255, 255, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      border-radius: 28px;
      padding: 4px 8px;
      width: auto;
      min-width: 280px;

      .search-button {
        margin-right: 8px;
      }

      .mobile-searchbar {
        --background: transparent;
        --color: var(--azul-claro);
        --placeholder-color: rgba(31, 178, 222, 0.7);
        --icon-color: var(--azul-claro);
        --clear-button-color: var(--azul-claro);
        --border-radius: 0;
        --box-shadow: none;
        flex: 1;
        opacity: 1;
        pointer-events: auto;
      }
    }

    // Estilos para el botón de búsqueda móvil
    .search-button {
      --color: var(--azul-claro);
      --background: transparent;
      --border-radius: 50%;
      width: 44px;
      height: 44px;
      margin: 0;

      ion-icon {
        font-size: 24px;
      }
    }

    // Estilos para la barra de búsqueda móvil
    .mobile-searchbar {
      opacity: 0;
      pointer-events: none;
      width: 0;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      --background: transparent;
      --color: var(--azul-claro);
      --placeholder-color: rgba(31, 178, 222, 0.5);
      --icon-color: var(--azul-claro);
      --clear-button-color: var(--azul-claro);
      --border-radius: 0;
      --box-shadow: none;
    }
  }
}

/* ===================================================================
   NOTA: Reglas "super agresivas" eliminadas - ion-split-pane
   maneja el layout automáticamente sin necesidad de !important
   =================================================================== */

/* ============================================================
   NOTA: Las reglas "ultra agresivas" fueron removidas.
   El layout ahora usa ion-split-pane nativo de Ionic que
   maneja correctamente la visibilidad y el z-index.
   ============================================================ */

// ========================================
// GLOBAL SEARCH RESULTS IN TRACKING PANEL
// ========================================
.search-results-section {
  margin-bottom: 20px;

  .section-title {
    color: rgba(255, 255, 255, 0.9);
    font-weight: 600;
    font-size: 0.9rem;
    margin-bottom: 12px;
    display: block;
  }

  .search-results-list {
    background: transparent;

    .search-result-item {
      --background: rgba(255, 255, 255, 0.05);
      --border-radius: 8px;
      margin-bottom: 8px;
      border-radius: 8px;
      transition: all 0.2s ease;
      cursor: pointer;

      &:hover {
        --background: rgba(255, 255, 255, 0.1);
        transform: translateX(4px);
      }

      ion-label {
        padding: 8px 0;

        .student-name {
          color: #ffffff;
          font-weight: 600;
          font-size: 0.95rem;
          margin: 0 0 4px 0;
        }

        .student-email {
          color: rgba(255, 255, 255, 0.7);
          font-size: 0.85rem;
          margin: 0 0 8px 0;
        }

        .badges-container {
          display: flex;
          gap: 6px;
          flex-wrap: wrap;

          ion-badge {
            font-size: 0.75rem;
            padding: 4px 8px;
            border-radius: 4px;

            &.curso-badge {
              --background: var(--azul-claro);
              color: #ffffff;
            }

            &.grupo-badge {
              --background: var(--verde);
              color: #ffffff;
            }
          }
        }
      }

      ion-icon[slot="end"] {
        font-size: 20px;
        color: rgba(255, 255, 255, 0.6);
      }
    }
  }
}

// Rubrics buttons horizontal layout
.rubricas-subsection {
  margin-top: 12px;

  .subsection-label {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.75rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 8px;

    ion-icon {
      font-size: 1rem;
    }
  }
}

// ========================================
// SECCIÓN DE PUNTOS - BARRA UNIFICADA RESPONSIVE
// ========================================
.puntos-section {
  padding: 0 !important;

  .rubrica-selector-bar {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    background: linear-gradient(135deg, rgba(15, 56, 90, 0.04) 0%, rgba(15, 56, 90, 0.01) 100%);
    border-radius: var(--rad-sm, 6px);
    border: 1px solid rgba(15, 56, 90, 0.1);
    flex-wrap: nowrap;
    justify-content: flex-start;
    transition: all 0.2s ease;

    &:hover {
      background: linear-gradient(135deg, rgba(15, 56, 90, 0.06) 0%, rgba(15, 56, 90, 0.02) 100%);
      border-color: rgba(15, 56, 90, 0.15);
    }

    @media (max-height: 500px) and (orientation: landscape) {
      padding: 4px 8px;
      gap: 4px;
    }

    // Header con título estilo destacado - Compacto
    .rubrica-header {
      display: flex;
      align-items: center;
      padding-right: 6px;
      border-right: 2px solid var(--azul-oscuro);
      margin-right: 2px;
      flex-shrink: 0;

      @media (max-height: 500px) and (orientation: landscape) {
        padding-right: 4px;
        border-right-width: 1px;
      }

      .rubrica-title {
        font-size: 0.72rem;
        font-weight: 800;
        color: var(--azul-oscuro);
        text-transform: uppercase;
        letter-spacing: 0.8px;
        white-space: nowrap;

        @media (max-height: 500px) and (orientation: landscape) {
          font-size: 0.65rem;
          letter-spacing: 0.5px;
        }
      }
    }

    // Segment Ionic (best practice) - Íconos compactos
    .tipo-segment {
      --background: rgba(255, 255, 255, 0.9);
      min-width: 70px;
      max-width: 80px;
      border-radius: 6px;
      border: 1px solid rgba(15, 56, 90, 0.15);
      flex-shrink: 0;

      @media (max-height: 500px) and (orientation: landscape) {
        min-width: 60px;
        max-width: 70px;
      }

      ion-segment-button {
        --indicator-color: var(--azul-oscuro);
        --color: var(--azul-oscuro);
        --color-checked: #ffffff;
        --background: transparent;
        --background-checked: var(--azul-oscuro);
        --padding-start: 6px;
        --padding-end: 6px;
        min-width: 32px;
        min-height: 28px;
        font-size: 0.7rem;
        transition: all 0.18s ease;

        @media (max-height: 500px) and (orientation: landscape) {
          min-width: 28px;
          min-height: 24px;
          --padding-start: 4px;
          --padding-end: 4px;
        }

        ion-icon {
          font-size: 1rem;
          color: var(--azul-oscuro);
          opacity: 0.75;
          transition: all 0.18s ease;

          @media (max-height: 500px) and (orientation: landscape) {
            font-size: 0.9rem;
          }
        }

        &.segment-button-checked ion-icon {
          color: #ffffff;
          opacity: 1;
          transform: scale(1.08);
        }

        &:hover:not(.segment-button-checked) {
          --background: rgba(15, 56, 90, 0.06);

          ion-icon {
            opacity: 1;
            transform: scale(1.05);
          }
        }
      }
    }

    // Botones de entrega compactos usando ion-button
    .entrega-buttons {
      display: flex;
      gap: 3px;
      flex-shrink: 0;

      @media (max-height: 500px) and (orientation: landscape) {
        gap: 2px;
      }

      .entrega-btn {
        --padding-start: 7px;
        --padding-end: 7px;
        --border-radius: 5px;
        --border-width: 1px;
        --border-color: var(--azul-claro);
        --color: var(--azul-oscuro);
        --background-hover: var(--azul-claro);
        --color-hover: #ffffff;
        min-width: 32px;
        height: 28px;
        font-size: 0.65rem;
        font-weight: 700;
        margin: 0;
        transition: all 0.18s ease;

        @media (max-height: 500px) and (orientation: landscape) {
          --padding-start: 5px;
          --padding-end: 5px;
          min-width: 28px;
          height: 24px;
          font-size: 0.6rem;
        }

        &:hover {
          --background: var(--azul-claro);
          --color: #ffffff;
          transform: translateY(-1px);
          box-shadow: 0 2px 6px rgba(15, 56, 90, 0.2);
        }

        &:active {
          transform: translateY(0);
        }
      }
    }
  }
}

// Responsive para pantallas pequeñas
@media (max-width: 320px) {
  .puntos-section .rubrica-selector-bar {
    flex-wrap: wrap;
    gap: 5px;
    padding: 6px 8px;

    .rubrica-header {
      flex-basis: 100%;
      justify-content: center;
      border-right: none;
      border-bottom: 1px solid var(--azul-oscuro);
      padding: 0 0 4px 0;
      margin: 0 0 4px 0;
    }

    .tipo-segment {
      flex: 1;
      min-width: 70px;
    }

    .entrega-buttons {
      flex: 1;
      justify-content: flex-end;
    }
  }
}

// Responsive para tablets pequeñas
@media (max-width: 480px) {
  .puntos-section .rubrica-selector-bar {
    gap: 5px;

    .rubrica-header .rubrica-title {
      font-size: 0.68rem;
    }

    .tipo-segment {
      min-width: 65px;
      max-width: 75px;
    }

    .entrega-buttons .entrega-btn {
      min-width: 30px;
      height: 26px;
      font-size: 0.62rem;
    }
  }
}

// Sección de integrantes con responsive
.integrantes-section {
  padding: 0;
}

// Columna de checkbox en la tabla
.col-check {
  width: 32px !important;
  min-width: 32px !important;
  padding: 4px !important;
  text-align: center !important;

  ion-checkbox {
    --size: 18px;
    --checkbox-background: rgba(15, 56, 90, 0.08);
    --checkbox-background-checked: var(--azul-claro);
    --border-color: rgba(15, 56, 90, 0.3);
    --border-color-checked: var(--azul-claro);
    --checkmark-color: #ffffff;
    --border-radius: 4px;
    --border-width: 1.5px;
    margin: 0;
    cursor: pointer;
  }
}

// Fila seleccionada en tabla de integrantes
.integrante-row {
  &.selected {
    background: rgba(14, 165, 233, 0.08) !important;

    .col-nombre .nombre-estudiante {
      font-weight: 600;
      color: var(--azul-oscuro);
    }
  }
}

.rubricas-grid-horizontal {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  margin-top: 6px;

  ion-button {
    flex: 1;
    min-width: 0;
    margin: 0;
    font-size: 0.65rem;
    --padding-start: 4px;
    --padding-end: 4px;
    height: 28px;

    ion-icon {
      font-size: 0.85rem;
      margin-right: 2px;
    }
  }
}

// ========================================
// ESTILOS MÓVIL - FAB Y PANEL DE SEGUIMIENTO
// ========================================

// Contenedor de FABs móvil
.mobile-fab-container {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 100;
  pointer-events: none;

  ion-fab {
    pointer-events: auto;
  }

  .menu-fab {
    --offset-bottom: 16px;
    --offset-start: 16px;

    ion-fab-button {
      --background: var(--azul-oscuro);
      --background-activated: #0d2e47;
      --box-shadow: 0 4px 12px rgba(15, 56, 90, 0.4);
    }
  }

  .seguimiento-fab {
    --offset-bottom: 16px;
    --offset-end: 16px;

    ion-fab-button {
      --background: var(--azul-claro);
      --background-activated: #1a8cb8;
      --box-shadow: 0 4px 12px rgba(31, 178, 222, 0.4);
    }
  }
}

// Overlay para cerrar el panel móvil
.mobile-seguimiento-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 199;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;

  &.visible {
    opacity: 1;
    visibility: visible;
  }
}

// Panel de seguimiento móvil - Desliza desde abajo
.mobile-seguimiento-panel {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  max-height: 70vh;
  min-height: 200px;
  background: #ffffff;
  border-radius: 20px 20px 0 0;
  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
  z-index: 200;
  transform: translateY(100%);
  transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  display: flex;
  flex-direction: column;
  overflow: hidden;

  // Optimización para landscape móvil
  @media (max-height: 500px) and (orientation: landscape) {
    max-height: 85vh;
    border-radius: 12px 12px 0 0;
  }

  &.visible {
    transform: translateY(0);
  }

  // Header del panel móvil
  .mobile-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: linear-gradient(135deg, var(--azul-oscuro) 0%, #0d2e47 100%);
    border-bottom: 2px solid var(--azul-claro);

    // Compacto en landscape
    @media (max-height: 500px) and (orientation: landscape) {
      padding: 6px 12px;
      border-bottom-width: 1px;
    }

    .panel-title {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #ffffff;
      font-size: 1rem;
      font-weight: 600;

      // Compacto en landscape
      @media (max-height: 500px) and (orientation: landscape) {
        font-size: 0.85rem;
        gap: 6px;
      }

      ion-icon {
        font-size: 1.2rem;

        @media (max-height: 500px) and (orientation: landscape) {
          font-size: 1rem;
        }
      }
    }

    ion-button {
      --color: #ffffff;
      margin: 0;

      @media (max-height: 500px) and (orientation: landscape) {
        --padding-start: 8px;
        --padding-end: 8px;
        font-size: 0.8rem;
      }
    }
  }

  // Contenido del panel móvil
  .mobile-panel-content {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
    // Nota: -webkit-overflow-scrolling removido (obsoleto en iOS 13+)

    // Compacto en landscape
    @media (max-height: 500px) and (orientation: landscape) {
      padding: 10px 12px;
    }
  }
}

// Placeholder móvil cuando no hay curso
.seguimiento-placeholder-mobile {
  text-align: center;
  padding: 24px 16px;
  color: #666;

  ion-icon {
    font-size: 48px;
    margin-bottom: 12px;
    opacity: 0.5;
  }

  h4 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--azul-oscuro);
    margin: 0 0 8px 0;
  }

  p {
    font-size: 0.85rem;
    line-height: 1.4;
    margin: 0;

    strong {
      color: var(--azul-claro);
    }
  }
}

// Sección de puntos móvil
.mobile-puntos-section {
  margin-bottom: 16px;
  padding-bottom: 16px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);

  // Compacto en landscape
  @media (max-height: 500px) and (orientation: landscape) {
    margin-bottom: 10px;
    padding-bottom: 10px;
  }

  .puntos-header-mobile {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
    gap: 12px;

    @media (max-height: 500px) and (orientation: landscape) {
      margin-bottom: 8px;
      gap: 8px;
    }

    .section-title-mobile {
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--azul-oscuro);
      letter-spacing: 0.5px;

      @media (max-height: 500px) and (orientation: landscape) {
        font-size: 0.7rem;
      }
    }

    .puntos-toggle-mobile {
      --background: rgba(15, 56, 90, 0.1);
      height: 28px;
      min-width: 150px;
      border-radius: 14px;

      @media (max-height: 500px) and (orientation: landscape) {
        height: 24px;
        min-width: 130px;
        font-size: 0.7rem;
      }

      ion-segment-button {
        --background-checked: var(--azul-claro);
        --color: var(--azul-oscuro);
        --color-checked: white;
        --indicator-color: transparent;
        min-height: 26px;
        font-size: 0.7rem;
        font-weight: 600;
        text-transform: none;
        border-radius: 12px;
        margin: 1px;
      }
    }
  }

  .rubricas-grid-mobile {
    display: flex;
    gap: 8px;

    ion-button {
      flex: 1;
      --padding-start: 12px;
      --padding-end: 12px;
      height: 36px;
      font-size: 0.85rem;
      font-weight: 600;
    }
  }
}

// Sección de integrantes móvil REEMPLAZADA por Resumen
.stats-grid-mobile {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-bottom: 16px;

  .stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 8px 4px;
    background: #f8fafc;
    border-radius: 10px;
    border: 1px solid rgba(15, 56, 90, 0.05);

    .stat-value {
      font-size: 1.1rem;
      font-weight: 800;
      color: var(--azul-oscuro);
      line-height: 1;
      margin-bottom: 2px;
    }

    .stat-label {
      font-size: 0.55rem;
      font-weight: 600;
      color: #64748b;
      text-transform: uppercase;
    }
  }
}

.summary-section-mobile {
  .section-title-premium-small {
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--azul-oscuro);
    margin: 0 0 12px 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .tipo-summary-list-mobile {
    display: flex;
    flex-direction: column;
    gap: 8px;

    .tipo-summary-item-mobile {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 12px;
      background: #f8fafc;
      border-radius: 10px;

      .tipo-info {
        display: flex;
        align-items: center;
        gap: 10px;

        .tipo-icon-small {
          width: 28px;
          height: 28px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.9rem;
        }

        .tipo-name-small {
          font-size: 0.75rem;
          font-weight: 600;
          color: #334155;
        }
      }

      .tipo-count-small {
        font-size: 0.7rem;
        font-weight: 700;
        padding: 2px 8px;
        border-radius: 10px;
      }
    }
  }
}

.panel-actions-mobile {
  margin-top: 24px;
  padding-bottom: 16px;

  ion-button {
    --border-radius: 12px;
    --font-weight: 600;
    margin: 0;
    height: 48px;
  }
}

// Ajuste del contenido principal para móvil
@media (max-width: 991px) {

  div#main-content.main-content-area,
  div.main-content-area {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    z-index: 1;

    ion-router-outlet {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }
  }

  // Ocultar sidebar desktop en móvil
  .desktop-sidebar {
    display: none !important;
  }
}