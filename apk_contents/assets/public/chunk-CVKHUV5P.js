import{a as Lo}from"./chunk-SLJSRLYX.js";import{a as jo}from"./chunk-HM6DYCTJ.js";import"./chunk-DVXHRAEI.js";import"./chunk-QUJFQN2Y.js";import"./chunk-HU5SCHDL.js";import"./chunk-7ZBUEDHH.js";import"./chunk-SNPQUAUI.js";import"./chunk-LEYHM6BU.js";import"./chunk-7NNPAAXG.js";import"./chunk-OONGQYNE.js";import"./chunk-WIPTHUM3.js";import"./chunk-GD6IOYHR.js";import"./chunk-ZKLT2ZXZ.js";import"./chunk-WZPJL45M.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-LQFYLWXH.js";import"./chunk-CKP3SGE2.js";import"./chunk-WOMA454Y.js";import{$ as R,Aa as q,Ab as se,Ac as $e,Bc as Oe,Bd as po,Ca as X,Cc as Ne,Db as ce,Dd as go,Eb as le,Ec as Fe,Fc as Me,G as m,Ga as Q,Gb as de,Gc as Ve,Ge as No,Hb as ue,Hc as je,Hd as ho,Ia as Z,Ib as pe,Ja as ee,Je as Fo,Ka as oe,Kb as ge,Le as Mo,Mb as he,Md as mo,N as J,Na as te,Nb as me,Nd as fo,Ob as fe,Oc as Le,Pb as be,Pd as bo,Pe as Vo,Qc as Ue,R as O,Rd as xo,Tb as xe,Tc as Be,Td as vo,Uc as qe,Ud as wo,Vc as He,Vd as Co,W as z,Wc as Ke,Wd as Eo,X as _,Xb as ve,Xc as Ye,Z as T,Zc as Je,_ as D,_d as So,aa as S,ac as we,ad as We,ae as zo,ba as d,bb as ie,ca as u,cb as ae,cd as Xe,ce as _o,da as C,dd as Qe,de as Ao,ec as Ce,ed as Ze,ee as yo,fb as re,fe as ko,gb as ne,ge as Po,ha as A,hc as Ee,he as Io,i as V,ia as E,ie as Go,ja as g,jc as Se,jd as eo,k as G,kc as ze,lc as _e,ld as oo,mc as Ae,md as to,nc as ye,nd as io,oe as To,pc as ke,qc as Pe,qd as ao,ra as j,rd as ro,re as Do,sa as L,sc as Ie,sd as no,se as Ro,t as k,te as $o,ua as x,ue as Oo,va as P,vc as Ge,vd as so,wa as N,wc as Te,x as v,xa as W,xd as co,y as w,ya as U,yc as De,yd as lo,za as B,zc as Re,zd as uo}from"./chunk-OBFQNIQD.js";import"./chunk-IUPZEBQM.js";import"./chunk-ELQ7OX2S.js";import"./chunk-TPXQ57Z4.js";import"./chunk-WSSRTRMN.js";import"./chunk-BRTOTKMZ.js";import"./chunk-WKTTIGE2.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-4YRHGV2P.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as M,b as Y,i as f}from"./chunk-RLOPVUMC.js";var Bo=()=>["E1","E2","EF"];function qo(c,b){if(c&1){let n=A();d(0,"ion-segment-button",17)(1,"ion-label")(2,"div",18)(3,"div",19)(4,"span",20),x(5),u()(),d(6,"ion-button",21),E("click",function(o){let t=v(n).$implicit;return g(2).abrirMenuColor(o,t),w(o.stopPropagation())}),C(7,"ion-icon",22),u()()()()}if(c&2){let n,e=b.$implicit,o=g(2);j("--background-checked",o.getCourseColor(e))("--color-checked","#ffffff")("--border-color",o.getCourseColor(e)),S("value",e),m(5),P(((n=o.getCursoMetadataForCourse(e))==null?null:n.codigo)||e)}}function Ho(c,b){c&1&&C(0,"ion-icon",39)}function Ko(c,b){if(c&1){let n=A();d(0,"div",38),E("click",function(){let o=v(n).$implicit,t=g(3);return w(t.cambiarColorCurso(o))}),z(1,Ho,1,0,"ion-icon",39),u()}if(c&2){let n=b.$implicit,e=g(3);j("background-color",n),L("selected",e.colorSeleccionado===n),S("title",n),m(),_(e.colorSeleccionado===n?1:-1)}}function Yo(c,b){if(c&1){let n=A();d(0,"div",23)(1,"div",24)(2,"span"),x(3,"\u{1F3A8} Selector de Color"),u(),d(4,"ion-button",25),E("click",function(){v(n);let o=g(2);return w(o.cerrarMenuColor())}),C(5,"ion-icon",26),u()(),d(6,"div",27)(7,"div",28),D(8,Ko,2,6,"div",29,T),u(),d(10,"div",30)(11,"div",31)(12,"label",32),x(13,"C\xF3digo Hexadecimal"),u(),d(14,"ion-input",33),q("ngModelChange",function(o){v(n);let t=g(2);return B(t.colorSeleccionado,o)||(t.colorSeleccionado=o),w(o)}),E("ionInput",function(o){v(n);let t=g(2);return w(t.validarColorHex(o))}),u(),d(15,"p",34),x(16,"Ej: #FF5733, #1976D2"),u()()()(),d(17,"div",35)(18,"ion-button",36),E("click",function(){v(n);let o=g(2);return w(o.cerrarMenuColor())}),x(19," Cancelar "),u(),d(20,"ion-button",37),E("click",function(){v(n);let o=g(2);return w(o.aplicarColorCurso())}),x(21," Aplicar Color "),u()()()}if(c&2){let n=g(2);m(8),R(n.coloresDisponibles),m(6),U("ngModel",n.colorSeleccionado)}}function Jo(c,b){if(c&1){let n=A();d(0,"ion-card")(1,"ion-card-content")(2,"ion-segment",14),q("ngModelChange",function(o){v(n);let t=g();return B(t.cursoActivo,o)||(t.cursoActivo=o),w(o)}),E("ionChange",function(o){v(n);let t=g();return w(t.onCursoChange(o))}),O(3,qo,8,8,"ion-segment-button",15),u(),d(4,"ion-popover",16),E("didDismiss",function(){v(n);let o=g();return w(o.cerrarMenuColor())}),O(5,Yo,22,1,"ng-template"),u()()()}if(c&2){let n=g();m(2),U("ngModel",n.cursoActivo),m(),S("ngForOf",n.cursosDisponibles)("ngForTrackBy",n.trackByCurso),m(),S("isOpen",n.menuColorVisible)("event",n.colorPopoverEvent)}}function Wo(c,b){c&1&&(d(0,"div",12)(1,"div",40),C(2,"ion-icon",41),d(3,"h3"),x(4,"No hay cursos disponibles."),u(),d(5,"p"),x(6,"Seleccione (bot\xF3n "),d(7,"strong"),x(8,"Crear"),u(),x(9,")"),u()()())}function Xo(c,b){if(c&1&&(d(0,"div",46),C(1,"ion-icon",50),d(2,"span",51),x(3),u(),d(4,"span",52),x(5),u()()),c&2){let n=g(2);m(3),N("Grupo ",n.filtroGrupo),m(2),N("",n.obtenerIntegrantesGrupo().length," integrantes")}}function Qo(c,b){if(c&1){let n=A();d(0,"div",53),E("click",function(){v(n);let o=g(2);return w(o.modoMantenerVistaMatriz=!o.modoMantenerVistaMatriz)}),C(1,"ion-icon",54),u()}if(c&2){let n=g(2);S("title",n.modoMantenerVistaMatriz?"Vista bloqueada - Clic para desbloquear":"Vista libre - Clic para bloquear"),m(),S("name",n.modoMantenerVistaMatriz?"lock-closed":"lock-open")}}function Zo(c,b){if(c&1){let n=A();d(0,"th",59),E("click",function(){let o=v(n).$implicit,t=g(3);return w(t.onClickEncabezadoGrupo(o))}),x(1),u()}if(c&2){let n=b.$implicit,e=g(3);S("title",e.modoMantenerVistaMatriz?"Ver integrantes del Grupo "+n:"Ir a detalles del Grupo "+n),m(),P(n)}}function et(c,b){if(c&1){let n=A();d(0,"td",62),E("click",function(){let o=v(n).$implicit,t=g().$implicit,i=g(3);return w(i.navegarAGrupoEntrega(o,t))}),C(1,"span",63),u()}if(c&2){let n=b.$implicit,e=g().$implicit,o=g(3);L("estado-completo",o.getEstadoEntregaGrupo(e,n)==="completo")("estado-parcial",o.getEstadoEntregaGrupo(e,n)==="parcial")("estado-pendiente",o.getEstadoEntregaGrupo(e,n)==="pendiente"),S("title",o.getTituloEstado(e,n))}}function ot(c,b){if(c&1&&(d(0,"tr")(1,"td",60),x(2),u(),D(3,et,2,7,"td",61,T),u()),c&2){let n=b.$implicit,e=g(3);m(2),P(n),m(),R(e.gruposDisponibles)}}function tt(c,b){if(c&1&&(d(0,"div",48)(1,"table",55)(2,"thead")(3,"tr")(4,"th",56),C(5,"ion-icon",57),u(),D(6,Zo,2,2,"th",58,T),u()(),d(8,"tbody"),D(9,ot,5,1,"tr",null,T),u()()()),c&2){let n=g(2);m(6),R(n.gruposDisponibles),m(3),R(X(0,Bo))}}function it(c,b){if(c&1){let n=A();d(0,"div",67)(1,"div",85)(2,"span",86),x(3),u(),d(4,"ion-chip",87)(5,"strong"),x(6),u()(),d(7,"ion-button",88),E("click",function(){v(n);let o=g(4);return w(o.guardarEvaluacionRubrica())}),C(8,"ion-icon",89),x(9," Guardar "),u(),d(10,"ion-button",90),E("click",function(){v(n);let o=g(4);return w(o.cerrarRubrica())}),C(11,"ion-icon",91),u()(),d(12,"div",92)(13,"app-evaluacion-rubrica",93),E("puntuacionChange",function(o){v(n);let t=g(4);return w(t.puntosRubricaTotales=o)})("calificacionesChange",function(o){v(n);let t=g(4);return w(t.onCalificacionesChange(o))})("evaluacionGuardada",function(o){v(n);let t=g(4);return w(t.onEvaluacionGuardada(o))}),u()()()}if(c&2){let n=g(4);m(3),N("\u{1F4CB} ",n.rubricaActual.nombre),m(3),W("",n.puntosRubricaTotales," / ",n.rubricaActual.puntuacionTotal," pts"),m(7),S("rubrica",n.rubricaActual)("estudianteId",n.estudianteSeleccionado||"grupal")("nombreEstudiante",n.estudianteSeleccionado?n.obtenerNombreEstudianteSeleccionado():"Evaluaci\xF3n Grupal")("evaluacionExistente",n.evaluacionActual)("grupoId",n.filtroGrupo)("entregaActual",n.entregaEvaluando||"")}}function at(c,b){c&1&&(d(0,"div",68)(1,"p"),x(2,"Cargando evaluaci\xF3n..."),u()())}function rt(c,b){c&1&&(d(0,"div",69),C(1,"ion-icon",94),d(2,"p"),x(3,"Seleccione una entrega para evaluar"),u()())}function nt(c,b){if(c&1&&(d(0,"ion-badge",74),x(1),u()),c&2){let n=g(4);m(),P(n.entregaEvaluando)}}function st(c,b){c&1&&(d(0,"div",82)(1,"ion-text",95)(2,"small"),x(3,"\u{1F446} Seleccione estudiantes del panel de seguimiento"),u()()())}function ct(c,b){if(c&1){let n=A();d(0,"pre",96),x(1),u(),d(2,"ion-button",97),E("click",function(){v(n);let o=g(4);return w(o.limpiarEstadosGrupo())}),C(3,"ion-icon",98),x(4," Limpiar "),u()}if(c&2){let n=g(4);m(),P(n.anotacionesGrupo)}}function lt(c,b){c&1&&x(0," Seleccione un estado y luego los estudiantes ")}function dt(c,b){c&1&&x(0," Seleccione una entrega para hacer anotaciones ")}function ut(c,b){if(c&1&&(d(0,"p",84),z(1,lt,1,0)(2,dt,1,0),u()),c&2){let n=g(4);m(),_(n.entregaEvaluando?1:2)}}function pt(c,b){if(c&1){let n=A();d(0,"div",64)(1,"div",66),z(2,it,14,9,"div",67)(3,at,3,0,"div",68)(4,rt,4,0,"div",69),u(),d(5,"div",70)(6,"div",71)(7,"div",72),C(8,"ion-icon",73),d(9,"span"),x(10,"Anotaciones"),u(),z(11,nt,2,1,"ion-badge",74),u(),d(12,"div",75)(13,"ion-button",76),E("click",function(){v(n);let o=g(3);return w(o.toggleModoSeleccionEstado("ok"))}),C(14,"ion-icon",77),u(),d(15,"ion-button",78),E("click",function(){v(n);let o=g(3);return w(o.toggleModoSeleccionEstado("solo"))}),C(16,"ion-icon",79),u(),d(17,"ion-button",80),E("click",function(){v(n);let o=g(3);return w(o.toggleModoSeleccionEstado("ausente"))}),C(18,"ion-icon",81),u()(),z(19,st,4,0,"div",82),d(20,"div",83),z(21,ct,5,1)(22,ut,3,1,"p",84),u()()()()}if(c&2){let n=g(3);m(2),_(n.mostrarRubrica&&n.rubricaActual?2:n.mostrarRubrica&&n.rubricaActual?3:4),m(9),_(n.entregaEvaluando?11:-1),m(2),S("fill",n.modoSeleccionEstado==="ok"?"solid":"outline")("disabled",!n.entregaEvaluando),m(2),S("fill",n.modoSeleccionEstado==="solo"?"solid":"outline")("disabled",!n.entregaEvaluando),m(2),S("fill",n.modoSeleccionEstado==="ausente"?"solid":"outline")("disabled",!n.entregaEvaluando),m(2),_(n.modoSeleccionEstado?19:-1),m(2),_(n.anotacionesGrupo?21:22)}}function gt(c,b){c&1&&(d(0,"ion-item",65),C(1,"ion-icon",99),d(2,"ion-label",95)(3,"p"),x(4,"No hay integrantes en este grupo"),u()()())}function ht(c,b){if(c&1&&(d(0,"div",49),z(1,pt,23,10,"div",64)(2,gt,5,0,"ion-item",65),u()),c&2){let n=g(2);m(),_(n.obtenerIntegrantesGrupo().length>0?1:2)}}function mt(c,b){if(c&1&&(d(0,"div",13)(1,"ion-card",42)(2,"ion-card-header",43)(3,"div",44),C(4,"ion-icon",45),u(),z(5,Xo,6,2,"div",46),z(6,Qo,2,2,"div",47),u(),d(7,"ion-card-content"),z(8,tt,11,1,"div",48)(9,ht,3,1,"div",49),u()()()),c&2){let n=g();m(5),_(n.filtroGrupo!=="todos"?5:-1),m(),_(n.filtroGrupo==="todos"?6:-1),m(2),_(n.filtroGrupo==="todos"?8:9)}}var Tt=(()=>{let b=class b{get textoSeguimientoRubrica(){return this.tipoEvaluando==="PG"?this.textoSeguimientoRubricaGrupal:this.textoSeguimientoRubricaIndividual}set textoSeguimientoRubrica(e){this.tipoEvaluando==="PG"?this.textoSeguimientoRubricaGrupal=e:this.textoSeguimientoRubricaIndividual=e}get tieneComentariosGrupales(){return this.textoSeguimientoRubricaGrupal.length>0&&this.textoSeguimientoRubricaGrupal.some(e=>e)}get tieneComentariosIndividuales(){return this.textoSeguimientoRubricaIndividual.length>0&&this.textoSeguimientoRubricaIndividual.some(e=>e)}generarCodigoCurso(e){let o=["DE","EN","DEL","LA","EL","LOS","LAS","A","CON","PARA","POR","Y"],t=i=>i.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase();return e.split(/\s+/).filter(i=>i.length>2).map(i=>t(i)).filter(i=>!o.includes(i)).map(i=>i[0]).join("")}constructor(){this.cursosData={},this.cursoActivo=null,this.estudiantesActuales=[],this.estudiantesFiltrados=[],this.filtroGrupo="todos",this.busquedaGeneral="",this.gruposDisponibles=[],this.estudianteSeleccionado=null,this._estudiantesCargadosPorCurso=new Map,this._calificacionesCargadasPorCurso=new Map,this.actualizandoGrupoDesdeSuscripcion=!1,this.estudiantesSeleccionados=new Set,this.mostrarNombreCorto=!1,this.mostrarComentarios=!1,this.menuAccionesAbierto=!1,this.menuFabAbierto=!1,this.cursosOrdenados=[],this.elementoArrastrado=null,this.indiceDragDestino=-1,this.mostrarRubrica=!1,this.rubricaActual=null,this.evaluacionActual=null,this.entregaEvaluando=null,this.tipoEvaluando=null,this.criteriosEvaluados=[],this.puntosRubricaTotales=0,this.rubricaGrupoSeleccionada=null,this.modoEdicionRubrica=!1,this.criterioActualIndex=0,this.textoSeguimientoRubricaGrupal=[],this.textoSeguimientoRubricaIndividual=[],this.timestampsSeguimiento=[],this.puntosPersonalizados={},this.comentariosCriterios={},this.nivelesSeleccionados={},this.menuColorVisible=!1,this.cursoParaCambiarColor=null,this.colorSeleccionado=null,this.colorPopoverEvent=null,this.modoMantenerVistaMatriz=!0,this.modoSeleccionEstado=null,this.anotacionesGrupo="",this.coloresDisponibles=["#d32f2f","#c2185b","#7b1fa2","#512da8","#303f9f","#1976d2","#0288d1","#0097a7","#00796b","#388e3c","#689f38","#f57c00","#e64a19","#ff2719"],this.comentariosFrecuentes=["Excelente trabajo, supera las expectativas","Buen trabajo, cumple con los requisitos","Necesita mejorar en algunos aspectos","Requiere trabajo adicional","Consultar con el profesor","Presenta creatividad e innovaci\xF3n","Demuestra comprensi\xF3n profunda del tema","Cumple parcialmente con los requisitos","No cumple con los criterios establecidos","Evidencia falta de preparaci\xF3n","Muestra progreso significativo","Requiere revisi\xF3n y correcci\xF3n","Aplicaci\xF3n correcta de conceptos","Faltan elementos importantes","Trabajo sobresaliente en esta \xE1rea"],this.grupoSeguimientoActivo=null,this.evaluacionesCache=new Map,this.CACHE_TTL=3e4,this.cacheCalificacionesCanvas=new Map,this.nuevoComentario="",this.comentariosGrupoActual=[],this.comentarioEditando=null,this.textoEditando="",this.aplicarATodos=!1,this.aplicarAMas=!1,this.lastAppliedFilter={cursoActivo:"",filtroGrupo:"",busquedaGeneral:"",estudiantesCount:0},this.CATEGORIA_RUBRICAS_DEFAULT="epm",this.anchoPanel=455,this.redimensionandoPanel=!1,this.anchoMinimo=250,this.anchoMaximo=650,this._integrantesGrupoCache=null,this._filtroGrupoCache=null,this._calificacionesPanelCache=new Map,this.subscriptions=[],this.dataService=k(Vo),this.menuController=k(Ae),this.alertController=k(Se),this.seguimientoService=k(jo),this.toastController=k(ye),this.loadingController=k(_e),this.popoverController=k(Ee),this.gestureCtrl=k(ze),this.cdr=k(Q),Ge({ellipsisVerticalOutline:lo,arrowBackOutline:Ne,arrowForwardOutline:Me,ellipsisVertical:co,closeOutline:Ze,checkmarkCircle:Be,documentText:ro,informationCircle:mo,peopleCircle:yo,rocket:Do,saveOutline:$o,documentTextOutline:no,createOutline:to,gitMerge:ho,closeCircle:Xe,people:Ao,trashOutline:Fo,alertCircle:Re,arrowForward:Fe,lockClosed:wo,lockOpen:Co,scanOutline:Oo,enterOutline:uo,eye:po,logIn:Eo,eyeOutline:go,informationCircleOutline:fo,alertCircleOutline:$e,listOutline:vo,copyOutline:oo,personOutline:Go,analyticsOutline:Oe,checkmarkCircleOutline:qe,cubeOutline:io,timeOutline:No,peopleOutline:ko,documentOutline:ao,trophyOutline:Mo,personCircleOutline:Io,arrowUndoOutline:je,arrowRedoOutline:Ve,chevronBackOutline:Ye,chevronForwardOutline:Je,clipboardOutline:We,checkmarkOutline:Ke,notificationsOutline:zo,checkmarkDoneOutline:He,linkOutline:xo,downloadOutline:so,cloudUploadOutline:eo,refreshOutline:To,addCircleOutline:De,chatbubblesOutline:Ue,closeCircleOutline:Qe,pencilOutline:_o,person:Po,layersOutline:bo,menuOutline:So,save:Ro,chatboxOutline:Le,add:Te}),this.cargarOrdenCursos()}ngOnInit(){return f(this,null,function*(){yield this.dataService.ensureInitialized(),this.cargarComentariosFrecuentes(),this.subscriptions.push(this.dataService.cursos$.pipe(G((o,t)=>{let i=Object.keys(o).sort(),a=Object.keys(t).sort();if(i.length!==a.length||i.join()!==a.join())return!1;for(let r of i){let s=Array.isArray(o[r])?o[r].length:0,l=Array.isArray(t[r])?t[r].length:0;if(s!==l)return!1}return!0})).subscribe(o=>{let t=Object.keys(o).length,i=Object.values(o).reduce((r,s)=>r+(Array.isArray(s)?s.length:0),0);console.log(`\u{1F4DA}[cursos$.subscribe] ${new Date().toISOString().substr(11,12)} `,{totalCursos:t,totalEstudiantes:i,cursos:Object.keys(o)}),this.cursosData=o;let a=Object.keys(o);this.cursosOrdenados.length!==a.length&&(console.log(`\u{1F504} Actualizando cursosOrdenados: ${this.cursosOrdenados.length} -> ${a.length}`),this.cursosOrdenados=[...a].sort()),this.cursoActivo&&!o[this.cursoActivo]&&(console.log("\u26A0\uFE0F [InicioPage] Curso activo eliminado:",this.cursoActivo),this.cursoActivo=null,this.estudiantesActuales=[],this.gruposDisponibles=[],this.aplicarFiltros()),this.cdr.detectChanges()})),this.subscriptions.push(this.dataService.uiState$.pipe(G((o,t)=>o.cursoActivo===t.cursoActivo)).subscribe(o=>{if(o.cursoActivo&&o.cursoActivo!==this.cursoActivo){console.log("\u{1F504}[uiState$.subscribe] Curso activo cambi\xF3 a:",o.cursoActivo);let t=this.dataService.getCursos();Object.keys(t).length>Object.keys(this.cursosData).length&&(console.log("\u{1F4E5} Actualizando cursosData desde DataService"),this.cursosData=t),this.seleccionarCurso(o.cursoActivo)}})),this.subscriptions.push(this.dataService.globalSearch$.pipe(G(),V(50)).subscribe(o=>{this.busquedaGeneral=o,this.aplicarFiltros(),this.cdr.detectChanges()})),this.subscriptions.push(this.seguimientoService.grupoSeleccionado$.pipe(G(),V(100)).subscribe(o=>{if(!this.actualizandoGrupoDesdeSuscripcion){if(this.actualizandoGrupoDesdeSuscripcion=!0,o===0)this.filtroGrupo="todos",this.grupoSeguimientoActivo=null;else{let t=o.toString();this.gruposDisponibles.length===0||this.gruposDisponibles.includes(t)?(this.filtroGrupo=t,this.grupoSeguimientoActivo=t):console.warn("\u26A0\uFE0F Grupo no encontrado en gruposDisponibles:",o,"disponibles:",this.gruposDisponibles)}this.aplicarFiltros(),this.cdr.detectChanges(),this.actualizandoGrupoDesdeSuscripcion=!1}})),this.subscriptions.push(this.dataService.calificacionesCanvasActualizadas$.subscribe(o=>{o&&o.curso&&(console.log("\u{1F4E2} [cursos.page] Recibida notificaci\xF3n: calificaciones actualizadas para",o.curso),this._calificacionesCargadasPorCurso.delete(o.curso),this.cursoActivo===o.curso&&(console.log("\u{1F504} [cursos.page] Recargando calificaciones del curso activo"),this.limpiarCacheCalificaciones(),this.precargarCalificacionesCurso(),this._calificacionesCargadasPorCurso.set(o.curso,!0),this.cdr.detectChanges()))})),window.addEventListener("abrirRubrica",o=>{let{entrega:t,tipo:i}=o.detail;this.abrirRubricaEntrega(t,i)});let e=this.dataService.getUIState();e.mostrarNombreCorto!==void 0&&(this.mostrarNombreCorto=e.mostrarNombreCorto)})}cargarDatosIniciales(){return f(this,null,function*(){yield this.dataService.loadCursos(),this.cursosData=this.dataService.getCursos();let e=this.dataService.getUIState();e.cursoActivo&&this.cursosData[e.cursoActivo]&&this.seleccionarCurso(e.cursoActivo)})}ionViewWillEnter(){return f(this,null,function*(){let e=this.dataService.getUIState(),o=e.cursoActivo,t=!!o,i=o?!!this.cursosData[o]:!1;if(Object.keys(this.cursosData).length===0){this.cargarDatosIniciales();return}if(t&&!i){this.cargarDatosIniciales();return}if(t&&i){if(this.estudiantesActuales.length===0){this.seleccionarCurso(e.cursoActivo);return}this.aplicarFiltros()}})}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}get layoutStyles(){return{"grid-template-columns":`1fr 4px ${this.anchoPanel}px`}}openMenu(){this.menuController.open("main-menu")}get cursosDisponibles(){let e=Object.keys(this.cursosData);return(this.cursosOrdenados.length===0||this.cursosOrdenados.length!==e.length)&&(this.cursosOrdenados=[...e].sort()),e.forEach(o=>{this.cursosOrdenados.includes(o)||this.cursosOrdenados.push(o)}),this.cursosOrdenados=this.cursosOrdenados.filter(o=>e.includes(o)),this.cursosOrdenados}onCursoChange(e){let o=e.detail.value;o&&o!==this.cursoActivo&&this.seleccionarCurso(o)}seleccionarCurso(e){return f(this,null,function*(){let o=new Date().toISOString().substr(11,12);if(this.cursoActivo===e&&this._estudiantesCargadosPorCurso.has(e)&&this.estudiantesActuales.length>0)return;this.cursoActivo=e;let t=this.cursosData[e]||[],a=this.estudiantesActuales.length!==t.length;(!this._estudiantesCargadosPorCurso.has(e)||a)&&(this.estudiantesActuales=t,this._estudiantesCargadosPorCurso.set(e,!0)),this.estudiantesSeleccionados.clear(),this.estudianteSeleccionado=null,this.actualizarGrupos(),this._calificacionesCargadasPorCurso.has(e)||(this.precargarCalificacionesCurso(),this._calificacionesCargadasPorCurso.set(e,!0));let r=this.dataService.getCourseState(e);if(r?.filtroGrupo&&r.filtroGrupo!=="todos"&&this.gruposDisponibles.includes(r.filtroGrupo)){if(this.filtroGrupo!==r.filtroGrupo){this.grupoSeguimientoActivo=r.filtroGrupo,this.filtroGrupo=r.filtroGrupo;let s=parseInt(r.filtroGrupo.replace(/\D/g,""));this.seguimientoService.setGrupoSeleccionado(s)}}else this.grupoSeguimientoActivo=null,this.filtroGrupo="todos",this.seguimientoService.setGrupoSeleccionado(0);this.aplicarFiltros(),this.dataService.updateUIState({cursoActivo:e}),this.entregaEvaluando=null,this.tipoEvaluando=null,this.limpiarPanelSeguimiento(),this.cdr.detectChanges()})}actualizarGrupos(){let e=[...new Set(this.estudiantesActuales.map(o=>o.grupo))];this.gruposDisponibles=e.sort((o,t)=>{let i=parseInt(o)||0,a=parseInt(t)||0;return i-a})}aplicarFiltros(){let e={cursoActivo:this.cursoActivo||"",filtroGrupo:this.filtroGrupo,busquedaGeneral:this.busquedaGeneral,estudiantesCount:this.estudiantesActuales.length},o=JSON.stringify(e),t=JSON.stringify(this.lastAppliedFilter);if(o===t)return;this.lastAppliedFilter=e,this.estudiantesActuales.length===0&&this.cursoActivo&&this.cursosData[this.cursoActivo]&&(console.warn("\u26A0\uFE0F [aplicarFiltros] EMERGENCIA: cargando desde cursosData"),this.estudiantesActuales=this.cursosData[this.cursoActivo],this._estudiantesCargadosPorCurso.set(this.cursoActivo,!0),this.actualizarGrupos());let i=this.estudiantesActuales.length,a=[...this.estudiantesActuales],r=this.seguimientoService.getGrupoSeleccionado(),s=this.filtroGrupo!=="todos"?this.filtroGrupo:r>0?`${r} `:null;if(s&&s!=="todos"){let p=s.toString().replace(/\D/g,"");a=a.filter(h=>h.grupo===p)}if(this.busquedaGeneral.trim()){let p=this.busquedaGeneral.toLowerCase();a=a.filter(h=>h.nombres.toLowerCase().includes(p)||h.apellidos.toLowerCase().includes(p)||h.correo.toLowerCase().includes(p))}a=this.ordenarPorGrupos(a),(a.length!==this.estudiantesFiltrados.length||!a.every((p,h)=>p.correo===this.estudiantesFiltrados[h]?.correo))&&(this.estudiantesFiltrados=a)}ordenarPorGrupos(e){return e.sort((o,t)=>{let i=parseInt(o.grupo.replace(/\D/g,""),10)||0,a=parseInt(t.grupo.replace(/\D/g,""),10)||0;return i-a})}onFiltroGrupoChange(e){let o=e.detail.value;if(this.filtroGrupo===o){console.log("\u26A1 [onFiltroGrupoChange] Skipped - mismo grupo:",o);return}if(this.filtroGrupo=o,this.grupoSeguimientoActivo=o!=="todos"?o:null,this.modoSeleccionEstado=null,console.log("\u{1F504} [onFiltroGrupoChange] Cambio de grupo:",{filtroGrupo:this.filtroGrupo,grupoSeguimientoActivo:this.grupoSeguimientoActivo}),this.cursoActivo&&this.dataService.updateCourseState(this.cursoActivo,{filtroGrupo:o}),o!=="todos"){let t=parseInt(o.replace(/\D/g,""));this.seguimientoService.setGrupoSeleccionado(t)}this.aplicarFiltros(),this.actualizarAnotacionesDesdeEstados(),this.mostrarRubrica&&this.tipoEvaluando&&o!=="todos"?(console.log("\u{1F4CA} [onFiltroGrupoChange] Cargando evaluaci\xF3n guardada para grupo:",o),this.cargarEvaluacionGuardada().then(()=>{console.log("\u{1F4CA} [onFiltroGrupoChange] evaluacionActual despu\xE9s de cargar:",this.evaluacionActual),this.emitToSeguimientoPanel(),this.cdr.detectChanges()})):(this.evaluacionActual=null,this.reiniciarEstadoEvaluacion(),this.limpiarPanelSeguimiento(),this.cdr.detectChanges())}getGruposCalificados(){if(!this.cursoActivo)return[];let e=this.dataService.getAllEvaluaciones(),o=this.gruposDisponibles,t=["E1","E2","EF"],i=[];return o.forEach(a=>{let r={E1:!1,E2:!1,EF:!1};t.forEach(l=>{let p=`${this.cursoActivo}_${l}_PG_${a} `;e[p]&&(r[l]=!0)});let s=Object.values(r).filter(l=>l).length;if(s>0){let l=this.estudiantesActuales.filter(p=>p.grupo===a).length;i.push({grupo:a,entregas:r,totalEntregas:s,porcentaje:Math.round(s/3*100),integrantes:l})}}),i.sort((a,r)=>{let s=parseInt(a.grupo)||0,l=parseInt(r.grupo)||0;return s-l})}getGruposPendientes(){if(!this.cursoActivo)return[];let e=this.dataService.getAllEvaluaciones(),o=this.gruposDisponibles,t=["E1","E2","EF"],i=[];return o.forEach(a=>{let r={E1:!1,E2:!1,EF:!1};t.forEach(l=>{let p=`${this.cursoActivo}_${l}_PG_${a} `;e[p]&&(r[l]=!0)});let s=Object.values(r).filter(l=>!l).length;if(s>0){let l=this.estudiantesActuales.filter(p=>p.grupo===a).length;i.push({grupo:a,entregas:r,totalPendientes:s,integrantes:l})}}),i.sort((a,r)=>{let s=parseInt(a.grupo)||0,l=parseInt(r.grupo)||0;return s-l})}onClickEncabezadoGrupo(e){this.modoMantenerVistaMatriz?this.seleccionarGrupoParaSeguimiento(e):this.navegarAGrupo(e)}seleccionarGrupoParaSeguimiento(e){let o=parseInt(e.replace(/\D/g,""))||0;o!==0&&(this.grupoSeguimientoActivo=e,this.seguimientoService.setGrupoVisualizado(o))}navegarAGrupo(e){if(this.filtroGrupo===e)return;this.filtroGrupo=e,this.grupoSeguimientoActivo=e,this.cursoActivo&&this.dataService.updateCourseState(this.cursoActivo,{filtroGrupo:e});let o=parseInt(e.replace(/\D/g,""));this.seguimientoService.setGrupoSeleccionado(o),this.aplicarFiltros(),this.cdr.detectChanges()}getEstadoEntregaGrupo(e,o){if(!this.cursoActivo)return"pendiente";let t=this.dataService.getAllEvaluaciones(),i=`${this.cursoActivo}_${e}_PG_${o}`,a=this.estudiantesActuales.filter(p=>p.grupo===o);if(a.length===0)return"pendiente";let r=!!t[i],s=0;a.forEach(p=>{let h=`${this.cursoActivo}_${e}_PI_${p.correo}`;t[h]&&s++});let l=a.length;return r&&s===l?"completo":r||s>0?"parcial":"pendiente"}getTituloEstado(e,o){if(!this.cursoActivo)return"";let t=this.getEstadoEntregaGrupo(e,o),i=this.estudiantesActuales.filter(h=>h.grupo===o),a=i.length,r=this.dataService.getAllEvaluaciones(),s=`${this.cursoActivo}_${e}_PG_${o}`,l=!!r[s],p=0;return i.forEach(h=>{let y=`${this.cursoActivo}_${e}_PI_${h.correo}`;r[y]&&p++}),t==="completo"?`Grupo ${o} - ${e}: \u2705 Completo (PG + ${a}/${a} PI)`:t==="parcial"?`Grupo ${o} - ${e}: \u26A0\uFE0F Parcial (${l?"PG \u2713":"PG \u2717"} + ${p}/${a} PI)`:`Grupo ${o} - ${e}: \u274C Pendiente (0/${a} evaluados)`}navegarAGrupoEntrega(e,o){if(!this.cursoActivo)return;this.navegarAGrupo(e);let t=this.dataService.getCourseState(this.cursoActivo);t&&(t.activeDelivery=o,this.dataService.updateCourseState(this.cursoActivo,t)),console.log(`\u{1F4CD} Navegando a Grupo ${e} - ${o}`),this.cdr.detectChanges()}esEstudianteSeleccionado(e){return this.estudiantesSeleccionados.has(e)}renombrarCurso(){return f(this,null,function*(){if(!this.cursoActivo)return;let o=this.dataService.getCourseState(this.cursoActivo)?.metadata?.nombre||this.cursoActivo;yield(yield this.alertController.create({header:"Actualizar Nombre del Curso",message:"El c\xF3digo del curso no cambiar\xE1, solo su nombre descriptivo:",inputs:[{name:"nuevoNombre",type:"text",value:o,placeholder:"Nombre completo del curso"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Actualizar",handler:i=>f(this,null,function*(){if(i.nuevoNombre&&i.nuevoNombre.trim()!==o)try{yield this.dataService.actualizarNombreCurso(this.cursoActivo,i.nuevoNombre.trim()),yield(yield this.toastController.create({message:"Nombre actualizado correctamente",duration:2e3,color:"success",position:"top",cssClass:"toast-success"})).present()}catch(a){this.mostrarError("Error al actualizar nombre",a.message)}})}]})).present()})}exportarNotas(e){this.cursoActivo&&this.dataService.exportarNotasCSV(this.cursoActivo,e)}sincronizarArchivoCalificaciones(){return f(this,null,function*(){if(!this.cursoActivo){yield this.mostrarError("Error","No hay curso activo seleccionado");return}if(!this.dataService.obtenerArchivoCalificaciones(this.cursoActivo)){yield this.mostrarError("Sin archivo","No hay archivo de calificaciones asociado a este curso. Vaya a Configuraci\xF3n para cargar uno.");return}try{yield this.dataService.sincronizarArchivoCalificaciones(this.cursoActivo),yield(yield this.toastController.create({message:`\u2705 Archivo de calificaciones sincronizado correctamente
\u{1F4CA} Los cambios ya est\xE1n disponibles en Canvas`,duration:4e3,position:"top",color:"success",cssClass:"toast-success"})).present()}catch(o){console.error("Error sincronizando archivo:",o),yield this.mostrarError("Error","No se pudo sincronizar el archivo de calificaciones")}})}mostrarError(e,o){return f(this,null,function*(){yield(yield this.alertController.create({header:e,message:o,buttons:["OK"]})).present()})}mostrarConfirmacion(e,o){return f(this,null,function*(){return new Promise(t=>f(this,null,function*(){yield(yield this.alertController.create({header:e,message:o,buttons:[{text:"Cancelar",role:"cancel",handler:()=>t(!1)},{text:"Continuar",handler:()=>t(!0)}]})).present()}))})}getGrupoIdActual(){return this.tipoEvaluando==="PI"&&this.estudianteSeleccionado?`${this.cursoActivo}_${this.filtroGrupo}_${this.estudianteSeleccionado}`:`${this.cursoActivo}_${this.filtroGrupo}_${this.grupoSeguimientoActivo||"none"}`}limpiarPanelSeguimiento(){let e=this.seguimientoService.getSeguimiento();e&&(e.evaluacionGrupal=void 0,e.evaluacionIndividual=void 0,e.integranteSeleccionado=void 0,e.entregaActual=void 0,e.tipoEvaluacionActiva=null,e.comentarios=[],this.seguimientoService.setSeguimiento(e),console.log("\u{1F9F9} Panel de seguimiento limpiado (evaluaciones, integrante, entrega, tipo y comentarios)"))}obtenerRubricaIdPorDefecto(e,o){if(o==="PG"&&this.cursoActivo){let s=this.dataService.getUIState().courseStates?.[this.cursoActivo]?.rubricasAsociadas;if(s){let l=null;if(e==="E1"?l=s.entrega1:e==="E2"?l=s.entrega2:e==="EF"&&(l=s.entregaFinal),l){if(this.dataService.getRubrica(l))return console.log(`\u2705[obtenerRubricaIdPorDefecto] Usando r\xFAbrica asociada: ${l} `),l;console.warn(`\u26A0\uFE0F R\xFAbrica asociada ${l} no encontrada en storage`)}}}let t=this.CATEGORIA_RUBRICAS_DEFAULT;console.log("\u{1F3F7}\uFE0F [obtenerRubricaIdPorDefecto] Categor\xEDa por defecto:",t);let i=this.dataService.obtenerIdsRubricas();if(console.log("\u{1F4DA} [obtenerRubricaIdPorDefecto] R\xFAbricas disponibles:",i),o==="PG"){let a=e==="E1"?"entrega-1":e==="E2"?"entrega-2":"final",r=i.filter(l=>l.toLowerCase().includes("grupal")&&l.toLowerCase().includes(a));if(console.log(`\u{1F50D}[obtenerRubricaIdPorDefecto] Buscando r\xFAbrica grupal para ${e}: `,r),r.length===0)return console.error(`\u274C No se encontr\xF3 r\xFAbrica grupal para ${e} `),this.mostrarError("R\xFAbrica Grupal No Encontrada",`No hay ninguna r\xFAbrica grupal para ${e} importada en el sistema.

Por favor, importe la r\xFAbrica correspondiente desde Configuraci\xF3n.`),"";let s=r[0];return console.log("\u2705 [obtenerRubricaIdPorDefecto] Usando r\xFAbrica grupal:",s),s}else{console.log("\u{1F50D} [obtenerRubricaIdPorDefecto] Buscando r\xFAbrica individual...");let a=this.dataService.obtenerIdsRubricas();console.log("\uFFFD [obtenerRubricaIdPorDefecto] R\xFAbricas disponibles:",a);let r=a.filter(l=>l.toLowerCase().includes("individual"));if(console.log("\uFFFD [obtenerRubricaIdPorDefecto] R\xFAbricas individuales encontradas:",r),r.length===0)return console.error("\u274C No se encontr\xF3 ninguna r\xFAbrica individual en el sistema"),this.mostrarError("R\xFAbrica Individual No Encontrada",`No hay ninguna r\xFAbrica individual importada en el sistema.

Por favor, importe una r\xFAbrica individual desde la pesta\xF1a de Configuraci\xF3n.`),"";let s=r[0];return console.log("\u2705 [obtenerRubricaIdPorDefecto] Usando r\xFAbrica individual:",s),s}}obtenerPuntosMaximosRubrica(e,o){if(!this.cursoActivo)return 0;let t=this.obtenerRubricaIdPorDefecto(e,o);if(!t)return 0;let i=this.dataService.getRubrica(t);return!i||!i.criterios?0:i.criterios.reduce((r,s)=>r+(s.peso||s.pesoMaximo||0),0)}obtenerNota(e,o,t){if(!this.cursoActivo)return 0;if(t==="PG"){let r=this.dataService.getEvaluacion(this.cursoActivo,o,t,e.correo);return r?r.puntosTotales||0:this.dataService.getEvaluacion(this.cursoActivo,o,t,e.grupo)?.puntosTotales||0}let i=e.correo;return this.dataService.getEvaluacion(this.cursoActivo,o,t,i)?.puntosTotales||0}obtenerSumatoria(e,o){let t=this.obtenerNota(e,o,"PG"),i=this.obtenerNota(e,o,"PI");return t+i}onCalificacionesChange(e){!this.rubricaActual||!this.rubricaActual.criterios||(this.criteriosEvaluados=this.rubricaActual.criterios.map((o,t)=>{let i=e[o.titulo]||0,a=this.obtenerNivelPorPuntos(o,i);return{criterioTitulo:o.titulo,nivelSeleccionado:a?.titulo||"",puntosObtenidos:i,puntosPersonalizados:!1,comentario:this.comentariosCriterios[t]||""}}),this.puntosRubricaTotales=this.criteriosEvaluados.reduce((o,t)=>o+(t.puntosObtenidos||0),0),console.log("\u{1F504} [onCalificacionesChange] criteriosEvaluados actualizado:",this.criteriosEvaluados.length,"criterios"))}onEvaluacionGuardada(e){return f(this,null,function*(){if(console.log("\u{1F4E5} [onEvaluacionGuardada] Recibiendo datos de evaluaci\xF3n:",e),!this.cursoActivo||!this.entregaEvaluando||!this.tipoEvaluando||!this.rubricaActual){console.error("\u274C [onEvaluacionGuardada] Faltan datos necesarios"),yield this.mostrarError("Error","Faltan datos para guardar la evaluaci\xF3n");return}try{let o=this.rubricaActual.criterios.map((s,l)=>{let p=e.calificaciones[s.titulo]||0,h=this.obtenerNivelPorPuntos(s,p);return{criterioTitulo:s.titulo,nivelSeleccionado:h?.titulo||"",puntosObtenidos:p,puntosPersonalizados:!1,comentario:"",criterioDescripcion:s.descripcion,nivelDescripcion:h?.descripcion||""}}),t,i="",a="";if(this.tipoEvaluando==="PG"){if(!this.grupoSeguimientoActivo){yield this.mostrarError("Error","No hay un grupo seleccionado");return}t=this.grupoSeguimientoActivo,i=this.grupoSeguimientoActivo}else{if(!this.estudianteSeleccionado){yield this.mostrarError("Error","Debe seleccionar un estudiante");return}t=this.estudianteSeleccionado,a=this.estudianteSeleccionado}let r={cursoNombre:this.cursoActivo,entrega:this.entregaEvaluando,tipo:this.tipoEvaluando,grupo:i,estudianteEmail:a,rubricaId:this.rubricaActual.id||"",criterios:o,puntosTotales:e.puntuacionTotal,fechaEvaluacion:new Date,comentarioGeneral:e.observaciones||""};console.log("\u{1F4BE} [onEvaluacionGuardada] Guardando evaluaci\xF3n:",r),yield this.dataService.guardarEvaluacion(r),this.evaluacionActual=r,this.puntosRubricaTotales=e.puntuacionTotal,this.cdr.detectChanges(),console.log("\u2705 [onEvaluacionGuardada] Evaluaci\xF3n guardada exitosamente")}catch(o){console.error("\u274C [onEvaluacionGuardada] Error:",o),yield this.mostrarError("Error","No se pudo guardar la evaluaci\xF3n: "+o.message)}})}obtenerNivelPorPuntos(e,o){return e.nivelesDetalle?e.nivelesDetalle.find(t=>{let i=t.puntos.includes("-")?t.puntos.split("-").map(a=>parseInt(a.trim())):[parseInt(t.puntos),parseInt(t.puntos)];return i.length===2?o>=i[0]&&o<=i[1]:o===i[0]}):null}calcularPuntosTotales(){this.puntosRubricaTotales=this.criteriosEvaluados.reduce((e,o)=>e+(o.puntosObtenidos||0),0)}actualizarComentarioDesdeRubrica(){let e=this.criteriosEvaluados.filter(o=>o.nivelSeleccionado).map(o=>`${o.criterioTitulo}: ${o.comentario} `).join(`
`);e&&(this.nuevoComentario=e)}guardarRubricaGrupo(){return f(this,null,function*(){if(!this.cursoActivo||!this.entregaEvaluando||!this.tipoEvaluando){this.mostrarError("Error","Faltan datos para guardar la evaluaci\xF3n");return}let e,o="",t="";if(this.tipoEvaluando==="PG"){if(!this.grupoSeguimientoActivo){this.mostrarError("Error","No hay un grupo seleccionado");return}let a=this.estudiantesFiltrados.filter(l=>l.grupo===this.grupoSeguimientoActivo),r=this.estudiantesFiltrados.filter(l=>this.estudiantesSeleccionados.has(l.correo)&&l.grupo===this.grupoSeguimientoActivo);if(r.length===0){this.mostrarError("Error","Debe seleccionar al menos un estudiante del grupo");return}e=this.grupoSeguimientoActivo;let s=this.grupoSeguimientoActivo;if(r.length===a.length)yield this.dataService.guardarEvaluacion({cursoNombre:this.cursoActivo,entrega:this.entregaEvaluando,tipo:"PG",grupo:s,estudianteEmail:"",rubricaId:this.rubricaActual?.id||"",criterios:this.criteriosEvaluados,puntosTotales:this.puntosRubricaTotales,fechaEvaluacion:new Date,comentarioGeneral:this.textoSeguimientoRubrica.join(`

`)});else for(let l of r)yield this.dataService.guardarEvaluacion({cursoNombre:this.cursoActivo,entrega:this.entregaEvaluando,tipo:"PG",grupo:s,estudianteEmail:l.correo,rubricaId:this.rubricaActual?.id||"",criterios:[...this.criteriosEvaluados],puntosTotales:this.puntosRubricaTotales,fechaEvaluacion:new Date,comentarioGeneral:this.textoSeguimientoRubrica.join(`

`)})}else if(this.tipoEvaluando==="PI"){if(!this.estudianteSeleccionado){this.mostrarError("Error","Debe seleccionar un estudiante para evaluaciones individuales");return}if(e=this.estudianteSeleccionado,o=this.estudianteSeleccionado,yield this.dataService.guardarEvaluacion({cursoNombre:this.cursoActivo,entrega:this.entregaEvaluando,tipo:this.tipoEvaluando,grupo:t,estudianteEmail:o,rubricaId:this.rubricaActual?.id||"",criterios:this.criteriosEvaluados,puntosTotales:this.puntosRubricaTotales,fechaEvaluacion:new Date,comentarioGeneral:this.textoSeguimientoRubrica.join(`

`)}),this.aplicarAMas&&this.estudiantesSeleccionados.size>1){let a=this.estudiantesFiltrados.filter(r=>this.estudiantesSeleccionados.has(r.correo)&&r.correo!==this.estudianteSeleccionado);for(let r of a)yield this.dataService.guardarEvaluacion({cursoNombre:this.cursoActivo,entrega:this.entregaEvaluando,tipo:"PI",grupo:r.grupo,estudianteEmail:r.correo,rubricaId:this.rubricaActual?.id||"",criterios:[...this.criteriosEvaluados],puntosTotales:this.puntosRubricaTotales,fechaEvaluacion:new Date,comentarioGeneral:this.textoSeguimientoRubrica.join(`

`)});console.log(`\u2705[Aplicar a +] Evaluaci\xF3n aplicada a ${a.length} estudiantes adicionales`),this.aplicarAMas=!1}}else{this.mostrarError("Error","Tipo de evaluaci\xF3n no v\xE1lido");return}this.modoEdicionRubrica=!1;let i=this.tipoEvaluando==="PG"?`R\xFAbrica guardada para ${this.estudiantesSeleccionados.size} estudiante(s) del grupo`:"R\xFAbrica guardada para el estudiante";this.mostrarError("\xC9xito",i),console.log(`\u2705[guardarRubricaGrupo] Evaluaci\xF3n ${this.tipoEvaluando} guardada para ${e} `)})}inicializarCriteriosRubrica(){this.rubricaActual&&(this.criteriosEvaluados=this.rubricaActual.criterios.map(e=>({criterioTitulo:e.titulo,nivelSeleccionado:void 0,puntosObtenidos:0,puntosPersonalizados:!1})),this.calcularPuntosTotales())}cargarEvaluacionExistente(){if(!this.cursoActivo||!this.entregaEvaluando||!this.tipoEvaluando)return;let e=this.tipoEvaluando==="PG"?this.filtroGrupo:this.estudianteSeleccionado;if(!e)return;let o=this.dataService.getEvaluacion(this.cursoActivo,this.entregaEvaluando,this.tipoEvaluando,e);o&&(this.criteriosEvaluados=[...o.criterios],this.calcularPuntosTotales())}actualizarPuntosPersonalizadosRubrica(e,o){this.criteriosEvaluados[e]=Y(M({},this.criteriosEvaluados[e]),{puntosObtenidos:o,puntosPersonalizados:!0,nivelSeleccionado:void 0}),this.calcularPuntosTotales()}guardarEvaluacionRubrica(){if(!this.cursoActivo||!this.entregaEvaluando||!this.tipoEvaluando||!this.rubricaActual){this.mostrarError("Error","Faltan datos para guardar la evaluaci\xF3n");return}let e=this.tipoEvaluando==="PG"?this.filtroGrupo:this.estudianteSeleccionado;if(!e){this.mostrarError("Error","No se ha seleccionado el objetivo de evaluaci\xF3n");return}let o={cursoNombre:this.cursoActivo,entrega:this.entregaEvaluando,tipo:this.tipoEvaluando,rubricaId:this.rubricaActual.id,criterios:[...this.criteriosEvaluados],puntosTotales:this.puntosRubricaTotales,fechaEvaluacion:new Date};this.tipoEvaluando==="PG"?o.grupo=e:o.estudianteEmail=e;try{this.dataService.guardarEvaluacion(o),this.guardarEnCache(),this.emitToSeguimientoPanel(),this.cdr.detectChanges(),this.mostrarMensajeExito("Evaluaci\xF3n guardada correctamente")}catch(t){this.mostrarError("Error","No se pudo guardar la evaluaci\xF3n: "+t.message)}}abrirRubricaEntrega(e,o){return f(this,null,function*(){if(console.log(`\u{1F4CB}[abrirRubricaEntrega] Abriendo r\xFAbrica: ${e} - ${o} `),!this.cursoActivo){yield this.mostrarError("Error","No hay curso activo seleccionado");return}if(o==="PI"&&!this.estudianteSeleccionado){yield this.mostrarError("Atenci\xF3n","Para evaluar con r\xFAbrica individual (PI), primero debe seleccionar un estudiante de la lista.");return}let t=this.cursoActivo,i=this.dataService.obtenerRubricasArray();console.log("\u{1F50D}[abrirRubricaEntrega] Buscando r\xFAbrica para:"),console.log(`   - Curso: ${t}`),console.log(`   - Entrega: ${e}`),console.log(`   - Tipo: ${o}`),console.log(`\u{1F50D}[abrirRubricaEntrega] Total r\xFAbricas disponibles: ${i.length}`),i.forEach((r,s)=>{console.log(`   [${s}] ${r.nombre} | cursosCodigos: ${JSON.stringify(r.cursosCodigos)} | tipoEntrega: ${r.tipoEntrega} | tipoRubrica: ${r.tipoRubrica}`)});let a=i.find(r=>r.cursosCodigos?.includes(t)&&r.tipoEntrega===e&&r.tipoRubrica===o);if(!a){yield this.mostrarError("R\xFAbrica no encontrada",`No hay r\xFAbrica ${o} configurada para ${e} en este curso.`),console.warn(`\u26A0\uFE0F[abrirRubricaEntrega] No se encontr\xF3 r\xFAbrica para ${t} - ${e} - ${o} `);return}console.log(`\u2705[abrirRubricaEntrega] R\xFAbrica encontrada: ${a.nombre} `),this.entregaEvaluando=e,this.tipoEvaluando=o,this.rubricaActual=a,this.mostrarRubrica=!0,console.log("\u2705[abrirRubricaEntrega] Estado actualizado: ",{entrega:this.entregaEvaluando,tipo:this.tipoEvaluando,rubrica:this.rubricaActual?.nombre,mostrarRubrica:this.mostrarRubrica,estudianteSeleccionado:this.estudianteSeleccionado}),yield this.cargarEvaluacionGuardada(),this.actualizarAnotacionesDesdeEstados(),this.cdr.detectChanges(),console.log(`\u2705[abrirRubricaEntrega] R\xFAbrica cargada: ${a.nombre} `),console.log(`\u2705[abrirRubricaEntrega] mostrarRubrica: ${this.mostrarRubrica} `)})}cerrarRubrica(){this.guardarEnCache(),this.mostrarRubrica=!1,this.rubricaActual=null,this.entregaEvaluando=null,this.tipoEvaluando=null,this.criteriosEvaluados=[],this.puntosRubricaTotales=0,this.criterioActualIndex=0,this.textoSeguimientoRubrica=[],this.timestampsSeguimiento=[],this.modoEdicionRubrica=!1,this.limpiarPanelSeguimiento()}obtenerNombreEstudianteSeleccionado(){if(!this.estudianteSeleccionado)return"";let e=this.estudiantesActuales.find(o=>o.correo===this.estudianteSeleccionado);return e?`${e.apellidos}, ${e.nombres} `:this.estudianteSeleccionado}habilitarEdicionRubrica(){this.modoEdicionRubrica=!0}cancelarEdicionRubrica(){this.cargarEvaluacionExistente(),this.modoEdicionRubrica=!1}avanzarCriterio(){this.rubricaActual&&this.criterioActualIndex<this.rubricaActual.criterios.length-1&&this.criterioActualIndex++}retrocederCriterio(){this.criterioActualIndex>0&&this.criterioActualIndex--}get criterioActual(){return!this.rubricaActual||this.criterioActualIndex<0||this.criterioActualIndex>=this.rubricaActual.criterios.length?null:this.rubricaActual.criterios[this.criterioActualIndex]}get nivelesDelCriterioActual(){return this.criterioActual?this.criterioActual.nivelesDetalle||[]:[]}cargarEvaluacionGuardada(){return f(this,null,function*(){let e=this.grupoSeguimientoActivo||(this.filtroGrupo!=="todos"?this.filtroGrupo:null);if(!this.cursoActivo||!this.entregaEvaluando||!e){console.warn("\u26A0\uFE0F [cargarEvaluacionGuardada] Faltan datos necesarios");return}let o;if(this.tipoEvaluando==="PI"){if(o=this.estudianteSeleccionado||"",!o){console.warn("\u26A0\uFE0F [cargarEvaluacionGuardada] PI requiere estudiante seleccionado");return}}else o=e;console.log("\u{1F50D}[cargarEvaluacionGuardada] Buscando evaluaci\xF3n: ",{curso:this.cursoActivo,entrega:this.entregaEvaluando,tipo:this.tipoEvaluando,identificador:o});let t=this.dataService.getEvaluacion(this.cursoActivo,this.entregaEvaluando,this.tipoEvaluando||"PG",o);t?(console.log(`\u{1F4C2}[cargarEvaluacionGuardada] \u2705 Evaluaci\xF3n recuperada para ${this.entregaEvaluando}: `,t),console.log("\u{1F4C2}[cargarEvaluacionGuardada] Criterios:",t.criterios),this.evaluacionActual=JSON.parse(JSON.stringify(t)),this.reconstruirEstadoDesdeEvaluacion(t)):(console.log(`\u{1F195}[cargarEvaluacionGuardada] \u274C Sin evaluaci\xF3n previa para ${this.entregaEvaluando} `),this.evaluacionActual=null,this.reiniciarEstadoEvaluacion()),this.cdr.detectChanges()})}reconstruirEstadoDesdeEvaluacion(e){if(!e||!e.criterios){console.warn("\u26A0\uFE0F [reconstruirEstadoDesdeEvaluacion] Evaluaci\xF3n sin criterios");return}console.log("\u{1F504} [reconstruirEstadoDesdeEvaluacion] Reconstruyendo estado desde evaluaci\xF3n:",e),this.criteriosEvaluados=e.criterios.map((i,a)=>(i.nivelSeleccionado&&(this.nivelesSeleccionados[a]=i.nivelSeleccionado),i.comentario&&(this.comentariosCriterios[a]=i.comentario),i.puntosPersonalizados&&(this.puntosPersonalizados[a]=i.puntosObtenidos||0),{criterioTitulo:i.criterioTitulo,nivelSeleccionado:i.nivelSeleccionado,puntosObtenidos:i.puntosObtenidos||0,puntosPersonalizados:i.puntosPersonalizados||!1,comentario:i.comentario||""})),this.puntosRubricaTotales=e.puntosTotales||0;let o=this.generarTextoSeguimientoFromCriterios(e.criterios);this.tipoEvaluando==="PG"?this.textoSeguimientoRubricaGrupal=o:this.textoSeguimientoRubricaIndividual=o;let t=e.fechaEvaluacion?new Date(e.fechaEvaluacion).toLocaleString("es-ES"):new Date().toLocaleString("es-ES");this.timestampsSeguimiento=e.criterios.map(()=>t),console.log("\u2705 [reconstruirEstadoDesdeEvaluacion] Estado reconstruido:",{criterios:this.criteriosEvaluados.length,puntosTotal:this.puntosRubricaTotales,textoParrafos:o.length}),this.emitToSeguimientoPanel()}generarTextoSeguimientoFromCriterios(e){return e.map(o=>{let t=o.comentario?`
  \u{1F4AC} ${o.comentario} `:"",i=o.nivelSeleccionado||"Sin nivel",a=o.puntosObtenidos||0;return`\u{1F4CC} ${o.criterioTitulo} 
  \u2713 ${i} 
  \u{1F4CA} ${a} puntos${t} `})}reiniciarEstadoEvaluacion(){this.puntosRubricaTotales=0,this.criteriosEvaluados=[],this.nivelesSeleccionados={},this.comentariosCriterios={},this.puntosPersonalizados={},this.criterioActualIndex=0,this.tipoEvaluando==="PG"?this.textoSeguimientoRubricaGrupal=[]:this.textoSeguimientoRubricaIndividual=[],this.timestampsSeguimiento=[],console.log("\u{1F9F9} [reiniciarEstadoEvaluacion] Estado de evaluaci\xF3n reiniciado")}get nivelSeleccionadoActual(){if(!this.criterioActual)return null;let e=this.criteriosEvaluados[this.criterioActualIndex];return!e||!e.nivelSeleccionado?null:this.nivelesDelCriterioActual.find(o=>o.titulo===e.nivelSeleccionado)}get esPrimerCriterio(){return this.criterioActualIndex===0}get esUltimoCriterio(){return this.rubricaActual?this.criterioActualIndex===this.rubricaActual.criterios.length-1:!0}get rubricaEstaGuardada(){return!this.cursoActivo||!this.entregaEvaluando||!this.grupoSeguimientoActivo?!1:!!this.dataService.getEvaluacion(this.cursoActivo,this.entregaEvaluando,"PG",this.grupoSeguimientoActivo)}seleccionarNivelCriterioActual(e){if(!(!this.criterioActual||!e)){if(console.log("\u{1F4DD} [seleccionarNivelCriterioActual] Seleccionando nivel:",e.titulo,"para criterio:",this.criterioActualIndex),this.aplicarATodos&&this.rubricaActual){console.log("\u{1F504} [Aplicar a Todos] Aplicando nivel a todos los criterios"),console.log("\u{1F50D} [Aplicar a Todos] Estado inicial - criteriosEvaluados.length:",this.criteriosEvaluados.length),console.log("\u{1F9F9} [Aplicar a Todos] Limpiando texto de seguimiento previo..."),this.textoSeguimientoRubrica=[],this.textoSeguimientoRubricaGrupal=[],this.textoSeguimientoRubricaIndividual=[],this.timestampsSeguimiento=[],this.puntosPersonalizados={},this.comentariosCriterios={},this.tipoEvaluando&&(this.seguimientoService.actualizarTextoRubrica(this.tipoEvaluando,[],[]),console.log("\u{1F9F9} [Aplicar a Todos] Servicio de seguimiento limpiado"));let o=[];for(let t=0;t<this.rubricaActual.criterios.length;t++){let i=this.rubricaActual.criterios[t],a=i.nivelesDetalle||[],r=this.nivelesDelCriterioActual.findIndex(l=>l.titulo===e.titulo),s=a[r]||a[0];if(s){let l=s.puntosMax||s.puntosMin||0;this.nivelesSeleccionados[t]=s.titulo;let p={criterioTitulo:i.titulo,nivelSeleccionado:s.titulo,puntosObtenidos:l,puntosPersonalizados:!1,comentario:s.descripcion||""};o.push(p);let h=this.criterioActual,y=this.criterioActualIndex;this.criterioActualIndex=t,this.actualizarTextoSeguimiento(s,l,l,void 0),this.criterioActualIndex=y,console.log(`\u2705[Aplicar a Todos] Criterio ${t}: "${i.titulo}" -> Nivel: "${s.titulo}"(${l} pts)`)}else console.warn(`\u26A0\uFE0F[Aplicar a Todos] No se encontr\xF3 nivel equivalente para criterio ${t}: "${i.titulo}"`),this.criteriosEvaluados[t]?o.push(M({},this.criteriosEvaluados[t])):o.push({criterioTitulo:i.titulo,nivelSeleccionado:void 0,puntosObtenidos:0,puntosPersonalizados:!1,comentario:""})}this.criteriosEvaluados=o,console.log("\u2705 [Aplicar a Todos] Array reconstruido - nuevosEvaluados.length:",this.criteriosEvaluados.length),console.log("\u{1F4CA} [Aplicar a Todos] Criterios finales:",this.criteriosEvaluados.map(t=>`${t.criterioTitulo}: ${t.nivelSeleccionado} `)),console.log("\u{1F504} [Aplicar a Todos] Forzando actualizaci\xF3n del panel de seguimiento..."),this.aplicarATodos=!1}else{this.nivelesSeleccionados[this.criterioActualIndex]=e.titulo;let o=e.puntosMax||e.puntosMin||0,t=this.puntosPersonalizados[this.criterioActualIndex]||o,i=this.comentariosCriterios[this.criterioActualIndex];this.actualizarTextoSeguimiento(e,o,t,i),this.criteriosEvaluados[this.criterioActualIndex]={criterioTitulo:this.criterioActual.titulo,nivelSeleccionado:e.titulo,puntosObtenidos:t,puntosPersonalizados:this.puntosPersonalizados[this.criterioActualIndex]!==void 0,comentario:i||""}}this.calcularPuntosTotales(),this.emitToSeguimientoPanel(),this.actualizarTextoEnServicio(),console.log("\u2705 [seleccionarNivelCriterioActual] Nivel guardado. Niveles seleccionados:",this.nivelesSeleccionados),console.log("\u{1F4C4} [seleccionarNivelCriterioActual] Texto de seguimiento actualizado:",this.textoSeguimientoRubrica[this.criterioActualIndex])}}actualizarPuntosPersonalizados(e){if(this.puntosPersonalizados[this.criterioActualIndex]=e,this.criteriosEvaluados[this.criterioActualIndex]){this.criteriosEvaluados[this.criterioActualIndex].puntosObtenidos=e,this.criteriosEvaluados[this.criterioActualIndex].puntosPersonalizados=!0;let o=this.criteriosEvaluados[this.criterioActualIndex];if(this.criterioActual&&o.nivelSeleccionado){let t=this.nivelesDelCriterioActual.find(i=>i.titulo===o.nivelSeleccionado);if(t){let i=t.puntosMax||t.puntosMin||0,a=this.comentariosCriterios[this.criterioActualIndex];this.actualizarTextoSeguimiento(t,i,e,a)}}this.calcularPuntosTotales()}}actualizarComentarioCriterio(e){if(this.comentariosCriterios[this.criterioActualIndex]=e,this.criteriosEvaluados[this.criterioActualIndex]){this.criteriosEvaluados[this.criterioActualIndex].comentario=e;let o=this.criteriosEvaluados[this.criterioActualIndex];if(this.criterioActual&&o.nivelSeleccionado){let t=this.nivelesDelCriterioActual.find(i=>i.titulo===o.nivelSeleccionado);if(t){let i=t.puntosMax||t.puntosMin||0,a=this.puntosPersonalizados[this.criterioActualIndex]||i;this.actualizarTextoSeguimiento(t,i,a,e)}}}}limpiarCacheCalificaciones(){this.cacheCalificacionesCanvas.clear(),this._calificacionesCargadasPorCurso.clear()}precargarCalificacionesCurso(){return f(this,null,function*(){this.cursoActivo&&this._calificacionesCargadasPorCurso.set(this.cursoActivo,!0)})}agregarComentarioFrecuente(e){e&&!this.comentariosFrecuentes.includes(e)&&(this.comentariosFrecuentes.push(e),localStorage.setItem("comentariosFrecuentes",JSON.stringify(this.comentariosFrecuentes)))}cargarComentariosFrecuentes(){let e=localStorage.getItem("comentariosFrecuentes");e&&(this.comentariosFrecuentes=JSON.parse(e))}cancelarEvaluacionRubrica(){this.mostrarRubrica=!1,this.rubricaActual=null,this.entregaEvaluando=null,this.tipoEvaluando=null,this.criteriosEvaluados=[],this.puntosRubricaTotales=0,this.criterioActualIndex=0,this.timestampsSeguimiento=[],this.puntosPersonalizados={},this.comentariosCriterios={},this.nivelesSeleccionados={},this.limpiarPanelSeguimiento()}borrarEvaluacionRubrica(){return f(this,null,function*(){if(!this.cursoActivo||!this.entregaEvaluando||!this.tipoEvaluando)return;let e=this.tipoEvaluando==="PG";if(!(e?this.grupoSeguimientoActivo:this.estudianteSeleccionado))return;let t=e?"grupal (PG)":"individual (PI)",i=e?`\xBFEst\xE1s seguro de que deseas eliminar la evaluaci\xF3n ${t} de este grupo ? Esta acci\xF3n no se puede deshacer.`:`\xBFEst\xE1s seguro de que deseas eliminar la evaluaci\xF3n ${t} de este estudiante ? Esta acci\xF3n no se puede deshacer.`;yield(yield this.alertController.create({header:"Confirmar borrado",message:i,buttons:[{text:"Cancelar",role:"cancel"},{text:"Borrar",role:"destructive",handler:()=>f(this,null,function*(){e?yield this.dataService.borrarEvaluacion(this.cursoActivo,this.entregaEvaluando,"PG",this.grupoSeguimientoActivo):yield this.dataService.borrarEvaluacion(this.cursoActivo,this.entregaEvaluando,"PI",this.estudianteSeleccionado),this.criteriosEvaluados=[],this.puntosRubricaTotales=0,this.criterioActualIndex=0,this.textoSeguimientoRubrica=[],this.timestampsSeguimiento=[],this.puntosPersonalizados={},this.comentariosCriterios={},this.nivelesSeleccionados={},this.limpiarPanelSeguimiento(),this.inicializarCriteriosRubrica(),this.modoEdicionRubrica=!1,console.log("\u{1F504} Recargando datos despu\xE9s del borrado de evaluaci\xF3n..."),this.cursoActivo&&(yield this.seleccionarCurso(this.cursoActivo));let r=e?`Evaluaci\xF3n ${t} del grupo eliminada correctamente`:`Evaluaci\xF3n ${t} del estudiante eliminada correctamente`;this.mostrarError("\xC9xito",r)})}]})).present()})}get textoSeguimientoCompleto(){return this.textoSeguimientoRubrica.filter(e=>e).join(`

`)}copiarTextoSeguimiento(){return f(this,null,function*(){let e=this.generarTextoSeguimientoCompleto();if(!e){yield this.mostrarError("Aviso","No hay evaluaciones para copiar");return}try{if(navigator.clipboard&&navigator.clipboard.writeText)yield navigator.clipboard.writeText(e),yield this.mostrarMensajeExito("Texto de seguimiento completo copiado al portapapeles");else{let o=document.createElement("textarea");o.value=e,o.style.position="fixed",o.style.opacity="0",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),yield this.mostrarMensajeExito("Texto de seguimiento completo copiado al portapapeles")}}catch(o){console.error("Error al copiar texto:",o),yield this.mostrarError("Error","No se pudo copiar el texto al portapapeles")}})}generarTextoSeguimientoCompleto(){if(!this.cursoActivo||!this.entregaEvaluando)return"";let e=this.obtenerEstudianteSeleccionado();if(!e)return"";let o=this.obtenerEvaluacionPG(e),t=this.obtenerEvaluacionPI(e);if(!o&&!t)return"";let i="",a=new Date().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});i+=`EVALUACI\xD3N COMPLETA - ${this.entregaEvaluando} 
`,i+=`Estudiante: ${e.nombres} ${e.apellidos} 
`,i+=`Grupo: ${e.grupo} 
`,i+=`Fecha: ${a} 

`;let r=o?.puntosTotales||0,s=t?.puntosTotales||0,l=r+s;return i+=`RESUMEN DE PUNTUACI\xD3N: 
`,i+=`Puntos Grupales: PG = ${r} 
`,i+=`Puntos Individuales: PI = ${s} 
`,i+=`Total: PG + PI = ${l} 

`,o&&(i+=`DETALLE PUNTOS GRUPALES(PG) 
`,i+=`========================================

`,i+=this.generarDetalleCriterios(o,"Grupal"),i+=`
`),t&&(i+=`DETALLE PUNTOS INDIVIDUALES(PI) 
`,i+=`=========================================

`,i+=this.generarDetalleCriterios(t,"Individual")),i}generarDetalleCriterios(e,o){if(!e.criterios||e.criterios.length===0)return`No hay criterios evaluados para la r\xFAbrica ${o.toLowerCase()}.

`;let t="";return e.criterios.forEach((i,a)=>{let r=a+1;t+=`Criterio ${r}: ${i.criterioTitulo} 
`,i.nivelSeleccionado&&(t+=`Nivel Obtenido: ${i.nivelSeleccionado} 
`),t+=`Puntos Asignados: ${i.puntosObtenidos||0} `,i.comentario&&i.comentario.trim()&&(t+=` (${i.comentario.trim()})`),t+=`
`,i.nivelDescripcion?t+=`Descripci\xF3n: ${i.nivelDescripcion} 
`:i.criterioDescripcion&&(t+=`Descripci\xF3n: ${i.criterioDescripcion} 
`),t+=`
`}),t}obtenerEvaluacionPG(e){if(!this.cursoActivo||!this.entregaEvaluando)return null;let o=this.dataService.getEvaluacion(this.cursoActivo,this.entregaEvaluando,"PG",e.correo);return o||this.dataService.getEvaluacion(this.cursoActivo,this.entregaEvaluando,"PG",e.grupo)}obtenerEvaluacionPI(e){return!this.cursoActivo||!this.entregaEvaluando?null:this.dataService.getEvaluacion(this.cursoActivo,this.entregaEvaluando,"PI",e.correo)}mostrarMensajeExito(e){return f(this,null,function*(){yield(yield this.alertController.create({header:"\xC9xito",message:e,buttons:["OK"]})).present()})}obtenerNombreCompleto(e){let o=this.estudiantesActuales.find(t=>t.correo===e);return o?`${o.nombres} ${o.apellidos} `:e}inicializarGestoRedimensionar(e){this.gestureCtrl.create({el:e,gestureName:"resize-panel",onStart:()=>{this.redimensionandoPanel=!0},onMove:t=>{if(!this.redimensionandoPanel)return;let i=window.innerWidth-t.currentX;i>=this.anchoMinimo&&i<=this.anchoMaximo&&(this.anchoPanel=i,this.actualizarAnchoPanel(i))},onEnd:()=>{this.redimensionandoPanel=!1}}).enable()}actualizarAnchoPanel(e){this.anchoPanel=e}extraerNumeroGrupo(e){let o=e.match(/G(\d+)/i);return o?o[1]:e}obtenerEstudianteSeleccionado(){return this.estudianteSeleccionado&&this.estudiantesActuales.find(e=>e.correo===this.estudianteSeleccionado)||null}limpiarRubricaParaNuevoEstudiante(){console.log("\u{1F9F9} [limpiarRubricaParaNuevoEstudiante] Limpiando r\xFAbrica para nuevo estudiante"),this.nivelesSeleccionados={},this.puntosPersonalizados={},this.comentariosCriterios={},this.criteriosEvaluados=[],this.puntosRubricaTotales=0,this.tipoEvaluando==="PI"&&(this.textoSeguimientoRubricaIndividual=[]),this.modoEdicionRubrica=!1,console.log("\u2705 [limpiarRubricaParaNuevoEstudiante] R\xFAbrica limpiada correctamente")}limpiarRubricaParaNuevoSubgrupo(){console.log("\u{1F9F9} [limpiarRubricaParaNuevoSubgrupo] Limpiando r\xFAbrica por cambio de subgrupo"),this.nivelesSeleccionados={},this.puntosPersonalizados={},this.comentariosCriterios={},this.criteriosEvaluados=[],this.puntosRubricaTotales=0,this.textoSeguimientoRubricaGrupal=[],this.textoSeguimientoRubricaIndividual=[],this.modoEdicionRubrica=!1,this.estudiantesSeleccionados.clear(),this.estudianteSeleccionado=null,this.rubricaActual&&(this.inicializarCriteriosRubrica(),console.log("\u{1F504} [limpiarRubricaParaNuevoSubgrupo] Criterios reinicializados para r\xFAbrica en blanco")),console.log("\u2705 [limpiarRubricaParaNuevoSubgrupo] R\xFAbrica limpiada para nuevo subgrupo")}getCursoMetadata(){return this.cursoActivo&&this.dataService.getUIState().courseStates?.[this.cursoActivo]?.metadata||null}getCursoMetadataForCourse(e){return this.dataService.getUIState().courseStates?.[e]?.metadata||null}getNumeroGrupo(e){let o=e.match(/G(\d+)/i);return o?o[1]:e}seleccionarGrupoSeguimiento(e){if(!(this.grupoSeguimientoActivo!==e)){console.log("\u26A1 [seleccionarGrupoSeguimiento] Grupo ya seleccionado, evitando recarga:",e);return}if(this.grupoSeguimientoActivo=e,this.filtroGrupo=e||"todos",!this.actualizandoGrupoDesdeSuscripcion){let i=e?parseInt(e.replace(/\D/g,"")):0;this.seguimientoService.setGrupoSeleccionado(i)}this.mostrarRubrica&&(console.log("\u{1F9F9} [seleccionarGrupoSeguimiento] Limpiando r\xFAbrica por cambio de grupo"),this.limpiarRubricaParaNuevoSubgrupo()),this.aplicarFiltros(),this.cursoActivo&&this.dataService.updateCourseState(this.cursoActivo,{filtroGrupo:e||"todos"}),this.dataService.updateUIState({grupoSeguimientoActivo:e}),this.cargarComentariosGrupo(),this.cdr.detectChanges()}toggleMostrarNombreCorto(){this.mostrarNombreCorto=!this.mostrarNombreCorto,this.dataService.updateUIState({mostrarNombreCorto:this.mostrarNombreCorto}),console.log("\u{1F524} [InicioPage] Mostrar nombre corto:",this.mostrarNombreCorto?"Activado":"Desactivado")}cargarComentariosGrupo(){if(!this.cursoActivo||!this.grupoSeguimientoActivo){this.comentariosGrupoActual=[];return}this.comentariosGrupoActual=this.dataService.getComentariosGrupo(this.cursoActivo,this.grupoSeguimientoActivo),console.log("\u{1F4AC} [InicioPage] Comentarios cargados:",this.comentariosGrupoActual.length)}agregarComentario(){return f(this,null,function*(){!this.nuevoComentario?.trim()||!this.cursoActivo||!this.grupoSeguimientoActivo||(yield this.dataService.addComentarioGrupo(this.cursoActivo,this.grupoSeguimientoActivo,this.nuevoComentario.trim()),this.nuevoComentario="",this.cargarComentariosGrupo(),console.log("\u2705 [InicioPage] Comentario agregado exitosamente"))})}eliminarComentario(e){return f(this,null,function*(){if(!this.cursoActivo||!this.grupoSeguimientoActivo)return;yield(yield this.alertController.create({header:"Confirmar eliminaci\xF3n",message:"\xBFEst\xE1 seguro de eliminar este comentario?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"destructive",handler:()=>f(this,null,function*(){yield this.dataService.deleteComentarioGrupo(this.cursoActivo,this.grupoSeguimientoActivo,e),this.cargarComentariosGrupo(),console.log("\u{1F5D1}\uFE0F [InicioPage] Comentario eliminado"),yield(yield this.toastController.create({message:"Comentario eliminado",duration:2e3,color:"success",position:"top",cssClass:"toast-success"})).present()})}]})).present()})}iniciarEdicionComentario(e,o){this.comentarioEditando=e,this.textoEditando=o,console.log("\u270F\uFE0F [InicioPage] Iniciando edici\xF3n de comentario:",e)}cancelarEdicionComentario(){this.comentarioEditando=null,this.textoEditando="",console.log("\u274C [InicioPage] Edici\xF3n cancelada")}guardarEdicionComentario(e){return f(this,null,function*(){if(!this.cursoActivo||!this.grupoSeguimientoActivo||!this.textoEditando.trim())return;yield this.dataService.updateComentarioGrupo(this.cursoActivo,this.grupoSeguimientoActivo,e,this.textoEditando.trim()),this.comentarioEditando=null,this.textoEditando="",this.cargarComentariosGrupo(),console.log("\u2705 [InicioPage] Comentario actualizado exitosamente"),yield(yield this.toastController.create({message:"Comentario actualizado",duration:2e3,color:"success",position:"top",cssClass:"toast-success"})).present()})}formatearFecha(e){let o=typeof e=="string"?new Date(e):e,i=new Date().getTime()-o.getTime(),a=Math.floor(i/6e4);if(a<1)return"Ahora";if(a<60)return`Hace ${a} min`;let r=Math.floor(a/60);if(r<24)return`Hace ${r} h`;let s=Math.floor(r/24);if(s<7)return`Hace ${s} d`;let l={day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"};return o.toLocaleDateString("es-ES",l)}toggleMenuFab(){this.menuFabAbierto=!this.menuFabAbierto}cerrarMenuFab(){this.menuFabAbierto=!1}get grupoAnteriorDisponible(){return!this.grupoSeguimientoActivo||this.gruposDisponibles.length===0?!1:this.gruposDisponibles.indexOf(this.grupoSeguimientoActivo)>0}get grupoSiguienteDisponible(){return!this.grupoSeguimientoActivo||this.gruposDisponibles.length===0?!1:this.gruposDisponibles.indexOf(this.grupoSeguimientoActivo)<this.gruposDisponibles.length-1}retrocederGrupo(){if(!this.grupoAnteriorDisponible)return;let e=this.gruposDisponibles.indexOf(this.grupoSeguimientoActivo),o=this.gruposDisponibles[e-1];this.grupoSeguimientoActivo=o,this.filtroGrupo=o,console.log("\u2B05\uFE0F [retrocederGrupo] filtroGrupo actualizado a:",this.filtroGrupo);let t=parseInt(o.replace(/\D/g,""));this.seguimientoService.setGrupoSeleccionado(t),this.cargarComentariosGrupo(),this.mostrarRubrica&&this.entregaEvaluando&&this.tipoEvaluando?this.cargarEvaluacionGuardada().then(()=>{this.emitToSeguimientoPanel(),this.cdr.markForCheck()}):(this.evaluacionActual=null,this.reiniciarEstadoEvaluacion(),this.limpiarPanelSeguimiento(),this.cdr.markForCheck())}avanzarGrupo(){if(!this.grupoSiguienteDisponible)return;let e=this.gruposDisponibles.indexOf(this.grupoSeguimientoActivo),o=this.gruposDisponibles[e+1];this.grupoSeguimientoActivo=o,this.filtroGrupo=o;let t=parseInt(o.replace(/\D/g,""));this.seguimientoService.setGrupoSeleccionado(t),this.cargarComentariosGrupo(),this.mostrarRubrica&&this.entregaEvaluando&&this.tipoEvaluando?this.cargarEvaluacionGuardada().then(()=>{this.emitToSeguimientoPanel(),this.cdr.markForCheck()}):(this.evaluacionActual=null,this.reiniciarEstadoEvaluacion(),this.limpiarPanelSeguimiento(),this.cdr.markForCheck()),console.log("\u27A1\uFE0F [InicioPage] Navegado a grupo siguiente:",o)}inicializarSeguimientoGrupo(){if(!this.cursoActivo||!this.filtroGrupo)return;let e=this.getCacheKey(),o=e?this.evaluacionesCache.get(e):void 0,t={curso:this.cursoActivo,grupo:this.filtroGrupo,comentarios:[],evaluacionGrupal:o?.grupal,evaluacionIndividual:o?.individual,textoRubricaGrupal:[],textoRubricaIndividual:[],timestampsGrupal:[],timestampsIndividual:[]};this.seguimientoService.setSeguimiento(t);let i=parseInt(this.filtroGrupo.replace(/\D/g,""));this.seguimientoService.setGrupoSeleccionado(i),console.log("\u{1F3AF} Seguimiento inicializado:",this.cursoActivo,this.filtroGrupo,o?"con cache":"sin cache")}getCacheKey(){return!this.cursoActivo||!this.filtroGrupo||!this.entregaEvaluando?"":`${this.cursoActivo}_${this.filtroGrupo}_${this.entregaEvaluando} `}guardarEnCache(){let e=this.getCacheKey();if(!e||!this.tipoEvaluando)return;let o=this.evaluacionesCache.get(e)||{timestamp:Date.now()};this.tipoEvaluando==="PG"?o.grupal=this.buildEvaluacionRubrica():o.individual=this.buildEvaluacionRubrica(),o.timestamp=Date.now(),this.evaluacionesCache.set(e,o)}restaurarDesdeCache(){let e=this.getCacheKey();if(!e||!this.tipoEvaluando)return!1;let o=this.evaluacionesCache.get(e);if(!o)return!1;let t=Date.now();if(o.timestamp&&t-o.timestamp>this.CACHE_TTL)return this.evaluacionesCache.delete(e),!1;let i=this.tipoEvaluando==="PG"?o.grupal:o.individual;return i?(this.criteriosEvaluados=i.criterios.map((a,r)=>(this.nivelesSeleccionados[r]=a.nivelSeleccionado,this.comentariosCriterios[r]=a.comentario||"",{criterioTitulo:a.nombreCriterio,nivelSeleccionado:a.nivelSeleccionado,puntosObtenidos:a.puntosAsignados,comentario:a.comentario||""})),this.puntosRubricaTotales=i.puntosTotal,this.tipoEvaluando==="PG"?this.textoSeguimientoRubricaGrupal=this.generarTextoSeguimiento(i.criterios):this.textoSeguimientoRubricaIndividual=this.generarTextoSeguimiento(i.criterios),console.log("\u{1F4C2} Evaluaci\xF3n restaurada desde cache:",e,this.tipoEvaluando),!0):!1}generarTextoSeguimiento(e){return e.map(o=>{let t=o.comentario?`
  \u{1F4AC} ${o.comentario} `:"";return`\u{1F4CC} ${o.nombreCriterio} 
  \u2713 ${o.nivelSeleccionado} 
  \u{1F4CA} ${o.puntosAsignados} puntos${t} `})}buildEvaluacionRubrica(){if(!this.rubricaActual||!this.tipoEvaluando)return null;console.log("\u{1F527} [buildEvaluacionRubrica] Criterios totales:",this.criteriosEvaluados.length);let e=this.criteriosEvaluados.filter((t,i)=>{let a=t.nivelSeleccionado&&t.nivelSeleccionado.trim()!=="",r=t.criterioTitulo&&t.criterioTitulo.trim()!=="";return console.log(`\u{1F50D} Criterio ${i}: "${t.criterioTitulo}" - Nivel: "${t.nivelSeleccionado}" - V\xE1lido: ${a&&r} `),a&&r});if(console.log("\u2705 [buildEvaluacionRubrica] Criterios evaluados v\xE1lidos:",e.length),e.length===0)return null;let o=e.map((t,i)=>{let a=this.criteriosEvaluados.findIndex(s=>s.criterioTitulo===t.criterioTitulo&&s===t);if(a===-1)return console.warn("\u26A0\uFE0F No se encontr\xF3 \xEDndice original para criterio:",t.criterioTitulo),null;let r=this.rubricaActual.criterios[a];return r?(console.log(`\u2705 Mapeando criterio ${i}: "${t.criterioTitulo}"(\xEDndice original: ${a})`),{nombreCriterio:t.criterioTitulo,niveles:r.nivelesDetalle.map(s=>({nombre:s.titulo,intervalo:s.puntos||`${s.puntosMin||0} -${s.puntosMax||0} `,color:s.color||"#6c757d",descripcion:s.descripcion||""})),nivelSeleccionado:t.nivelSeleccionado,puntosAsignados:t.puntosObtenidos,comentario:t.comentario}):(console.warn("\u26A0\uFE0F No se encontr\xF3 criterioRubrica para \xEDndice:",a),null)}).filter(Boolean);return console.log("\u{1F4CA} [buildEvaluacionRubrica] Criterios finales para panel:",o.length),{tipo:this.tipoEvaluando,puntosTotal:this.puntosRubricaTotales,criterios:o,timestamp:new Date().toISOString()}}emitToSeguimientoPanel(){let e=this.buildEvaluacionRubrica();if(!this.filtroGrupo){console.log("\u26A0\uFE0F No se puede emitir al panel: sin filtroGrupo");return}this.seguimientoService.getSeguimiento()||(console.log("\u{1F504} Reinicializando seguimiento..."),this.inicializarSeguimientoGrupo());let t=parseInt(this.filtroGrupo.replace(/\D/g,""));if(this.seguimientoService.setGrupoSeleccionado(t),this.seguimientoService.actualizarEntregaActual(this.entregaEvaluando),this.seguimientoService.actualizarTipoEvaluacionActiva(this.tipoEvaluando),e){if(this.seguimientoService.actualizarEvaluacionRubrica(this.tipoEvaluando,e),this.tipoEvaluando==="PI"&&this.estudianteSeleccionado){let i=this.estudiantesFiltrados.find(a=>a.correo===this.estudianteSeleccionado);i&&this.seguimientoService.actualizarIntegranteSeleccionado({correo:i.correo,nombres:i.nombres,apellidos:i.apellidos})}else this.tipoEvaluando==="PG"&&this.seguimientoService.actualizarIntegranteSeleccionado(null);console.log("\u{1F4CA} Panel actualizado:",{tipo:this.tipoEvaluando,grupo:t,criterios:e.criterios.length,puntos:e.puntosTotal})}else{let i=this.seguimientoService.getSeguimiento();i&&(this.tipoEvaluando==="PG"?i.evaluacionGrupal=void 0:this.tipoEvaluando==="PI"&&(i.evaluacionIndividual=void 0),this.seguimientoService.setSeguimiento(i)),console.log("\u{1F9F9} Panel limpiado para tipo:",this.tipoEvaluando)}}actualizarTextoEnServicio(){if(!this.tipoEvaluando)return;let e=this.tipoEvaluando==="PG"?this.textoSeguimientoRubricaGrupal:this.textoSeguimientoRubricaIndividual,o=this.timestampsSeguimiento;this.seguimientoService.actualizarTextoRubrica(this.tipoEvaluando,e,o),console.log("\u{1F4DD} Texto actualizado en servicio:",{tipo:this.tipoEvaluando,parrafos:e.length,ultimoTexto:e[e.length-1]})}obtenerIntegrantesGrupo(){return this.estudiantesFiltrados}seleccionarEstudiante(e){return f(this,null,function*(){if(console.log("\u{1F4E7} Estudiante seleccionado:",e),this.modoSeleccionEstado&&this.filtroGrupo!=="todos"&&this.entregaEvaluando){this.toggleEstadoEstudiante(e,this.modoSeleccionEstado);return}this.estudianteSeleccionado=e;let o=this.estudiantesFiltrados.find(t=>t.correo===e);o&&(yield(yield this.toastController.create({message:`\u{1F4E7} ${o.nombres} ${o.apellidos}: ${e} `,duration:3e3,position:"bottom",color:"primary",buttons:[{text:"Cerrar",role:"cancel"}]})).present()),this.cdr.detectChanges()})}toggleModoSeleccionEstado(e){this.modoSeleccionEstado===e?this.modoSeleccionEstado=null:this.modoSeleccionEstado=e,this.cdr.detectChanges()}toggleEstadoEstudiante(e,o){if(this.filtroGrupo==="todos"||!this.entregaEvaluando)return;let i=this.seguimientoService.getEstadoEstudiante(this.filtroGrupo,this.entregaEvaluando,e)===o?null:o;this.seguimientoService.setEstadoEstudiante(this.filtroGrupo,this.entregaEvaluando,e,i),this.actualizarAnotacionesDesdeEstados(),this.cdr.detectChanges()}tieneEstado(e,o){return this.filtroGrupo==="todos"||!this.entregaEvaluando?!1:this.seguimientoService.getEstadoEstudiante(this.filtroGrupo,this.entregaEvaluando,e)===o}getEstadoEstudiante(e){return this.filtroGrupo==="todos"||!this.entregaEvaluando?null:this.seguimientoService.getEstadoEstudiante(this.filtroGrupo,this.entregaEvaluando,e)}actualizarAnotacionesDesdeEstados(){if(this.filtroGrupo==="todos"||!this.entregaEvaluando){this.anotacionesGrupo="";return}let e=this.seguimientoService.getEstadosGrupoEntrega(this.filtroGrupo,this.entregaEvaluando),o=[];e.ok.forEach(t=>{let i=this.estudiantesFiltrados.find(a=>a.correo===t);i&&o.push(`\u2705 ${i.nombres} ${i.apellidos}`)}),e.solos.forEach(t=>{let i=this.estudiantesFiltrados.find(a=>a.correo===t);i&&o.push(`\u{1F500} ${i.nombres} ${i.apellidos}`)}),e.ausentes.forEach(t=>{let i=this.estudiantesFiltrados.find(a=>a.correo===t);i&&o.push(`\u274C ${i.nombres} ${i.apellidos}`)}),this.anotacionesGrupo=o.join(`
`)}limpiarEstadosGrupo(){this.filtroGrupo==="todos"||!this.entregaEvaluando||(this.seguimientoService.limpiarEstadosGrupoEntrega(this.filtroGrupo,this.entregaEvaluando),this.anotacionesGrupo="",this.modoSeleccionEstado=null,this.cdr.detectChanges())}obtenerColorCalificacion(e){return e>=4?"success":e>=3?"warning":"danger"}obtenerCalificacionPanel(e,o){if(!this.cursoActivo)return console.warn("\u26A0\uFE0F [obtenerCalificacionPanel] No hay curso activo"),0;let t=this.dataService.getEvaluacion(this.cursoActivo,o,"PG",e.grupo)?.puntosTotales||0,i=this.dataService.getEvaluacion(this.cursoActivo,o,"PI",e.correo)?.puntosTotales||0,a=t+i;return a>0&&console.log(`\u{1F4CA}[obtenerCalificacionPanel] ${e.apellidos}: ${o} = PG(${t}) + PI(${i}) = ${a} `),a}obtenerTotalCalificaciones(e){let o=this.obtenerCalificacionPanel(e,"E1"),t=this.obtenerCalificacionPanel(e,"E2"),i=this.obtenerCalificacionPanel(e,"EF");return o+t+i}actualizarTextoSeguimiento(e,o,t,i){this.actualizarTextoEnServicio()}onDragStart(e,o){if(!e.dataTransfer)return;this.elementoArrastrado=o,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",o),e.target.classList.add("dragging");let i=document.querySelector(".course-segment");i&&i.classList.add("drag-active"),console.log("\u{1F3AF} [DragDrop] Iniciando drag de curso:",o)}onDragOver(e,o){e.preventDefault(),e.dataTransfer.dropEffect="move",this.indiceDragDestino=this.cursosOrdenados.indexOf(o),e.currentTarget.classList.add("drag-over")}onDragLeave(e){e.currentTarget.classList.remove("drag-over")}onDrop(e,o){if(e.preventDefault(),!this.elementoArrastrado||this.elementoArrastrado===o){this.limpiarEstadoDrag();return}let t=this.cursosOrdenados.indexOf(this.elementoArrastrado),i=this.cursosOrdenados.indexOf(o);if(t!==-1&&i!==-1){let a=[...this.cursosOrdenados],r=a.splice(t,1)[0];a.splice(i,0,r),this.cursosOrdenados=a,this.guardarOrdenCursos(),console.log("\u{1F3AF} [DragDrop] Curso reordenado:",this.elementoArrastrado,"movido a posici\xF3n de:",o),console.log("\u{1F4CB} [DragDrop] Nuevo orden:",this.cursosOrdenados)}this.limpiarEstadoDrag()}onDragEnd(e){this.limpiarEstadoDrag()}limpiarEstadoDrag(){this.elementoArrastrado=null,this.indiceDragDestino=-1,document.querySelectorAll(".dragging, .drag-over").forEach(o=>{o.classList.remove("dragging","drag-over")});let e=document.querySelector(".course-segment");e&&e.classList.remove("drag-active")}guardarOrdenCursos(){try{localStorage.setItem("cursosOrden",JSON.stringify(this.cursosOrdenados))}catch(e){console.error("Error al guardar orden de cursos:",e)}}cargarOrdenCursos(){try{let e=localStorage.getItem("cursosOrden");e&&(this.cursosOrdenados=JSON.parse(e))}catch(e){console.error("Error al cargar orden de cursos:",e),this.cursosOrdenados=[]}}trackByCurso(e,o){return o}abrirMenuColor(e,o){return f(this,null,function*(){e.stopPropagation(),this.cursoParaCambiarColor=o;let t=this.getCourseColor(o);this.colorSeleccionado=t,this.colorPopoverEvent=e,this.menuColorVisible=!0,console.log("\u{1F3A8} [abrirMenuColor] Color cargado:",t,"para curso:",o)})}cerrarMenuColor(){return f(this,null,function*(){this.menuColorVisible=!1,this.cursoParaCambiarColor=null,this.colorSeleccionado=null,this.colorPopoverEvent=null})}getCourseColor(e){return e&&this.dataService.getUIState().courseStates[e]?.color||"#ff2719"}cambiarColorCurso(e){this.colorSeleccionado=e}validarColorHex(e){let o=e.target.value;o&&!o.startsWith("#")&&(o="#"+o),o=o.replace(/[^#0-9a-fA-F]/g,""),o.length>7&&(o=o.substring(0,7)),this.colorSeleccionado=o.toUpperCase()}aplicarColorCurso(){if(!this.cursoParaCambiarColor||!this.colorSeleccionado){this.cerrarMenuColor();return}/^#[0-9A-F]{6}$/i.test(this.colorSeleccionado)||(this.colorSeleccionado="#a6ce38"),this.dataService.updateCourseState(this.cursoParaCambiarColor,{color:this.colorSeleccionado}),this.cerrarMenuColor()}importarCSVSumatorias(){return f(this,null,function*(){if(!this.cursoActivo){yield this.mostrarError("Error","No hay curso activo seleccionado");return}if(!this.tieneArchivoCanvas()){yield this.mostrarError("Sin archivo Canvas","No hay archivo de calificaciones Canvas asociado a este curso. Vaya a Configuraci\xF3n para cargar uno.");return}let e=document.createElement("input");e.type="file",e.accept=".csv",e.onchange=o=>f(this,null,function*(){let t=o.target.files[0];if(!t)return;let i=yield this.loadingController.create({message:"Procesando CSV de sumatorias...",spinner:"crescent"});yield i.present();try{let a=yield this.leerArchivoTexto(t);yield this.procesarCSVSumatorias(a),yield i.dismiss(),yield(yield this.toastController.create({message:"\u2705 CSV de sumatorias importado y sincronizado con Canvas",duration:4e3,position:"top",color:"success",cssClass:"toast-success"})).present()}catch(a){yield i.dismiss(),console.error("Error importando CSV:",a),yield this.mostrarError("Error","Error al procesar el archivo CSV: "+a.message)}}),e.click()})}leerArchivoTexto(e){return new Promise((o,t)=>{let i=new FileReader;i.onload=a=>o(a.target?.result),i.onerror=a=>t(new Error("Error leyendo archivo")),i.readAsText(e,"UTF-8")})}procesarCSVSumatorias(e){return f(this,null,function*(){let o=e.split(`
`).filter(h=>h.trim());if(o.length<2)throw new Error("El archivo CSV est\xE1 vac\xEDo o no tiene datos");let t=o[0].split(",").map(h=>h.trim().replace(/"/g,"")),i=t.findIndex(h=>h.toLowerCase()==="correo"),a=t.findIndex(h=>h.toLowerCase()==="e1"),r=t.findIndex(h=>h.toLowerCase()==="e2"),s=t.findIndex(h=>h.toLowerCase()==="ef");if(i===-1)throw new Error('El CSV debe tener una columna "Correo"');if(a===-1&&r===-1&&s===-1)throw new Error("El CSV debe tener al menos una columna de entregas (E1, E2, EF)");console.log("\u{1F4CA} Procesando CSV sumatorias:",{totalLineas:o.length-1,columnas:{correo:i,E1:a,E2:r,EF:s}});let l=0,p=0;for(let h=1;h<o.length;h++){let y=o[h].split(",").map(I=>I.trim().replace(/"/g,""));if(y.length<=i)continue;let $=y[i],H=this.estudiantesActuales.find(I=>I.correo.toLowerCase()===$.toLowerCase());if(!H){console.warn(`\u{1F464} Estudiante no encontrado: ${$} `),p++;continue}let Uo=[{entrega:"E1",indice:a},{entrega:"E2",indice:r},{entrega:"EF",indice:s}];for(let{entrega:I,indice:F}of Uo){if(F===-1||F>=y.length)continue;let K=parseFloat(y[F]);isNaN(K)||(yield this.actualizarSumatoriaEstudiante(H,I,K),l++)}}console.log("\u2705 CSV procesado:",{actualizados:l,noEncontrados:p,total:o.length-1}),yield this.dataService.sincronizarArchivoCalificaciones(this.cursoActivo)})}actualizarSumatoriaEstudiante(e,o,t){return f(this,null,function*(){let i=this.dataService.getEvaluacion(this.cursoActivo,o,"PG",e.grupo),a=this.dataService.getEvaluacion(this.cursoActivo,o,"PI",e.correo),r=i?.puntosTotales||0,s=a?.puntosTotales||0;if(Math.abs(r+s-t)<.01)return;let l=r,p=t-r;if(r===0&&(p=t),Math.abs(p-s)>.01){let h={cursoNombre:this.cursoActivo,entrega:o,tipo:"PI",grupo:"",estudianteEmail:e.correo,rubricaId:"import-csv-sumatoria",criterios:[{criterioTitulo:"Calificaci\xF3n Importada",puntosObtenidos:p,puntosPersonalizados:!0,comentario:`Importado desde CSV de sumatorias(${o})`}],puntosTotales:p,fechaEvaluacion:new Date};yield this.dataService.guardarEvaluacion(h)}})}exportarCSVSumatorias(){return f(this,null,function*(){if(!this.cursoActivo||this.estudiantesActuales.length===0){yield(yield this.toastController.create({message:"No hay datos para exportar",duration:3e3,position:"top",color:"warning",cssClass:"toast-warning"})).present();return}try{let e=["Correo","E1","E2","EF"],o=this.estudiantesActuales.map(p=>{let h=this.obtenerSumatoria(p,"E1")||0,y=this.obtenerSumatoria(p,"E2")||0,$=this.obtenerSumatoria(p,"EF")||0;return[p.correo,h,y,$]}),t=[e,...o].map(p=>p.map(h=>`"${h}"`).join(",")).join(`
`),i=new Blob([t],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=new Date().toISOString().split("T")[0],s=`sumatorias_${this.cursoActivo}_${r}.csv`;if(a.download!==void 0){let p=URL.createObjectURL(i);a.setAttribute("href",p),a.setAttribute("download",s),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(p)}yield(yield this.toastController.create({message:`\u{1F4CA} CSV de Sumatorias exportado: ${s} `,duration:4e3,position:"top",color:"success",cssClass:"toast-success",buttons:[{text:"OK",role:"cancel"}]})).present()}catch(e){console.error("Error al exportar CSV:",e),yield(yield this.toastController.create({message:"Error al exportar CSV: "+e.message,duration:4e3,position:"top",color:"danger",cssClass:"toast-danger"})).present()}})}get archivoCanvasInfo(){if(!this.cursoActivo)return null;let e=this.dataService.obtenerArchivoCalificaciones(this.cursoActivo);return e?{nombre:e.nombre,fechaCarga:e.fechaCarga,enModoEscritura:!0}:null}get estadoSincronizacionCanvas(){if(!this.cursoActivo||!this.tieneArchivoCanvas())return{texto:"Sin Canvas",color:"medium"};if(!this.dataService.obtenerArchivoCalificaciones(this.cursoActivo))return{texto:"Sin Canvas",color:"medium"};let o=this.estudiantesActuales.filter(t=>{let i=this.obtenerSumatoria(t,"E1"),a=this.obtenerSumatoria(t,"E2"),r=this.obtenerSumatoria(t,"EF");return i>0||a>0||r>0}).length;return o===0?{texto:"Sin calificaciones",color:"warning"}:o===this.estudiantesActuales.length?{texto:`\u2713 Sincronizado(${o} / ${this.estudiantesActuales.length})`,color:"success"}:{texto:`Parcial(${o} / ${this.estudiantesActuales.length})`,color:"warning"}}tieneArchivoCanvas(){return this.cursoActivo?!!this.dataService.obtenerArchivoCalificaciones(this.cursoActivo):!1}getArchivoCanvasInfo(){if(!this.cursoActivo)return null;let e=this.dataService.obtenerArchivoCalificaciones(this.cursoActivo);return e?{nombre:e.nombre,fechaCarga:e.fechaCarga,enModoEscritura:!0}:null}previsualizarArchivoCanvas(){return f(this,null,function*(){if(!this.cursoActivo||!this.tieneArchivoCanvas()){yield this.mostrarError("Error","No hay archivo Canvas vinculado");return}console.log("\u{1F441}\uFE0F [previsualizarArchivoCanvas] Obteniendo archivo para:",{cursoActivo:this.cursoActivo,cursoEncontrado:!!this.cursosData[this.cursoActivo]});let e=this.dataService.obtenerArchivoCalificaciones(this.cursoActivo);if(!e){console.error("\u274C No se encontr\xF3 archivo Canvas para:",this.cursoActivo);return}console.log("\u{1F4C4} [previsualizarArchivoCanvas] Archivo encontrado:",{nombre:e.nombre,fechaCarga:e.fechaCarga,totalCalificaciones:e.calificaciones.length,tamanoCSV:e.contenidoOriginal.length});let o=e.contenidoOriginal.split(`
`),t=o.slice(0,11).join(`
`),i=o.length;yield(yield this.alertController.create({header:"Vista Previa Canvas",subHeader:`${e.nombre} (${i} l\xEDneas) - Curso: ${this.cursoActivo} `,message:`< pre style = "font-size: 0.7rem; overflow-x: auto; max-width: 100%;" > ${this.escapeHtml(t)} </pre>`,buttons:[{text:"Exportar",handler:()=>{this.exportarArchivoCanvas()}},{text:"Cerrar",role:"cancel"}]})).present()})}exportarArchivoCanvas(){return f(this,null,function*(){if(!this.cursoActivo||!this.tieneArchivoCanvas()){yield this.mostrarError("Error","No hay archivo Canvas vinculado");return}let e=this.dataService.obtenerArchivoCalificaciones(this.cursoActivo);if(e)try{let o=new Blob([e.contenidoOriginal],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),i=new Date().toISOString().split("T")[0],a=`${e.nombre.replace(".csv","")}_actualizado_${i}.csv`;t.href=window.URL.createObjectURL(o),t.download=a,t.click(),window.URL.revokeObjectURL(t.href),yield(yield this.toastController.create({message:`\u{1F4E5} Archivo Canvas exportado: ${a}`,duration:3e3,position:"top",color:"success",cssClass:"toast-success"})).present()}catch(o){console.error("Error exportando Canvas:",o),yield this.mostrarError("Error","Error al exportar el archivo Canvas")}})}escapeHtml(e){let o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,t=>o[t])}actualizarCalificacionesCanvas(){return f(this,null,function*(){if(!this.cursoActivo){yield this.mostrarError("Error","No hay curso activo seleccionado");return}let e=this.dataService.obtenerArchivoCalificaciones(this.cursoActivo);if(!e){yield this.mostrarError("Sin archivo Canvas","No hay archivo de calificaciones Canvas asociado a este curso. Vaya a Configuraci\xF3n para cargar uno.");return}if(this.estudiantesActuales.length===0){yield this.mostrarError("Sin estudiantes","No hay estudiantes en el curso actual");return}try{let o=yield this.loadingController.create({message:"Verificando archivo Canvas...",spinner:"crescent"});yield o.present();let t=yield this.verificarModoEscritura(e);if(yield o.dismiss(),!t){yield this.mostrarError("Archivo protegido","El archivo de calificaciones Canvas est\xE1 en modo de solo lectura. No se pueden realizar cambios.");return}yield this.realizarActualizacionCanvas()}catch(o){console.error("Error actualizando Canvas:",o),yield this.mostrarError("Error","Error al actualizar calificaciones: "+o.message)}})}verificarModoEscritura(e){return f(this,null,function*(){return new Promise(o=>{setTimeout(()=>{o(!0)},1e3)})})}realizarActualizacionCanvas(){return f(this,null,function*(){let e=yield this.loadingController.create({message:"Actualizando calificaciones Canvas...",spinner:"dots"});yield e.present();try{yield this.dataService.sincronizarArchivoCalificaciones(this.cursoActivo),yield e.dismiss(),yield(yield this.toastController.create({message:`\u2705 Calificaciones actualizadas en Canvas
\u{1F4CA} Archivo: ${this.getArchivoCanvasInfo()?.nombre}
\u{1F3AF} ${this.estudiantesActuales.length} estudiantes procesados`,duration:5e3,position:"top",color:"success",cssClass:"toast-success",buttons:[{text:"OK",role:"cancel"}]})).present()}catch(o){yield e.dismiss(),console.error("Error en actualizaci\xF3n Canvas:",o),yield(yield this.toastController.create({message:"\u274C Error actualizando Canvas: "+o.message,duration:4e3,position:"top",color:"danger",cssClass:"toast-danger"})).present()}})}};b.\u0275fac=function(o){return new(o||b)},b.\u0275cmp=J({type:b,selectors:[["app-inicio"]],decls:14,vars:7,consts:[[1,"mobile-optimized",3,"fullscreen"],["slot","fixed","vertical","bottom","horizontal","end"],["color","primary"],["name","ellipsis-vertical-outline"],["side","top"],["color","primary","data-desc","Grupo anterior",3,"click","disabled"],["name","arrow-back-outline"],["color","primary","data-desc","Grupo siguiente",3,"click","disabled"],["name","arrow-forward-outline"],[1,"layout",3,"ngStyle"],[1,"page-container"],[4,"ngIf"],[1,"empty-state-fullscreen"],[1,"estudiantes-section"],["scrollable","","mode","md",1,"course-segment",3,"ngModelChange","ionChange","ngModel"],[3,"value","--background-checked","--color-checked","--border-color",4,"ngFor","ngForOf","ngForTrackBy"],["size","auto","alignment","start",1,"color-picker-popover-wrapper",3,"didDismiss","isOpen","event"],[3,"value"],[1,"course-label"],[1,"course-name-wrapper"],[1,"course-tab-code"],["fill","clear","size","small",1,"course-menu-btn",3,"click"],["slot","icon-only","name","ellipsis-vertical"],[1,"color-picker-popover"],[1,"color-picker-header"],["fill","clear","size","small",3,"click"],["name","close-outline","slot","icon-only"],[1,"color-picker-content"],[1,"color-picker-grid"],[1,"color-option",3,"background-color","selected","title"],[1,"color-picker-input-section"],[1,"hex-input-wrapper"],[1,"hex-label"],["type","text","placeholder","#FF0000","maxlength","7","fill","outline",1,"color-hex-input",3,"ngModelChange","ionInput","ngModel"],[1,"hex-hint"],[1,"color-picker-actions"],["fill","outline","size","small",3,"click"],["fill","solid","size","small",3,"click"],[1,"color-option",3,"click","title"],["name","checkmark-circle"],[1,"empty-state-content"],["name","document-text","size","large","color","medium"],[1,"dashboard-options"],[1,"header-con-toggle"],[1,"info-icon-header"],["name","information-circle",1,"header-info-icon"],[1,"grupo-header-inline"],[1,"modo-vista-toggle",3,"title"],[1,"entregas-matrix-container"],[1,"grupo-detail-content"],["name","people-circle"],[1,"grupo-nombre"],[1,"integrantes-count"],[1,"modo-vista-toggle",3,"click","title"],[1,"lock-icon",3,"name"],[1,"entregas-matrix"],[1,"header-entrega"],["name","rocket",1,"header-icon"],[1,"header-grupo","header-clickable",3,"title"],[1,"header-grupo","header-clickable",3,"click","title"],[1,"label-entrega"],[1,"cell-estado",3,"estado-completo","estado-parcial","estado-pendiente","title"],[1,"cell-estado",3,"click","title"],[1,"estado-indicator"],[1,"grupo-content-layout"],["lines","none"],[1,"rubrica-column"],[1,"rubrica-container-full"],[1,"rubrica-container-full","loading"],[1,"rubrica-placeholder"],[1,"anotaciones-column"],[1,"area-anotaciones"],[1,"anotaciones-header"],["name","create-outline"],["color","tertiary","mode","ios"],[1,"estados-toolbar"],["size","small","color","success","title","Ok",3,"click","fill","disabled"],["name","checkmark-circle","slot","icon-only"],["size","small","color","warning","title","Solo",3,"click","fill","disabled"],["name","git-merge","slot","icon-only"],["size","small","color","danger","title","Ausente",3,"click","fill","disabled"],["name","close-circle","slot","icon-only"],[1,"modo-seleccion-activo"],[1,"anotaciones-content"],[1,"placeholder-text"],[1,"rubrica-header-compact"],[1,"rubrica-nombre"],["color","success","mode","ios",1,"rubrica-points-chip"],["fill","solid","size","small","color","primary",1,"btn-guardar-rubrica",3,"click"],["name","save-outline","slot","start"],["fill","clear","size","small",1,"btn-cerrar-rubrica",3,"click"],["name","close-outline"],[1,"rubrica-content-full"],[3,"puntuacionChange","calificacionesChange","evaluacionGuardada","rubrica","estudianteId","nombreEstudiante","evaluacionExistente","grupoId","entregaActual"],["name","document-text-outline","color","medium"],["color","medium"],[1,"anotaciones-texto"],["fill","clear","size","small","color","medium",3,"click"],["name","trash-outline","slot","start"],["name","alert-circle","slot","start","color","medium"]],template:function(o,t){o&1&&(d(0,"ion-content",0)(1,"ion-fab",1)(2,"ion-fab-button",2),C(3,"ion-icon",3),u(),d(4,"ion-fab-list",4)(5,"ion-fab-button",5),E("click",function(){return t.retrocederGrupo()}),C(6,"ion-icon",6),u(),d(7,"ion-fab-button",7),E("click",function(){return t.avanzarGrupo()}),C(8,"ion-icon",8),u()()(),d(9,"div",9)(10,"div",10),O(11,Jo,6,5,"ion-card",11),z(12,Wo,10,0,"div",12),z(13,mt,10,3,"div",13),u()()()),o&2&&(S("fullscreen",!0),m(5),S("disabled",!t.grupoAnteriorDisponible),m(2),S("disabled",!t.grupoSiguienteDisponible),m(2),S("ngStyle",t.layoutStyles),m(2),S("ngIf",t.cursosDisponibles.length>0),m(),_(t.cursosDisponibles.length===0?12:-1),m(),_(t.cursoActivo&&t.estudiantesActuales.length>0?13:-1))},dependencies:[te,Z,ee,oe,ne,ie,re,ae,he,de,ue,pe,le,ke,Ie,we,ve,ge,Pe,se,me,fe,be,xe,ce,Ce,Lo],styles:[`@charset "UTF-8";:host{--seguimiento-bg: transparent;--seguimiento-card-bg: #FFFFFF;--seguimiento-border: rgba(15, 56, 90, .1);--seguimiento-text: #2c3e50;--seguimiento-accent: var(--azul-claro)}.seguimiento-card{height:100%;background:var(--seguimiento-card-bg);border:1px solid rgba(15,56,90,.1);border-radius:12px;box-shadow:0 4px 12px #0f385a1f;overflow:hidden}.seguimiento-card ion-card-content{padding:12px!important}.seguimiento-title{font-size:1.2rem;font-weight:600;color:#fff;margin:0;padding:16px;background:linear-gradient(135deg,var(--azul-oscuro) 0%,#0d2e47 100%);border-bottom:1px solid rgba(15,56,90,.1);text-shadow:0 1px 2px rgba(0,0,0,.2)}.seguimiento-content{padding:20px;height:calc(100% - 80px);overflow-y:auto}.seguimiento-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;text-align:center;color:#546e7a;opacity:.8}.seguimiento-placeholder ion-icon{margin-bottom:16px;color:var(--azul-claro)}.seguimiento-placeholder h4{margin:8px 0;font-size:1.1rem;font-weight:600;color:var(--azul-oscuro)}.seguimiento-placeholder p{margin:0;font-size:.9rem;opacity:.9;color:#546e7a}@media (max-width: 768px){.seguimiento-card{margin-top:16px}.seguimiento-title{font-size:1.1rem;padding:12px}.seguimiento-content{padding:16px}}.grupos-seguimiento{margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid var(--seguimiento-border)}.grupos-titulo{font-size:.8rem;font-weight:600;color:var(--azul-oscuro);margin:0 0 8px;text-transform:uppercase;letter-spacing:.5px}.grupos-container{display:flex;flex-wrap:wrap;gap:5px;padding:4px;overflow-x:hidden;overflow-y:visible;justify-content:flex-start}.grupo-btn{min-width:38px;height:38px;padding:0 12px;border:none;border-radius:10px;background:transparent;color:var(--azul-oscuro);font-size:.9rem;font-weight:600;letter-spacing:.3px;cursor:pointer;box-shadow:none;position:relative;overflow:hidden;flex-shrink:0;transition:all .25s cubic-bezier(.4,0,.2,1)}.grupo-btn:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(15,56,90,.08),transparent);transition:left .4s ease}.grupo-btn:hover{transform:translateY(-2px) scale(1.02);box-shadow:0 2px 8px #0f385a1f;background:#0f385a0f}.grupo-btn:hover:before{left:100%}.grupo-btn:active{transform:scale(.98);box-shadow:0 1px 4px #0f385a1a}.grupo-btn.activo{background:var(--azul-oscuro);color:#fff;box-shadow:0 4px 12px #0f385a59;transform:scale(1.03);font-weight:700}.grupo-btn.activo:hover{background:#0d2e47}.grupo-btn.seleccionado-masivo{background:linear-gradient(135deg,#ffb74d,#ffa726);color:#fff;border-color:#ff9800;box-shadow:0 3px 10px #ff980059;transform:scale(1.02);animation:pulse-masivo 2s infinite}.grupo-btn.seleccionado-masivo:hover{background:linear-gradient(135deg,#ff9800,#f57c00);border-color:#f57c00;transform:scale(1.04)}.grupo-btn.activo.seleccionado-masivo{background:linear-gradient(135deg,#4caf50,#2e7d32);border-color:#4caf50;box-shadow:0 3px 12px #4caf5066}@keyframes pulse-masivo{0%{box-shadow:0 3px 10px #ff980059}50%{box-shadow:0 4px 15px #ff980080}to{box-shadow:0 3px 10px #ff980059}}.seguimiento-info{padding:16px;background:linear-gradient(135deg,#1fb2de0d,#15bece0d);border-radius:8px;border-left:4px solid var(--azul-claro);margin-top:16px}.seguimiento-info>h4{font-size:1rem;font-weight:600;color:var(--azul-oscuro);margin:0 0 8px}.seguimiento-info>p{font-size:.9rem;color:#546e7a;margin:0}.comentarios-grupo{margin-top:16px}.comentarios-grupo .comentarios-titulo{font-size:.95rem;font-weight:600;color:var(--azul-oscuro);margin:0 0 12px;padding-bottom:8px;border-bottom:2px solid rgba(31,178,222,.2)}.comentario-form{margin-bottom:16px}.comentario-form .comentario-input{margin-bottom:10px;--background: #ffffff;--border-color: rgba(15, 56, 90, .2);--border-radius: 8px;--padding-start: 12px;--padding-end: 12px;--padding-top: 10px;--padding-bottom: 10px;font-size:.9rem}.comentario-form .comentario-input::part(native){border:1px solid rgba(15,56,90,.2);border-radius:8px}.comentario-form .comentario-input:focus-within{--border-color: var(--azul-claro)}.comentario-form .comentario-input:focus-within::part(native){border-color:var(--azul-claro);box-shadow:0 0 0 3px #1fb2de1a}.comentario-form .btn-agregar-comentario{--background: linear-gradient(135deg, var(--azul-claro) 0%, var(--cyan) 100%);--background-hover: linear-gradient(135deg, var(--azul-oscuro) 0%, #0d2e47 100%);--border-radius: 8px;--box-shadow: 0 2px 8px rgba(31, 178, 222, .25);--padding-start: 16px;--padding-end: 16px;height:36px;font-size:.85rem;font-weight:500;text-transform:none;letter-spacing:.3px;margin:0}.comentario-form .btn-agregar-comentario ion-icon{font-size:1.1rem;margin-right:6px}.comentario-form .btn-agregar-comentario:hover:not([disabled]){--background: linear-gradient(135deg, var(--azul-oscuro) 0%, #0d2e47 100%)}.comentario-form .btn-agregar-comentario[disabled]{--background: #e0e0e0;--color: #9e9e9e;--box-shadow: none;opacity:.6}.comentarios-lista{max-height:400px;overflow-y:auto;padding:4px}.comentarios-lista::-webkit-scrollbar{width:6px}.comentarios-lista::-webkit-scrollbar-track{background:#0f385a0d;border-radius:3px}.comentarios-lista::-webkit-scrollbar-thumb{background:#1fb2de4d;border-radius:3px}.comentarios-lista::-webkit-scrollbar-thumb:hover{background:#1fb2de80}.comentarios-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 16px;color:#90a4ae}.comentarios-empty ion-icon{font-size:3rem;margin-bottom:12px;opacity:.5}.comentarios-empty p{font-size:.9rem;margin:0}.comentario-card{background:#fff;border:1px solid rgba(15,56,90,.1);border-radius:8px;padding:12px;margin-bottom:10px;box-shadow:0 2px 6px #0f385a14}.comentario-card:hover{box-shadow:0 3px 10px #1fb2de26;border-color:#1fb2de4d;transform:translateY(-1px)}.comentario-card:last-child{margin-bottom:0}.comentario-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.comentario-header .comentario-fecha{font-size:.75rem;color:#78909c;font-weight:500}.comentario-header .comentario-actions{display:flex;gap:4px}.comentario-header .btn-editar,.comentario-header .btn-eliminar{--padding-start: 6px;--padding-end: 6px;height:28px;width:28px;margin:0}.comentario-header .btn-editar ion-icon,.comentario-header .btn-eliminar ion-icon{font-size:1rem}.comentario-header .btn-editar{--color: var(--azul-claro)}.comentario-header .btn-editar:hover{--color: var(--azul-oscuro)}.comentario-edit-mode .comentario-input-edit{margin-bottom:10px;--background: #ffffff;--border-color: rgba(15, 56, 90, .2);--border-radius: 8px;--padding-start: 12px;--padding-end: 12px;--padding-top: 10px;--padding-bottom: 10px;font-size:.9rem}.comentario-edit-mode .comentario-input-edit::part(native){border:1px solid rgba(15,56,90,.2);border-radius:8px}.comentario-edit-mode .comentario-input-edit:focus-within{--border-color: var(--azul-claro)}.comentario-edit-mode .comentario-input-edit:focus-within::part(native){border-color:var(--azul-claro);box-shadow:0 0 0 3px #1fb2de1a}.comentario-edit-mode .comentario-edit-actions{display:flex;gap:8px;justify-content:flex-end}.comentario-edit-mode .comentario-edit-actions ion-button{--border-radius: 8px;height:32px;font-size:.82rem;font-weight:500;text-transform:none;margin:0}.comentario-edit-mode .comentario-edit-actions ion-button ion-icon{font-size:1rem}.comentario-edit-mode .comentario-edit-actions .btn-guardar-edicion{--background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);--background-hover: linear-gradient(135deg, #388e3c 0%, #4caf50 100%);--box-shadow: 0 2px 6px rgba(76, 175, 80, .25);--padding-start: 12px;--padding-end: 12px}.comentario-edit-mode .comentario-edit-actions .btn-guardar-edicion:hover:not([disabled]){--background: linear-gradient(135deg, #388e3c 0%, #4caf50 100%)}.comentario-edit-mode .comentario-edit-actions .btn-guardar-edicion[disabled]{--background: #e0e0e0;--color: #9e9e9e;--box-shadow: none;opacity:.6}.comentario-edit-mode .comentario-edit-actions .btn-cancelar-edicion{--border-color: #90a4ae;--color: #546e7a;--padding-start: 12px;--padding-end: 12px}.comentario-edit-mode .comentario-edit-actions .btn-cancelar-edicion:hover{--background: rgba(144, 164, 174, .1);--border-color: #546e7a}.comentario-texto{font-size:.88rem;color:#37474f;line-height:1.5;margin:0 0 6px;word-wrap:break-word;white-space:pre-wrap}.comentario-autor{display:block;font-size:.8rem;color:#607d8b;font-style:italic;margin-top:6px}.rubrica-contenedor{margin:16px 0;padding:12px;background:#1fb2de0d;border-radius:8px;border:1px solid rgba(31,178,222,.2)}.rubrica-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding-bottom:8px;border-bottom:2px solid var(--azul-claro)}.rubrica-header h5{margin:0;color:var(--azul-oscuro);font-weight:700;font-size:1rem}.rubrica-header .rubrica-puntos{background:var(--verde);color:#fff;padding:4px 12px;border-radius:12px;font-weight:600;font-size:.9rem}.rubrica-criterios{display:flex;flex-direction:column;gap:12px;margin-bottom:16px}.criterio-item h6{margin:0 0 8px;color:var(--azul-oscuro);font-size:.85rem;font-weight:600}.niveles-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}.nivel-btn{background:#fff;border:2px solid rgba(15,56,90,.2);border-radius:6px;padding:8px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:4px}.nivel-btn:hover{border-color:var(--azul-claro);background:#1fb2de0d}.nivel-btn.selected{background:var(--azul-claro);border-color:var(--azul-oscuro);color:#fff}.nivel-btn.selected .nivel-puntos,.nivel-btn.selected .nivel-desc{color:#fff}.nivel-btn .nivel-puntos{font-weight:700;font-size:1.1rem;color:var(--azul-oscuro)}.nivel-btn .nivel-desc{font-size:.7rem;color:#546e7a;text-align:center}.btn-guardar-rubrica{--background: var(--verde);--background-hover: #b8d951;margin-top:8px}@media (max-width: 768px){.grupos-container{gap:8px}.grupo-btn{min-width:44px;height:44px;font-size:1rem;padding:0 14px}}:host{--fs-xs: clamp(.7rem, 1.8vw, .75rem);--fs-sm: clamp(.8rem, 2.2vw, .85rem);--fs-md: clamp(.85rem, 2.5vw, .9rem);--fs-lg: clamp(.95rem, 3vw, 1rem);--fs-xl: clamp(1rem, 3.5vw, 1.1rem);--fs-xxl: clamp(1.1rem, 4vw, 1.2rem);--spacing-xs: clamp(2px, .5vw, 4px);--spacing-sm: clamp(4px, 1vw, 8px);--spacing-md: clamp(8px, 2vw, 12px);--spacing-lg: clamp(12px, 2.5vw, 16px);--spacing-xl: clamp(16px, 3vw, 20px);--pad-xs: var(--spacing-xs);--pad-sm: var(--spacing-sm);--pad-md: var(--spacing-md);--gap-xs: var(--spacing-xs);--gap-sm: var(--spacing-sm);--gap-md: var(--spacing-md);--card-padding: clamp(8px, 2vw, 16px);--button-height: clamp(36px, 8vw, 44px);--badge-size: clamp(.65rem, 2vw, .75rem);--chip-height: clamp(24px, 5vw, 28px);--rad-sm: 8px;--rad-xs: 4px;--shadow-light: 0 2px 4px rgba(0, 0, 0, .1);--shadow-medium: 0 4px 8px rgba(0, 0, 0, .15);--icon-size-fab: clamp(1.1rem, 3vw, 1.4rem);--icon-size-button: clamp(.9rem, 2.5vw, 1.1rem);--fab-size: clamp(48px, 10vw, 56px);--list-item-height: clamp(44px, 10vw, 60px);--list-item-compact: clamp(32px, 7vw, 40px)}ion-content{--background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0;--offset-bottom: 0;--offset-top: 0}ion-content.ion-content-scroll-host{overflow:hidden}.header-e1,.header-e2,.header-ef{max-width:60px}.header-total{max-width:50px}.rubrica-title{font-size:.9rem}.rubrica-points-chip{height:24px;font-size:.85rem}.action-bar{display:flex;gap:4.8px;margin:0;padding:4.8px 7.2px;background:#fff;border-radius:4.8px;box-shadow:0 .6px 1.8px #0f385a14}.action-bar .action-btn-square{--border-radius: 4.8px;--padding-start: 7.2px;--padding-end: 7.2px;--color: white;--background: var(--azul-oscuro);height:24px;min-height:24px;margin:0;font-size:.51rem;font-weight:600;text-transform:none;letter-spacing:.18px;white-space:nowrap}.action-bar .action-btn-square ion-icon{font-size:10.8px;color:#fff;margin-right:3.6px}.action-bar .action-btn-square.btn-export{--background: var(--verde);--color: white}.action-bar .action-btn-square.btn-edit{--background: var(--naranja);--color: white}.action-bar .action-btn-square.btn-delete{--background: var(--magenta);--color: white}.action-bar .action-btn-square:hover:not([disabled]){transform:translateY(-1px);box-shadow:0 2px 4px #00000026}.action-bar .action-btn-square[disabled]{opacity:.4}:host ion-icon{transition:all .3s ease}@media (max-width: 768px){:host ion-icon{transform:scale(.9)}}@media (max-width: 480px){:host ion-icon{transform:scale(.8)}}@media (max-width: 960px) and (orientation: landscape){:host ion-icon{transform:scale(.7)}}@media (max-width: 360px){:host ion-icon{transform:scale(.75)}}:host ion-icon:hover{transform:scale(1.1)}@media (max-width: 768px){:host ion-icon:hover{transform:scale(1)}}@media (max-width: 480px){:host ion-icon:hover{transform:scale(.9)}}ion-card{background-color:#fff;border:1px solid rgba(15,56,90,.1);box-shadow:0 2px 6px #0f385a0f;margin:0}ion-card ion-card-header{background:linear-gradient(135deg,var(--azul-oscuro) 0%,#0d2e47 100%);color:#fff;padding:2px 8px!important}ion-card ion-card-header ion-card-title{color:#fff;font-weight:600;font-size:.85rem}ion-card ion-card-content{background-color:#fff;color:#000;padding:2px!important}ion-card:has(.course-segment){border:none;box-shadow:none;margin-bottom:2px}ion-card:has(.course-segment) ion-card-content{padding:0!important;--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0}ion-card.dashboard-options{border:2px solid var(--azul-claro);border-radius:6px;margin:0}ion-card.dashboard-options ion-card-header{padding:2px 6px!important}ion-card.dashboard-options ion-card-content{padding:2px!important;--padding-start: 2px;--padding-end: 2px;--padding-top: 2px;--padding-bottom: 2px}.estudiantes-section{border:2px solid var(--naranja);border-radius:6px;padding:0;background:#ffffff80;margin-top:2px}.layout{position:absolute;inset:0;width:100%;max-width:100%;height:100%;padding:0;margin:0;background:transparent;box-sizing:border-box;display:flex;flex-direction:column}@media (min-width: 1024px){.layout{flex-direction:row;gap:0}}.page-container{position:relative;width:100%;max-width:100%;height:100%;padding:0;margin:0;background:transparent;box-sizing:border-box;overflow:hidden}@media (max-width: 768px){.page-container{padding:0;height:auto;min-height:100%}}@media (max-width: 480px){.page-container{padding:0}}@media (min-width: 769px){.page-container{padding:0}}@media (min-width: 1200px){.page-container{padding:0}}@media (min-width: 1024px){.page-container{flex:1;max-width:none;margin-right:0}.page-container .estudiantes-section,.page-container .table-container{width:100%;margin:0}.page-container .estudiantes-table{width:100%;table-layout:fixed}}@media (min-height: 800px){.page-container{padding-bottom:16px}}@media (min-height: 1200px){.page-container{padding-bottom:24px}}.page-container::-webkit-scrollbar{width:6px}.page-container::-webkit-scrollbar-track{background:transparent}.page-container::-webkit-scrollbar-thumb{background:var(--azul-claro);border-radius:3px}.page-container::-webkit-scrollbar-thumb:hover{background:var(--azul-oscuro)}.estudiantes-container ion-card-content{padding:0;margin:0}.estudiantes-container ion-card{margin:2px 0;width:100%;box-sizing:border-box}.section-header{margin:2px 0;padding:0 2px}.section-header .section-title{font-size:.84rem;font-weight:700;color:#0f385a;margin:0;padding:4px 6px;background:linear-gradient(135deg,#0f385a14,#0f385a08);border-radius:7.2px;border-left:3.6px solid #0F385A;box-shadow:0 1.2px 4.8px #0f385a1a;font-family:var(--font-principal, "Montserrat", sans-serif);letter-spacing:.18px}.section-header .section-title:hover{background:linear-gradient(135deg,#0f385a1f,#0f385a0f);transform:translateY(-.6px);box-shadow:0 2.4px 7.2px #0f385a26}@media (max-width: 768px){.section-header .section-title{font-size:.72rem;padding:6px 7.2px}}@media (max-width: 480px){.section-header .section-title{font-size:.66rem;padding:4.8px 6px}}.title-container{display:flex;flex-direction:column;align-items:flex-start;line-height:1.1}.course-name{font-size:.66rem;font-weight:600;color:#fff}.course-code{font-size:.48rem;font-weight:400;color:#fffc}ion-card ion-card-content .course-segment,ion-segment.course-segment{--background: #ffffff;background:#fff;border-radius:var(--rad-sm);overflow-x:auto;padding:4px;border:2px solid var(--border-color);box-shadow:0 2px 6px #00000014;justify-content:flex-start;transform:scale(1);transform-origin:left center;position:relative}@media (max-width: 768px){ion-card ion-card-content .course-segment,ion-segment.course-segment{transform:scale(.95);padding:3px}}@media (max-width: 480px){ion-card ion-card-content .course-segment,ion-segment.course-segment{transform:scale(.9);padding:2px}}ion-card ion-card-content .course-segment.drag-active,ion-segment.course-segment.drag-active{background:var(--ion-color-primary-tint);border-radius:12px;padding:4px;transition:all .3s ease;animation:drag-pulse 2s infinite}ion-card ion-card-content .course-segment.drag-active:after,ion-segment.course-segment.drag-active:after{content:"\\2194\\fe0f  Arrastra para reordenar";position:absolute;top:-25px;left:50%;transform:translate(-50%);background:var(--azul-oscuro);color:#fff;padding:4px 8px;border-radius:4px;font-size:.7rem;white-space:nowrap;z-index:50;opacity:.9;animation:fade-in .3s ease}ion-card ion-card-content .course-segment ion-segment-button,ion-segment.course-segment ion-segment-button{--background: var(--border-color);--background-checked: var(--border-color);--background-hover: var(--border-color);--color: #ffffff;--color-checked: #ffffff;--indicator-color: transparent;--indicator-height: 0;--border-radius: 8px;--padding-top: 3px;--padding-bottom: 3px;--padding-start: 6px;--padding-end: 6px;min-width:clamp(80px,16vw,112px);max-width:clamp(144px,22vw,176px);min-height:clamp(36px,8vw,48px);flex:0 0 auto;margin:0;position:relative;font-family:var(--font-principal, "Montserrat", sans-serif)}@media (max-width: 767px){ion-card ion-card-content .course-segment ion-segment-button,ion-segment.course-segment ion-segment-button{min-width:clamp(76px,19vw,104px);max-width:clamp(136px,26vw,160px);min-height:clamp(34px,7vw,42px);--padding-start: 5px;--padding-end: 5px}}@media (max-width: 480px){ion-card ion-card-content .course-segment ion-segment-button,ion-segment.course-segment ion-segment-button{min-width:clamp(72px,21vw,96px);min-height:clamp(32px,6vw,38px)}}ion-card ion-card-content .course-segment ion-segment-button::part(native),ion-segment.course-segment ion-segment-button::part(native){background:var(--border-color);border:2px solid var(--border-color);transition:all .3s ease}ion-card ion-card-content .course-segment ion-segment-button .course-tab-code,ion-card ion-card-content .course-segment ion-segment-button .course-tab-name,ion-segment.course-segment ion-segment-button .course-tab-code,ion-segment.course-segment ion-segment-button .course-tab-name{color:#fff;font-size:.55rem;font-weight:600;text-align:center;line-height:1.1}ion-card ion-card-content .course-segment ion-segment-button:hover,ion-segment.course-segment ion-segment-button:hover{transform:translateY(-1px);box-shadow:0 2px 8px #0003}ion-card ion-card-content .course-segment ion-segment-button:hover::part(native),ion-segment.course-segment ion-segment-button:hover::part(native){border-color:var(--border-color);border-width:2px;filter:brightness(1.1)}ion-card ion-card-content .course-segment ion-segment-button.segment-button-checked,ion-segment.course-segment ion-segment-button.segment-button-checked{box-shadow:0 4px 12px #00000026;transform:translateY(-1px)}ion-card ion-card-content .course-segment ion-segment-button.segment-button-checked::part(native),ion-segment.course-segment ion-segment-button.segment-button-checked::part(native){background:var(--border-color);border:2px solid var(--border-color);filter:brightness(1.1)}ion-card ion-card-content .course-segment ion-segment-button.segment-button-checked:after,ion-segment.course-segment ion-segment-button.segment-button-checked:after{content:"";position:absolute;bottom:-3px;left:10%;right:10%;height:4px;background:linear-gradient(90deg,var(--azul-oscuro) 0%,#0d2e47 100%);border-radius:2px 2px 0 0;box-shadow:0 2px 6px #0f385a99;z-index:10}ion-card ion-card-content .course-segment ion-segment-button.segment-button-checked .course-tab-code,ion-segment.course-segment ion-segment-button.segment-button-checked .course-tab-code{font-weight:800;text-shadow:0 1px 2px rgba(0,0,0,.1)}ion-card ion-card-content .course-segment ion-segment-button:active,ion-segment.course-segment ion-segment-button:active{transform:scale(.98)}ion-card ion-card-content .course-segment ion-segment-button.dragging,ion-segment.course-segment ion-segment-button.dragging{opacity:.5;transform:scale(.95) rotate(3deg);box-shadow:0 8px 25px #1fb2de66;border:2px dashed var(--azul-claro)!important;background:#1fb2de1a!important;z-index:100;pointer-events:none}ion-card ion-card-content .course-segment ion-segment-button.dragging::part(native),ion-segment.course-segment ion-segment-button.dragging::part(native){background:#1fb2de1a!important;border:2px dashed var(--azul-claro)!important}ion-card ion-card-content .course-segment ion-segment-button.drag-over,ion-segment.course-segment ion-segment-button.drag-over{transform:scale(1.05);box-shadow:0 0 20px #a6ce3899;border:2px solid var(--verde)!important;background:#a6ce3826!important}ion-card ion-card-content .course-segment ion-segment-button.drag-over::part(native),ion-segment.course-segment ion-segment-button.drag-over::part(native){background:#a6ce3826!important;border:2px solid var(--verde)!important}ion-card ion-card-content .course-segment ion-segment-button.drag-over:before,ion-segment.course-segment ion-segment-button.drag-over:before{content:"";position:absolute;inset:-2px;border:2px solid var(--verde);border-radius:8px;background:#a6ce381a;z-index:-1;animation:pulse-drop-zone 1s infinite}.course-label{display:flex;flex-direction:column;align-items:flex-start;gap:1px;padding:4px 6px;pointer-events:auto;width:100%;position:relative}.course-name-wrapper{display:flex;flex-direction:column;gap:1px;width:100%;padding-right:22px}.course-menu-btn{position:absolute;top:1px;right:1px;pointer-events:auto;--padding-start: 2px;--padding-end: 2px;--padding-top: 2px;--padding-bottom: 2px;--background: transparent;--background-hover: rgba(0, 0, 0, .05);--background-activated: rgba(0, 0, 0, .1);width:20px;height:20px;margin:0}.course-menu-btn ion-icon{font-size:14px;color:var(--azul-oscuro);opacity:.7}.course-menu-btn:hover{--background: rgba(0, 0, 0, .08)}.course-menu-btn:hover ion-icon{color:var(--azul-oscuro);opacity:1}ion-segment-button.segment-button-checked .course-menu-btn{--background-hover: rgba(255, 255, 255, .1);--background-activated: rgba(255, 255, 255, .2)}ion-segment-button.segment-button-checked .course-menu-btn ion-icon{color:#fff;opacity:.9}ion-segment-button.segment-button-checked .course-menu-btn:hover ion-icon{color:#fff;opacity:1}ion-segment-button .course-label .course-tab-name,ion-segment-button .course-label .course-tab-code{font-size:.55rem;font-weight:700;color:var(--azul-oscuro);text-align:left;line-height:1.1;font-family:var(--font-principal, "Montserrat", sans-serif);word-wrap:break-word;white-space:normal;display:block;width:100%;text-transform:uppercase;letter-spacing:.3px;padding-left:2px}.course-header .color-picker-icon,ion-segment-button .course-header .color-picker-icon{font-size:1.1rem;color:var(--azul-claro);cursor:pointer;pointer-events:auto;padding:4px;border-radius:4px;opacity:.7;z-index:10;position:relative;flex-shrink:0}.course-header .color-picker-icon:hover,ion-segment-button .course-header .color-picker-icon:hover{opacity:1;background:#1fb2de1a;transform:scale(1.15)}.course-header .color-picker-icon:active,ion-segment-button .course-header .color-picker-icon:active{transform:scale(1.05)}.course-header .color-picker-icon:focus,ion-segment-button .course-header .color-picker-icon:focus{outline:2px solid var(--azul-claro);outline-offset:2px}ion-segment-button.segment-button-checked .color-picker-icon{color:#fff}ion-segment-button.segment-button-checked .color-picker-icon:hover{background:#ffffff26}ion-segment-button.segment-button-checked .color-picker-icon:focus{outline-color:#fff}.text-center{text-align:center}.estudiantes-section{border:2px solid var(--naranja);border-radius:8px;padding:12px;background:#ffffff80;margin-top:12px}.empty-state-fullscreen{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#fff,#f8f9fa);border:2px solid var(--verde);margin:0;padding:0;z-index:1;pointer-events:auto;overflow:hidden;box-sizing:border-box}.empty-state-fullscreen .empty-state-content{text-align:center;padding:40px 20px}.empty-state-fullscreen .empty-state-content ion-icon{color:var(--azul-claro);font-size:4rem;margin-bottom:20px}.empty-state-fullscreen .empty-state-content h3{color:var(--azul-oscuro);font-weight:600;font-size:14px;margin:16px 0}.empty-state-fullscreen .empty-state-content p{color:#2c3e50;font-size:14px;margin:8px 0 0;line-height:1.5}.empty-state-fullscreen .empty-state-content p strong{font-weight:600;color:var(--azul-oscuro)}@media (max-width: 767px){.empty-state-fullscreen .empty-state-content{padding:30px 15px}.empty-state-fullscreen .empty-state-content ion-icon{font-size:3rem;margin-bottom:15px}.empty-state-fullscreen .empty-state-content h3,.empty-state-fullscreen .empty-state-content p{font-size:12px}}ion-card.text-center,ion-card ion-card-content.text-center{background:linear-gradient(135deg,#fff,#f8f9fa);color:#000;padding:40px 20px;border:1px solid rgba(15,56,90,.1);box-shadow:0 4px 12px #0f385a14}ion-card.text-center ion-icon,ion-card ion-card-content.text-center ion-icon{color:var(--azul-claro);font-size:4rem;margin-bottom:20px}ion-card.text-center h3,ion-card ion-card-content.text-center h3{color:var(--azul-oscuro);font-weight:600;font-size:14px;margin:16px 0}ion-card.text-center p,ion-card ion-card-content.text-center p{color:#2c3e50;font-size:14px;margin:8px 0 0;line-height:1.5}ion-card.text-center p strong,ion-card ion-card-content.text-center p strong{font-weight:600;color:var(--azul-oscuro)}ion-card.text-center p .inline-icon,ion-card ion-card-content.text-center p .inline-icon{vertical-align:middle;font-size:1.2em;margin:0 4px;color:var(--azul-claro)}@media (max-width: 767px){ion-card.text-center,ion-card ion-card-content.text-center{padding:30px 15px}ion-card.text-center ion-icon,ion-card ion-card-content.text-center ion-icon{font-size:3rem;margin-bottom:15px}ion-card.text-center h3,ion-card ion-card-content.text-center h3{font-size:12px}ion-card.text-center p,ion-card ion-card-content.text-center p{font-size:12px}}ion-badge{font-size:var(--badge-size);font-weight:600;padding:var(--spacing-xs) var(--spacing-sm);border-radius:var(--rad-xs)}ion-badge[color=primary]{--background: var(--azul-oscuro);--color: #ffffff}ion-badge[color=secondary]{--background: var(--azul-claro);--color: #ffffff}ion-badge[color=success]{--background: var(--verde);--color: #ffffff}ion-badge[color=warning]{--background: var(--naranja);--color: #ffffff}ion-badge[color=danger]{--background: var(--magenta);--color: #ffffff}ion-chip{height:var(--chip-height);font-size:var(--fs-sm)}.grupo-card-header{background:linear-gradient(135deg,var(--azul-oscuro, #0f385a) 0%,#1a4a6e 100%);padding:12px 16px}.grupo-card-header .grupo-card-title{display:flex;align-items:center;gap:10px;color:#fff;font-size:1.1rem;font-weight:700;margin:0}.grupo-card-header .grupo-card-title ion-icon{font-size:1.5rem;color:var(--azul-claro, #1fb2de)}.grupo-card-header .grupo-card-title ion-badge{--background: var(--azul-claro, #1fb2de);--color: white;font-size:.75rem;margin-left:auto}.grupo-detail-content{padding:0}.grupo-content-layout{display:grid;grid-template-columns:1fr 280px;gap:8px;padding:8px;min-height:400px}.rubrica-column{display:flex;flex-direction:column;min-width:0}.rubrica-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;min-height:300px;background:#0f385a05;border:1px dashed rgba(15,56,90,.2);border-radius:4px}.rubrica-placeholder ion-icon{font-size:3rem;margin-bottom:12px}.rubrica-placeholder p{color:var(--ion-color-medium);font-size:.9rem;margin:0}.anotaciones-column{display:flex;flex-direction:column}.area-anotaciones{display:flex;flex-direction:column;height:100%;background:#0f385a05;border:1px solid rgba(15,56,90,.1);border-radius:4px;overflow:hidden}.area-anotaciones .anotaciones-header{display:flex;align-items:center;gap:6px;padding:8px 12px;background:linear-gradient(135deg,var(--azul-oscuro) 0%,#0d2e47 100%);color:#fff;font-size:.85rem;font-weight:600}.area-anotaciones .anotaciones-header ion-icon{font-size:1rem}.area-anotaciones .anotaciones-header ion-badge{margin-left:auto;font-size:.7rem}.area-anotaciones .estados-toolbar{display:flex;gap:4px;padding:8px;background:#0f385a0d;border-bottom:1px solid rgba(15,56,90,.1)}.area-anotaciones .estados-toolbar ion-button{--padding-start: 8px;--padding-end: 8px;font-size:.75rem;height:28px}.area-anotaciones .modo-seleccion-activo{padding:6px 12px;background:#ffc1071a;border-bottom:1px solid rgba(255,193,7,.3);text-align:center}.area-anotaciones .integrantes-lista{border-bottom:1px solid rgba(15,56,90,.1)}.area-anotaciones .integrantes-lista .integrantes-header{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#0f385a0d;font-size:.8rem;font-weight:600;color:var(--azul-oscuro)}.area-anotaciones .integrantes-lista .integrantes-header ion-icon{font-size:.9rem}.area-anotaciones .integrantes-lista .integrantes-items{max-height:180px;overflow-y:auto}.area-anotaciones .integrantes-lista .integrante-item{display:flex;align-items:center;justify-content:space-between;padding:6px 12px;cursor:pointer;transition:all .2s ease;border-bottom:1px solid rgba(15,56,90,.05)}.area-anotaciones .integrantes-lista .integrante-item:hover{background:#0f385a0d}.area-anotaciones .integrantes-lista .integrante-item.seleccionado{background:#3b82f626;border-left:3px solid var(--ion-color-primary)}.area-anotaciones .integrantes-lista .integrante-item.modo-seleccion{cursor:pointer}.area-anotaciones .integrantes-lista .integrante-item.modo-seleccion:hover{background:#ffc1071a}.area-anotaciones .integrantes-lista .integrante-item.ok{background:#10b9811a;border-left:3px solid var(--ion-color-success)}.area-anotaciones .integrantes-lista .integrante-item.solo{background:#ffc1071a;border-left:3px solid var(--ion-color-warning)}.area-anotaciones .integrantes-lista .integrante-item.ausente{background:#ef44441a;border-left:3px solid var(--ion-color-danger)}.area-anotaciones .integrantes-lista .integrante-item.ausente .integrante-nombre{text-decoration:line-through;opacity:.6}.area-anotaciones .integrantes-lista .integrante-item .integrante-nombre{font-size:.8rem;color:var(--azul-oscuro);flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.area-anotaciones .integrantes-lista .integrante-item .badge-estado{font-size:1rem;margin-left:4px}.area-anotaciones .anotaciones-content{flex:1;display:flex;flex-direction:column;padding:12px;gap:8px;overflow-y:auto}.area-anotaciones .anotaciones-content .anotaciones-texto{font-family:monospace;font-size:.75rem;line-height:1.5;white-space:pre-wrap;background:#0f385a0d;padding:8px;border-radius:4px;margin:0;flex:1;color:var(--azul-oscuro)}.area-anotaciones .anotaciones-content ion-button{align-self:flex-end}.area-anotaciones .placeholder-text{color:var(--azul-oscuro);opacity:.5;font-size:.85rem;font-style:italic;margin:0;text-align:center}.rubrica-container-compact{width:100%;height:100%;display:flex;flex-direction:column}.rubrica-container-compact .rubrica-header-compact{display:flex;align-items:center;gap:8px;padding:4px 8px;background:linear-gradient(135deg,var(--azul-oscuro) 0%,#0d2e47 100%);border-radius:4px 4px 0 0}.rubrica-container-compact .rubrica-header-compact .rubrica-nombre{flex:1;color:#fff;font-size:.8rem;font-weight:600}.rubrica-container-compact .rubrica-header-compact .rubrica-points-chip{height:20px;font-size:.65rem}.rubrica-container-compact .rubrica-header-compact .btn-cerrar-rubrica{--padding-start: 4px;--padding-end: 4px;height:24px;color:#fff}.rubrica-container-compact .rubrica-header-compact .btn-cerrar-rubrica ion-icon{font-size:1rem}.rubrica-container-compact .rubrica-content-area{flex:1;overflow-y:auto;background:#fff;border:1px solid rgba(15,56,90,.1);border-top:none;border-radius:0 0 4px 4px;padding:4px}.rubrica-container-full{width:100%;height:100%;display:flex;flex-direction:column;border-radius:4px;overflow:hidden}.rubrica-container-full .rubrica-header-compact{display:flex;align-items:center;gap:8px;padding:6px 12px;background:linear-gradient(135deg,var(--azul-oscuro) 0%,#0d2e47 100%)}.rubrica-container-full .rubrica-header-compact .rubrica-nombre{flex:1;color:#fff;font-size:.85rem;font-weight:600}.rubrica-container-full .rubrica-header-compact .rubrica-points-chip{height:22px;font-size:.7rem}.rubrica-container-full .rubrica-header-compact .btn-cerrar-rubrica{--padding-start: 4px;--padding-end: 4px;height:26px;color:#fff}.rubrica-container-full .rubrica-header-compact .btn-cerrar-rubrica ion-icon{font-size:1.1rem}.rubrica-container-full .rubrica-content-full{flex:1;background:#fff;border:1px solid rgba(15,56,90,.15);border-top:none;padding:4px;overflow-y:auto}@keyframes pulse-arrow{0%,to{transform:translate(0);opacity:1}50%{transform:translate(4px);opacity:.7}}.estudiantes-list .student-row{transition:all .2s ease;cursor:pointer}.estudiantes-list .student-row.selected{background:rgba(var(--ion-color-primary-rgb),.1);border-left:4px solid var(--ion-color-primary)}.estudiantes-list .student-row.selected .student-name{font-weight:600;color:var(--ion-color-primary)}.estudiantes-list .student-row:hover:not(.selected){background:#00000005}.estudiantes-list .student-row .student-info-label .student-name{font-size:.7rem;font-weight:500;color:var(--azul-oscuro);line-height:1.3;transition:all .2s ease}.estudiantes-list .list-header .header-label{font-size:.75rem;font-weight:700;color:var(--azul-oscuro);text-transform:uppercase;letter-spacing:.5px}.estudiantes-list .grade-badge{font-size:.85rem;font-weight:600;min-width:40px;text-align:center}.estudiantes-list .total-chip{font-size:.9rem;font-weight:700}ion-badge[color=medium]{--background: #78909c;--color: #ffffff}.rubrica-header{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-areas:"badge criterio-section controles";align-items:center;padding:12px;background:linear-gradient(135deg,var(--azul-oscuro) 0%,#0d2e47 100%);border-radius:8px 8px 0 0;color:#fff}.rubrica-header .rubrica-info{grid-area:badge;display:flex;justify-content:center;align-items:center}.rubrica-header .criterio-section{grid-area:criterio-section;display:flex;align-items:center;justify-content:center}.rubrica-header .navegacion-controles{grid-area:controles;display:flex;align-items:center;justify-content:flex-end;gap:12px}.rubrica-header .navegacion-controles .rubrica-puntos{font-size:.9rem;font-weight:700;background:var(--azul-claro);color:#fff;padding:4px 10px;border-radius:12px;min-width:60px;text-align:center}.rubrica-header .navegacion-controles .criterio-indicador{font-size:.8rem;font-weight:600;color:#ffffffe6;white-space:nowrap}.rubrica-header .navegacion-controles .acciones-botones{display:flex;gap:6px;align-items:center}.rubrica-header .navegacion-controles .acciones-botones ion-button{--padding-start: 6px;--padding-end: 6px;height:28px;font-size:.8rem}.rubrica-header .navegacion-controles .navegacion-botones{display:flex;gap:4px}.rubrica-header .navegacion-controles .navegacion-botones ion-button{--border-color: rgba(255, 255, 255, .3);--color: #ffffff;--padding-start: 6px;--padding-end: 6px;height:28px}.rubrica-header .navegacion-controles .navegacion-botones ion-button:hover{--background: rgba(255, 255, 255, .1)}.rubrica-header .navegacion-controles .estado-evaluacion-badge{display:flex;align-items:center;gap:8px}.rubrica-header .navegacion-controles .estado-evaluacion-badge .badge-cambios,.rubrica-header .navegacion-controles .estado-evaluacion-badge .badge-guardado{display:flex;align-items:center;font-size:.7rem;font-weight:600;padding:4px 10px;border-radius:12px;white-space:nowrap}.rubrica-header .navegacion-controles .estado-evaluacion-badge .badge-cambios ion-icon,.rubrica-header .navegacion-controles .estado-evaluacion-badge .badge-guardado ion-icon{font-size:.75rem;margin-right:2px}@media (max-width: 767px){.rubrica-header .navegacion-controles .estado-evaluacion-badge .badge-cambios .badge-text,.rubrica-header .navegacion-controles .estado-evaluacion-badge .badge-guardado .badge-text{display:none}}.rubrica-header .navegacion-controles .estado-evaluacion-badge .badge-cambios{--background: #f59e0b;--color: #ffffff;animation:pulse-warning 2s ease-in-out infinite}.rubrica-header .navegacion-controles .estado-evaluacion-badge .badge-guardado{--background: #10b981;--color: #ffffff}.rubrica-header .navegacion-controles .undo-redo-controls{display:flex;align-items:center;gap:4px;background:#ffffff1a;border-radius:8px;padding:2px}.rubrica-header .navegacion-controles .undo-redo-controls ion-button{--color: #ffffff;--padding-start: 6px;--padding-end: 6px;height:28px;margin:0}.rubrica-header .navegacion-controles .undo-redo-controls ion-button:disabled{--color: rgba(255, 255, 255, .3);opacity:.5}.rubrica-header .navegacion-controles .undo-redo-controls ion-button:not(:disabled):hover{--background: rgba(255, 255, 255, .2)}.rubrica-header .navegacion-controles .undo-redo-controls ion-button ion-icon{font-size:1rem}.rubrica-header .navegacion-controles .undo-redo-controls .undo-redo-count{font-size:.7rem;font-weight:600;color:#ffffffe6;padding:0 4px;min-width:30px;text-align:center;white-space:nowrap}@media (max-width: 767px){.rubrica-header .navegacion-controles .undo-redo-controls .undo-redo-count{font-size:.65rem;min-width:25px}}.rubrica-header .entrega-badge{display:inline-block;font-weight:700;font-size:.88rem;padding:4.4px 11px;border-radius:13px;width:fit-content;white-space:nowrap;background:#fff3;color:var(--azul-oscuro);border:1px solid rgba(255,255,255,.3)}.rubrica-header .entrega-badge.entrega-e1{background:linear-gradient(135deg,#4fc3f7,#29b6f6);color:var(--azul-oscuro)}.rubrica-header .entrega-badge.entrega-e2{background:linear-gradient(135deg,#66bb6a,#4caf50);color:var(--azul-oscuro)}.rubrica-header .entrega-badge.entrega-ef{background:linear-gradient(135deg,#ff7043,#ff5722);color:var(--azul-oscuro)}.rubrica-header .criterio-titulo{margin:0;font-size:.95rem;font-weight:600;color:#fff;text-align:center}.criterios-navegacion{background:#f8f9fa;border-bottom:2px solid #e9ecef;padding:0}.criterios-navegacion ion-button{--padding-start: 8px;--padding-end: 8px;height:32px}.criterios-navegacion .btn-editar-rubrica{--background: var(--naranja);--background-hover: #ffc04d;--background-activated: #e69f15;--color: white;font-weight:600}.criterios-navegacion .btn-cancelar-magenta{--background: var(--magenta);--background-hover: #ec0677;--background-activated: #c4055f;--color: white;font-weight:600}.criterio-actual{padding:12px}.criterio-actual .criterio-descripcion{background:#f8f9fa;padding:12px;border-radius:6px;margin-bottom:16px;border-left:4px solid var(--azul-claro)}.criterio-actual .criterio-descripcion p{margin:0;font-size:.9rem;line-height:1.5;color:#495057;font-style:italic}.criterio-actual .aplicar-todos-container{background:#1fb2de1a;padding:10px 12px;border-radius:8px;margin-bottom:16px;border:2px solid var(--azul-claro);display:flex;align-items:center}.criterio-actual .aplicar-todos-container ion-checkbox{margin:0;--size: 20px;--checkbox-background-checked: var(--azul-claro)}.criterio-actual .aplicar-todos-container .checkbox-label{font-weight:600;color:var(--azul-oscuro);font-size:.9rem;margin-left:8px}.nivel-seleccionado-detalle{background:linear-gradient(135deg,#9fc8481a,#9fc8480d);border:2px solid var(--verde);border-radius:8px;padding:16px;margin-top:16px;margin-bottom:16px;box-shadow:0 4px 12px #9fc84833}.nivel-seleccionado-detalle .nivel-seleccionado-titulo{display:flex;align-items:center;gap:8px;font-size:1rem;font-weight:600;color:var(--verde);margin:0 0 12px;padding-bottom:8px;border-bottom:2px solid rgba(159,200,72,.3)}.nivel-seleccionado-detalle .nivel-seleccionado-titulo ion-icon{font-size:1.2rem}.nivel-seleccionado-detalle .nivel-seleccionado-contenido p{margin:8px 0;font-size:.9rem;color:#495057;line-height:1.5}.nivel-seleccionado-detalle .nivel-seleccionado-contenido p strong{color:var(--azul-oscuro);font-weight:600}.nivel-seleccionado-detalle .nivel-seleccionado-contenido .nivel-seleccionado-descripcion{background:#fff;padding:12px;border-radius:6px;margin-top:12px;border-left:4px solid var(--verde);font-size:.95rem;line-height:1.6}.niveles-columnas{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-bottom:16px}.nivel-columna{display:flex;flex-direction:column;padding:12px;background:#fff;border:2px solid #e9ecef;border-radius:8px;cursor:pointer;transition:all .2s ease;min-height:150px}.nivel-columna:hover{border-color:var(--azul-claro);transform:translateY(-2px);box-shadow:0 4px 8px #1fb2de33}.nivel-columna.selected{border-color:var(--verde);background:#9fc8481a;box-shadow:0 4px 12px #9fc8484d}.nivel-columna.disabled{cursor:not-allowed;opacity:.7}.nivel-columna.disabled:hover{border-color:#e9ecef;transform:none;box-shadow:none}.nivel-columna .nivel-header-columna{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px;padding-bottom:8px;border-bottom:1px solid #e9ecef}.nivel-columna .nivel-header-columna h6{font-size:.9rem;font-weight:600;color:var(--azul-oscuro);margin:0;flex:1}.nivel-columna .nivel-header-columna .nivel-puntos-badge{font-size:.85rem;font-weight:700;color:var(--azul-claro);background:#1fb2de26;padding:2px 8px;border-radius:12px;margin-left:8px}.nivel-columna .nivel-descripcion-columna{font-size:.8rem;color:#6c757d;line-height:1.4;margin:0;flex:1}.personalizacion-area{display:grid;grid-template-columns:1fr 2fr;gap:16px;padding:16px;background:#f8f9fa;border-radius:8px;border:1px solid #dee2e6}.personalizacion-area .campo-personalizado{display:flex;flex-direction:column;gap:6px}.personalizacion-area .campo-personalizado label{font-size:.8rem;font-weight:600;color:var(--azul-oscuro)}.personalizacion-area .campo-personalizado ion-input,.personalizacion-area .campo-personalizado ion-textarea{--background: #ffffff;font-size:.85rem}.personalizacion-area .campo-personalizado .comentarios-frecuentes{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}.personalizacion-area .campo-personalizado .comentarios-frecuentes .label-frecuentes{font-size:.75rem;color:#6c757d;width:100%;margin-bottom:4px}.personalizacion-area .campo-personalizado .comentarios-frecuentes ion-chip{--background: rgba(31, 178, 222, .1);--color: var(--azul-oscuro);font-size:.75rem;height:24px;cursor:pointer}.personalizacion-area .campo-personalizado .comentarios-frecuentes ion-chip:hover{--background: rgba(31, 178, 222, .2)}.criterio-actual{padding:16px}.criterio-actual .criterio-titulo{font-size:1.1rem;font-weight:600;color:var(--azul-oscuro);margin:0 0 16px;padding-bottom:8px;border-bottom:2px solid var(--azul-claro)}.criterio-actual .niveles-grid{display:flex;flex-direction:column;gap:12px}.nivel-btn-nuevo{display:flex;flex-direction:column;align-items:stretch;padding:12px;background:#fff;border:2px solid #e9ecef;border-radius:8px;cursor:pointer;transition:all .2s ease;text-align:left}.nivel-btn-nuevo:hover{border-color:var(--azul-claro);transform:translateY(-2px);box-shadow:0 4px 8px #1fb2de33}.nivel-btn-nuevo.selected{border-color:var(--verde);background:#9fc8481a;box-shadow:0 4px 12px #9fc8484d}.nivel-btn-nuevo .nivel-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.nivel-btn-nuevo .nivel-header .nivel-titulo{font-size:.95rem;font-weight:600;color:var(--azul-oscuro)}.nivel-btn-nuevo .nivel-header .nivel-puntos{font-size:1rem;font-weight:700;color:var(--azul-claro);background:#1fb2de1a;padding:2px 8px;border-radius:12px}.nivel-btn-nuevo .nivel-descripcion{font-size:.85rem;color:#6c757d;line-height:1.4;margin:0}.rubrica-seguimiento-area{margin-bottom:20px;padding:12px;background:#f8f9fa;border-radius:8px;border:2px solid var(--azul-claro)}.rubrica-seguimiento-area .rubrica-seguimiento-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #dee2e6}.rubrica-seguimiento-area .rubrica-seguimiento-header .rubrica-seguimiento-titulo{font-size:.9rem;font-weight:600;color:var(--azul-oscuro);margin:0}.rubrica-seguimiento-area .rubrica-seguimiento-header ion-button{--padding-start: 10px;--padding-end: 10px;height:28px;font-size:.75rem}.rubrica-seguimiento-area .rubrica-seguimiento-contenido{max-height:400px;overflow-y:auto}.rubrica-seguimiento-area .rubrica-parrafo{padding:12px;background:#fff;border-left:4px solid var(--verde);margin-bottom:12px;border-radius:4px}.rubrica-seguimiento-area .rubrica-parrafo p{margin:0;font-size:.85rem;line-height:1.5;color:#495057}.rubrica-seguimiento-area .rubrica-parrafo .timestamp-referencia{margin-top:8px;padding-top:8px;border-top:1px solid rgba(0,0,0,.1);font-size:.75rem;color:#6c757d;font-style:italic;text-align:right;-webkit-user-select:none;user-select:none}.rubrica-seguimiento-area .rubrica-parrafo:last-child{margin-bottom:0}@media (max-width: 768px){.layout{flex-direction:column;height:100%;padding:0}.estudiantes-container{width:100%;padding:4px;margin:0;flex:1}.course-label{padding:6px}.course-tab-name{max-width:100px}.estudiantes-table{font-size:.85rem}.estudiantes-table th,.estudiantes-table td{padding:6px 4px}.grupos-container{gap:6px}.grupos-container .grupo-btn{padding:6px 10px;font-size:.85rem}.comentarios-grupo{margin-top:12px;padding:12px}.criterios-navegacion .rubrica-header{flex-direction:column;gap:8px}.criterios-navegacion .rubrica-header .navegacion-controles{flex-wrap:wrap;gap:8px}}@media (max-width: 480px){.layout{flex-direction:column;padding:0;height:100%}.estudiantes-container{width:100%;padding:2px;margin:0;flex:1}.estudiantes-table{font-size:.65rem}.estudiantes-table th,.estudiantes-table td{padding:2px 1px}.estudiantes-table .email-col{display:none}.estudiantes-table .entrega-header{font-size:.6rem;padding:2px;white-space:nowrap}.estudiantes-table .entrega-header .header-text-full{display:none}.estudiantes-table .entrega-header .header-text-short{display:inline;font-weight:700;font-size:.7rem}.course-segment ion-segment-button{min-width:80px}.course-tab-code{font-size:.7rem}.course-tab-name{font-size:.65rem;max-width:80px}.grupos-container .grupo-btn{padding:4px 8px;font-size:.75rem;min-width:35px}.comentarios-grupo{padding:8px}.comentarios-grupo .comentarios-titulo{font-size:.9rem}.comentarios-grupo .comentario-card{padding:8px;font-size:.85rem}.criterios-navegacion{padding:8px}.criterios-navegacion .criterio-titulo{font-size:.85rem}.criterios-navegacion .navegacion-botones ion-button,.criterios-navegacion .acciones-botones ion-button{--padding-start: 6px;--padding-end: 6px;font-size:.75rem}.rubrica-contenedor-tabla .nivel-card{padding:8px}.rubrica-contenedor-tabla .nivel-card .nivel-titulo{font-size:.85rem}.rubrica-contenedor-tabla .nivel-card .nivel-descripcion{font-size:.75rem}}@media (max-width: 960px) and (orientation: landscape){.layout{display:flex;width:100%;height:calc(100vh - 70px);padding:2px}.estudiantes-container{flex:1;width:100%}.estudiantes-table{font-size:.65rem}.estudiantes-table th,.estudiantes-table td{padding:2px 4px;white-space:nowrap}.estudiantes-table th{font-size:.6rem}.estudiantes-table .email-col{display:table-cell;max-width:120px;overflow:hidden;text-overflow:ellipsis}.course-segment ion-segment-button{min-width:60px;padding:2px 4px}.course-tab-code{font-size:.6rem}.course-tab-name{font-size:.55rem;max-width:60px}.grupos-container{gap:4px;padding:4px}.grupos-container .grupo-btn{padding:2px 6px;font-size:.65rem;min-width:30px}.rubrica-contenedor-tabla{font-size:.7rem}.rubrica-contenedor-tabla .nivel-card{padding:4px}.rubrica-contenedor-tabla .nivel-card .nivel-titulo{font-size:.75rem}.rubrica-contenedor-tabla .nivel-card .nivel-descripcion{font-size:.65rem}.criterios-navegacion{padding:4px}.criterios-navegacion .criterio-titulo{font-size:.75rem}.criterios-navegacion .navegacion-botones ion-button,.criterios-navegacion .acciones-botones ion-button{--padding-start: 4px;--padding-end: 4px;font-size:.65rem;height:24px}}@media (max-width: 767px){.rubrica-contenedor-tabla{font-size:.75rem;margin-top:8px}.rubrica-contenedor-tabla .rubrica-header{flex-direction:column;gap:8px;padding:8px}.rubrica-contenedor-tabla .criterio-titulo{font-size:.8rem;line-height:1.2}.rubrica-contenedor-tabla .rubrica-puntos{font-size:.85rem}.rubrica-contenedor-tabla .criterio-indicador{font-size:.75rem}.rubrica-contenedor-tabla .navegacion-botones,.rubrica-contenedor-tabla .acciones-botones{flex-wrap:wrap;gap:4px}.rubrica-contenedor-tabla .navegacion-botones ion-button,.rubrica-contenedor-tabla .acciones-botones ion-button{--padding-start: 8px;--padding-end: 8px;font-size:.7rem!important;height:28px;min-width:60px}.rubrica-contenedor-tabla .nivel-card{padding:8px!important;margin-bottom:6px}.rubrica-contenedor-tabla .nivel-card .nivel-titulo{font-size:.8rem!important;margin-bottom:4px}.rubrica-contenedor-tabla .nivel-card .nivel-descripcion{font-size:.7rem!important;line-height:1.3}.rubrica-contenedor-tabla .nivel-card .nivel-puntos{font-size:.75rem}.rubrica-contenedor-tabla ion-checkbox{--size: 16px}}@media (max-width: 480px){.rubrica-contenedor-tabla{font-size:.7rem}.rubrica-contenedor-tabla .criterio-titulo{font-size:.75rem!important}.rubrica-contenedor-tabla .rubrica-puntos{font-size:.8rem}.rubrica-contenedor-tabla .criterio-indicador{font-size:.7rem}.rubrica-contenedor-tabla .navegacion-botones ion-button,.rubrica-contenedor-tabla .acciones-botones ion-button{font-size:.65rem!important;height:26px;min-width:55px;--padding-start: 6px;--padding-end: 6px}.rubrica-contenedor-tabla .nivel-card{padding:6px!important}.rubrica-contenedor-tabla .nivel-card .nivel-titulo{font-size:.75rem!important}.rubrica-contenedor-tabla .nivel-card .nivel-descripcion{font-size:.65rem!important}.rubrica-contenedor-tabla .nivel-card .nivel-puntos{font-size:.7rem}.rubrica-contenedor-tabla ion-checkbox{--size: 14px}.rubrica-contenedor-tabla .entrega-badge{font-size:.7rem!important;padding:4px 8px}}.mobile-optimized{--padding-top: 5vh}@media (min-width: 1024px){.mobile-optimized{--padding-top: 0}}@media (max-width: 1023px){.layout{flex-direction:row;gap:8px;padding:8px;height:calc(100vh - 60px)}.layout .estudiantes-container{flex:1;min-width:0;padding:4px;margin:0}.layout .seguimiento-panel{display:none}.layout .fab-menu-container{display:none!important}.layout .navegacion-controles .acciones-botones{display:flex!important;flex-wrap:wrap;gap:4px}.layout .navegacion-controles .acciones-botones ion-button{font-size:.65rem;height:28px;min-width:50px;--padding-start: 4px;--padding-end: 4px}.layout .navegacion-controles .navegacion-botones ion-button{font-size:.65rem;height:28px}}@media (min-width: 1024px){.layout{flex-direction:row;padding:0;gap:0}}@media (max-width: 1023px){.table-container{overflow-x:auto;max-height:calc(100vh - 300px)}.table-container table{font-size:.7rem}.estudiantes-table th,.estudiantes-table td{padding:4px 3px;white-space:nowrap;font-size:.7rem}.estudiantes-table th[style*="width: 45px"],.estudiantes-table td:first-child{width:30px!important}.estudiantes-table th[style*="width: 60px"]{width:40px!important}.estudiantes-table .entrega-header{padding:4px;font-size:.7rem}}@media (max-width: 1023px){ion-card{margin:6px 0;border-radius:8px}ion-card ion-card-content{padding:8px}.course-segment ion-segment-button{min-height:40px;font-size:.7rem}.course-segment ion-segment-button .course-label{display:flex;flex-direction:row;gap:4px;align-items:center}.course-segment ion-segment-button .course-label .course-tab-code{font-size:.75rem;font-weight:600}.course-segment ion-segment-button .course-label .course-tab-name{font-size:.65rem;opacity:.8;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100px}}@media (max-width: 1023px){.rubrica-contenedor-tabla{font-size:.7rem;max-height:calc(100vh - 200px);overflow-y:auto}.rubrica-contenedor-tabla .rubrica-header{flex-wrap:wrap;gap:6px;padding:6px}.rubrica-contenedor-tabla .criterio-titulo{font-size:.75rem!important;line-height:1.2}.rubrica-contenedor-tabla .rubrica-puntos{font-size:.75rem}.rubrica-contenedor-tabla .criterio-indicador{font-size:.65rem}.rubrica-contenedor-tabla .navegacion-botones ion-button,.rubrica-contenedor-tabla .acciones-botones ion-button{font-size:.65rem!important;height:28px;min-width:50px;--padding-start: 4px;--padding-end: 4px}.rubrica-contenedor-tabla .nivel-card{padding:6px!important;margin:4px}.rubrica-contenedor-tabla .nivel-card .nivel-titulo{font-size:.7rem!important}.rubrica-contenedor-tabla .nivel-card .nivel-descripcion{font-size:.65rem!important;line-height:1.3}.rubrica-contenedor-tabla .nivel-card .nivel-puntos{font-size:.65rem}.rubrica-contenedor-tabla ion-checkbox{--size: 16px}.rubrica-contenedor-tabla .niveles-columnas{gap:6px}.rubrica-contenedor-tabla .niveles-columnas .nivel-columna{flex:1;min-width:120px}.rubrica-contenedor-tabla .criterio-descripcion{font-size:.7rem;padding:6px;margin:4px 0}.rubrica-contenedor-tabla .aplicar-todos-container{font-size:.7rem;padding:4px}.rubrica-contenedor-tabla .aplicar-todos-container .checkbox-label{font-size:.7rem}}@media (max-width: 1023px){.seguimiento-panel ion-card-content{padding:8px!important}.comentario-item{margin:6px 0;padding:6px;font-size:.7rem}.comentario-header .comentario-fecha{font-size:.65rem}.comentario-texto{font-size:.7rem;line-height:1.3}.rubrica-seguimiento-area{margin:8px 0;font-size:.7rem}.rubrica-seguimiento-area .rubrica-seguimiento-titulo{font-size:.75rem}.rubrica-seguimiento-area .rubrica-parrafo p{font-size:.7rem;line-height:1.3}.nuevo-comentario-area ion-textarea{font-size:.7rem;--padding-start: 8px;--padding-end: 8px}.nuevo-comentario-area ion-button{font-size:.7rem;height:32px}}@media (max-width: 1023px){ion-button{min-height:36px}ion-button[size=small]{min-height:28px}ion-checkbox{--size: 18px;min-width:36px;min-height:36px}.entrega-header{padding:6px;cursor:pointer;transition:background-color .2s ease}.entrega-header:active{background-color:rgba(var(--ion-color-primary-rgb),.1)}ion-input,ion-textarea{font-size:.75rem;--padding-top: 6px;--padding-bottom: 6px}}@media (max-width: 1023px){ion-content{--padding-top: max(5vh, env(safe-area-inset-top));--padding-bottom: env(safe-area-inset-bottom)}@supports (padding: env(safe-area-inset-left)){ion-content{--padding-start: max(8px, env(safe-area-inset-left));--padding-end: max(8px, env(safe-area-inset-right))}}.layout{padding-left:max(8px,env(safe-area-inset-left));padding-right:max(8px,env(safe-area-inset-right))}}.fab-menu-container{display:flex}@media (min-width: 769px){.fab-menu-container{display:none!important}}.fab-menu-container ion-fab-button{--size: var(--fab-size);--box-shadow: 0 4px 16px rgba(0, 0, 0, .2)}.fab-menu-container ion-fab-button ion-icon{font-size:var(--icon-size-fab)!important;transition:all .3s ease}@media (max-width: 768px){.fab-menu-container ion-fab-button{--size: calc(45px + 1.5vw) }.fab-menu-container ion-fab-button ion-icon{font-size:calc(1.1rem + .8vw)!important}}@media (max-width: 480px){.fab-menu-container ion-fab-button{--size: calc(40px + 2vw) }.fab-menu-container ion-fab-button ion-icon{font-size:calc(1rem + 1vw)!important}}@media (max-width: 960px) and (orientation: landscape){.fab-menu-container ion-fab-button{--size: 42px}.fab-menu-container ion-fab-button ion-icon{font-size:1.2rem!important}}.fab-menu-container .fab-option-button ion-icon{font-size:var(--icon-size-button)!important;transition:all .3s ease}@media (max-width: 768px){.fab-menu-container .fab-option-button ion-icon{font-size:calc(.9rem + .5vw)!important}}@media (max-width: 480px){.fab-menu-container .fab-option-button ion-icon{font-size:calc(.8rem + .7vw)!important}}@media (max-width: 960px) and (orientation: landscape){.fab-menu-container .fab-option-button ion-icon{font-size:1rem!important}}@keyframes pulse-warning{0%,to{opacity:1;transform:scale(1)}50%{opacity:.85;transform:scale(1.02)}}@media (prefers-reduced-motion: reduce){*{transition-duration:.01ms!important;animation-duration:.01ms!important}}@media (prefers-color-scheme: dark){.estudiantes-table th,.estudiantes-table td{border-color:#ffffff1a}.nivel-card{background:#ffffff0d;border-color:#ffffff1a}}@media (max-width: 800px){.layout,.layout .estudiantes-container{width:100%!important;padding:0!important;margin:0!important}.layout .seguimiento-panel{display:none}.estudiantes-table{font-size:.65rem!important}.estudiantes-table th,.estudiantes-table td{padding:3px 2px!important}.rubrica-contenedor-tabla{font-size:.65rem!important}.rubrica-contenedor-tabla .nivel-card{padding:4px!important}}.acciones-curso{display:flex;gap:12px;align-items:center;flex-wrap:wrap}.info-estudiantes{margin-left:auto;font-size:.85rem;color:var(--ion-color-medium)}.card-content-compact{padding:12px}.canvas-info-wrapper{display:flex;align-items:center;gap:16px;flex-wrap:wrap}@media (max-width: 767px){.canvas-info-wrapper{flex-direction:column;align-items:flex-start;gap:12px}}.canvas-info-main{display:flex;align-items:center;gap:8px;flex:1;min-width:200px}@media (max-width: 767px){.canvas-info-main{width:100%;min-width:unset}}.canvas-info-text{flex:1}.canvas-info-status{display:flex;align-items:center;gap:12px;flex-shrink:0}@media (max-width: 767px){.canvas-info-status{width:100%;justify-content:space-between}}.text-small-medium{font-size:.8rem;color:var(--ion-color-medium)}.text-extra-small{font-size:.8rem}.column-width-checkbox{width:45px}.column-width-group{width:60px;cursor:pointer}.student-name-small{font-size:.85em;opacity:.9}.checkbox-apply-label{font-size:.75em;margin-left:4px}.icon-small-inline{font-size:.75rem;margin-right:2px}.rubrica-note-text{font-size:.85rem;font-style:italic;color:#6c757d;margin:8px 0 0}.cursor-pointer,.entrega-header-clickable{cursor:pointer}.checkbox-apply{margin-left:12px;--size: 18px}@media (min-width: 800px) and (max-width: 1023px){.layout,.layout .estudiantes-container{width:100%!important;padding:0!important;margin:0!important}.layout .seguimiento-panel{display:none}.estudiantes-table,.rubrica-contenedor-tabla{font-size:.75rem}}.color-picker-popover-wrapper{--width: auto;--max-width: 380px;--min-width: 340px}.color-picker-popover{background:#fff;padding:0;width:100%;max-height:90vh;overflow:visible;border-radius:12px;box-shadow:0 8px 24px #00000026;display:flex;flex-direction:column}.color-picker-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:2px solid #e0e0e0;background:var(--azul-oscuro, #0F385A);border-radius:12px 12px 0 0}.color-picker-header span{font-weight:600;font-size:1rem;color:#fff;display:flex;align-items:center;gap:6px}.color-picker-header ion-button{--padding-start: 8px;--padding-end: 8px;--border-radius: 8px;--background: rgba(255, 255, 255, .1);--color: white;margin:0}.color-picker-header ion-button:hover{--background: rgba(255, 255, 255, .2)}.color-picker-content{padding:12px;background:#fafafa;overflow-y:auto;max-height:calc(90vh - 120px);flex:1}.color-picker-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-bottom:12px;padding:12px;background:#fff;border-radius:8px;border:2px solid #e8e8e8;box-shadow:0 2px 6px #0000000d}.color-option{width:42px;height:42px;border-radius:8px;cursor:pointer;border:3px solid #ddd;transition:all .2s ease;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 4px #0000001a;position:relative}.color-option:hover{transform:scale(1.1);border-color:#999;box-shadow:0 4px 12px #0003;z-index:1}.color-option.selected{border-color:var(--azul-oscuro, #0F385A);border-width:4px;box-shadow:0 0 0 3px #0f385a4d;transform:scale(1.05)}.color-option.selected ion-icon{color:#fff;font-size:24px;filter:drop-shadow(0 2px 4px rgba(0,0,0,.6))}.color-option:active{transform:scale(.95)}.color-picker-input-section{display:flex;flex-direction:column;gap:10px;padding:12px;background:#fff;border-radius:8px;border:2px solid #e0e0e0;box-shadow:0 2px 6px #0000000d}.hex-input-wrapper{display:flex;flex-direction:column;gap:6px}.hex-input-wrapper .hex-label{font-size:.8rem;font-weight:600;color:#555;margin:0}.hex-input-wrapper .hex-hint{margin:0;font-size:.7rem;color:#888;font-style:italic}.hex-input-wrapper .student-name{font-size:.75rem;font-weight:600;color:#2c3e50;margin-bottom:2px;line-height:1.2}.hex-input-wrapper .student-email{font-size:.65rem;color:#7f8c8d;opacity:.85;line-height:1.1}.color-hex-input{width:100%;--background: #f8f9fa;--border-color: #d0d0d0;--border-radius: 6px;--padding-start: 12px;--padding-end: 12px;--padding-top: 8px;--padding-bottom: 8px;font-family:Courier New,monospace;font-size:.9rem;font-weight:600;text-transform:uppercase;letter-spacing:1px}.color-hex-input::part(native){border:2px solid #d0d0d0;transition:all .2s ease}.color-hex-input::part(native):focus{background:#fff;border-color:var(--azul-oscuro, #0F385A);box-shadow:0 0 0 3px #0f385a1a}.color-picker-actions{display:flex;gap:8px;justify-content:flex-end;padding:12px 16px;border-top:2px solid #e0e0e0;background:#fff;border-radius:0 0 12px 12px;flex-shrink:0}.color-picker-actions ion-button{--padding-start: 24px;--padding-end: 24px;--padding-top: 10px;--padding-bottom: 10px;--border-radius: 8px;font-size:.95rem;text-transform:none;font-weight:600}.color-picker-actions ion-button[fill=outline]{--border-width: 2px;--color: #666;--border-color: #ccc}.color-picker-actions ion-button[fill=outline]:hover{--background: #f5f5f5}.color-picker-actions ion-button[fill=solid]{--background: var(--azul-oscuro, #0F385A);box-shadow:0 4px 12px #0f385a4d}.color-picker-actions ion-button[fill=solid]:hover{--background: var(--azul-claro, #1FB2DE);box-shadow:0 6px 16px #1fb2de66}.dashboard-options{margin:16px 0}.dashboard-options ion-card-header{padding:16px;background:linear-gradient(135deg,var(--azul-oscuro) 0%,#0d2e47 100%);border-radius:12px 12px 0 0}.dashboard-options .header-row{display:flex;align-items:center;justify-content:space-between;gap:20px;flex-wrap:wrap}.dashboard-options ion-card-title{color:#fff;font-weight:700;font-size:.75rem;margin:0;letter-spacing:.18px}.dashboard-options .stats-header{display:flex;gap:16px;align-items:center}.dashboard-options .stat-chip{display:flex;align-items:center;gap:10px;background:var(--ion-color-light, #f4f5f8);padding:10px 16px;border-radius:12px;transition:all .2s ease;cursor:default}.dashboard-options .stat-chip:hover{background:var(--ion-color-light-shade, #d7d8da);transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.dashboard-options .stat-chip ion-icon{font-size:1.4rem;flex-shrink:0}.dashboard-options .stat-chip .stat-content{display:flex;flex-direction:column;gap:2px}.dashboard-options .stat-chip .stat-number{font-size:1.3rem;font-weight:700;color:var(--ion-color-dark, var(--azul-oscuro));line-height:1}.dashboard-options .stat-chip .stat-text{font-size:.75rem;color:var(--ion-color-medium, #92949c);font-weight:500;text-transform:uppercase;letter-spacing:.5px;line-height:1}.dashboard-options .dashboard-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.dashboard-options .dashboard-item{background:var(--fondo-componente);padding:20px;border-radius:0;border:2px solid rgba(31,178,222,.2);text-align:center;transition:all .3s ease;display:flex;flex-direction:column;align-items:center;gap:8px}.dashboard-options .dashboard-item:hover{border-color:var(--azul-claro);box-shadow:0 4px 12px #1fb2de33;transform:translateY(-2px)}.dashboard-options .dashboard-item ion-icon{font-size:2.5rem;margin-bottom:8px}.dashboard-options .dashboard-item h3{margin:0;font-size:.95rem;font-weight:600;color:var(--azul-oscuro)}.dashboard-options .dashboard-item p{margin:4px 0 8px;font-size:.85rem;color:var(--texto-secundario);line-height:1.4}.dashboard-options .dashboard-item ion-badge{margin-top:8px}@media (max-width: 992px){.dashboard-options .header-row{flex-direction:column;align-items:flex-start;gap:12px}.dashboard-options .stats-header{width:100%;justify-content:space-between}}@media (max-width: 768px){.dashboard-options .stats-header{gap:8px}.dashboard-options .stat-chip{padding:8px 12px}.dashboard-options .stat-chip ion-icon{font-size:1.2rem}.dashboard-options .stat-chip .stat-number{font-size:1.1rem}.dashboard-options .stat-chip .stat-text{font-size:.7rem}}@media (max-width: 480px){.dashboard-options ion-card-title{font-size:1.1rem}.dashboard-options .stats-header{flex-wrap:wrap;gap:6px}.dashboard-options .stat-chip{flex:1;min-width:calc(50% - 3px);padding:8px 10px}.dashboard-options .stat-chip ion-icon{font-size:1.1rem}.dashboard-options .stat-chip .stat-number{font-size:1rem}.dashboard-options .stat-chip .stat-text{font-size:.65rem}.dashboard-options .dashboard-grid{grid-template-columns:1fr}.dashboard-options .dashboard-item{padding:16px}.dashboard-options .dashboard-item ion-icon{font-size:2rem}.dashboard-options .dashboard-item h3{font-size:.9rem}}.dashboard-options .header-con-toggle{display:flex;flex-direction:row;align-items:center;justify-content:flex-start;padding:2px 8px!important;gap:6px;min-height:24px}.dashboard-options .header-con-toggle .info-icon-header{display:inline-flex;align-items:center;justify-content:center}.dashboard-options .header-con-toggle .info-icon-header .header-info-icon{font-size:1rem;color:#fff}.dashboard-options .header-con-toggle .grupo-header-inline{display:flex;align-items:center;gap:8px;color:#fff}.dashboard-options .header-con-toggle .grupo-header-inline ion-icon{font-size:1.2rem;color:var(--azul-claro, #1fb2de)}.dashboard-options .header-con-toggle .grupo-header-inline .grupo-nombre{font-weight:700;font-size:1rem}.dashboard-options .header-con-toggle .grupo-header-inline .integrantes-count{font-size:.8rem;opacity:.85}.dashboard-options .modo-vista-toggle{display:inline-flex;align-items:center;justify-content:center;width:22px;height:22px;background:#ffffff26;border-radius:50%;border:1px solid rgba(255,255,255,.2);cursor:pointer;transition:all .2s ease;flex-shrink:0}.dashboard-options .modo-vista-toggle:hover{background:#ffffff40;transform:scale(1.1)}.dashboard-options .modo-vista-toggle:active{transform:scale(.95)}.dashboard-options .modo-vista-toggle .lock-icon{font-size:.8rem;color:#fff;transition:all .2s ease}.dashboard-options .entregas-matrix-container{overflow-x:auto;margin:0;padding:0}.dashboard-options .entregas-matrix{width:100%;border-collapse:collapse;font-size:.7rem;box-shadow:0 1px 3px #0000000f;border-radius:4px;overflow:hidden}.dashboard-options .entregas-matrix thead{background:linear-gradient(135deg,var(--azul-oscuro) 0%,#0d2e47 100%);color:#fff}.dashboard-options .entregas-matrix thead .header-entrega,.dashboard-options .entregas-matrix thead .header-grupo{padding:4px 6px;text-align:center;font-weight:600;font-size:.65rem;letter-spacing:.2px;border-right:1px solid rgba(255,255,255,.15)}.dashboard-options .entregas-matrix thead .header-entrega{text-align:center;padding-left:8px;min-width:50px}.dashboard-options .entregas-matrix thead .header-entrega .header-icon{color:#fff;font-size:1rem}.dashboard-options .entregas-matrix thead .header-grupo{min-width:40px}.dashboard-options .entregas-matrix thead .header-grupo.header-clickable{cursor:pointer;transition:all .2s ease}.dashboard-options .entregas-matrix thead .header-grupo.header-clickable:hover{background:#ffffff26;transform:scale(1.05)}.dashboard-options .entregas-matrix thead th:last-child{border-right:none}.dashboard-options .entregas-matrix tbody tr{border-bottom:1px solid #e9ecef}.dashboard-options .entregas-matrix tbody tr:last-child{border-bottom:none}.dashboard-options .entregas-matrix tbody tr:hover{background-color:#0f385a05}.dashboard-options .entregas-matrix tbody .label-entrega{text-align:left;padding:6px 8px;font-weight:700;color:var(--azul-oscuro);background-color:#f8f9fa;cursor:default;font-size:.7rem;border-right:1px solid #dee2e6}.dashboard-options .entregas-matrix tbody .cell-estado{padding:4px;text-align:center;border-right:1px solid #e9ecef;transition:all .25s ease;cursor:pointer;position:relative;min-height:28px}.dashboard-options .entregas-matrix tbody .cell-estado:last-child{border-right:none}.dashboard-options .entregas-matrix tbody .cell-estado.estado-pendiente{background-color:#ffe5e5}.dashboard-options .entregas-matrix tbody .cell-estado.estado-pendiente:hover{background-color:#ffd0d0;transform:scale(1.05);box-shadow:0 2px 6px #c41e3a33}.dashboard-options .entregas-matrix tbody .cell-estado.estado-pendiente .estado-indicator:before{content:"\\25cf";color:#c41e3a;font-size:1rem;font-weight:600}.dashboard-options .entregas-matrix tbody .cell-estado.estado-parcial{background-color:#fff9e5}.dashboard-options .entregas-matrix tbody .cell-estado.estado-parcial:hover{background-color:#fff3d0;transform:scale(1.05);box-shadow:0 2px 6px #c803}.dashboard-options .entregas-matrix tbody .cell-estado.estado-parcial .estado-indicator:before{content:"\\25d0";color:#c80;font-size:1rem;font-weight:600}.dashboard-options .entregas-matrix tbody .cell-estado.estado-completo{background-color:#e5f9f0}.dashboard-options .entregas-matrix tbody .cell-estado.estado-completo:hover{background-color:#d0f5e5;transform:scale(1.05);box-shadow:0 2px 6px #3963}.dashboard-options .entregas-matrix tbody .cell-estado.estado-completo .estado-indicator:before{content:"\\2713";color:var(--verde);font-size:1rem;font-weight:700}.dashboard-options .entregas-matrix tbody .estado-indicator{display:inline-block}@media (max-width: 768px){.dashboard-options .entregas-matrix{font-size:.6rem}.dashboard-options .entregas-matrix thead .header-entrega,.dashboard-options .entregas-matrix thead .header-grupo{padding:3px 4px;font-size:.55rem}.dashboard-options .entregas-matrix thead .header-entrega{min-width:60px}.dashboard-options .entregas-matrix thead .header-entrega .header-icon{font-size:1rem}.dashboard-options .entregas-matrix thead .header-grupo{min-width:45px}.dashboard-options .entregas-matrix tbody .label-entrega{padding:8px 10px;font-size:.7rem}.dashboard-options .entregas-matrix tbody .cell-estado{padding:8px 6px;min-height:38px}.dashboard-options .entregas-matrix tbody .cell-estado .estado-indicator:before{font-size:1rem}}.dashboard-options .panel-section-card{margin-bottom:0;height:100%;max-height:450px;display:flex;flex-direction:column}.dashboard-options .panel-section-card .section-header-ionic{padding:6px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-left:2px solid var(--azul-claro)}.dashboard-options .panel-section-card .section-header-ionic ion-card-subtitle{display:flex;align-items:center;gap:4px;margin:0;padding:0;font-size:.52rem;font-weight:600;color:var(--azul-oscuro)}.dashboard-options .panel-section-card .section-header-ionic ion-card-subtitle ion-icon{font-size:.75rem;flex-shrink:0}.dashboard-options .panel-section-card .section-header-ionic ion-card-subtitle ion-text{flex:1;font-weight:600}.dashboard-options .panel-section-card .section-header-ionic ion-card-subtitle ion-badge{font-weight:700;font-size:.46rem}.dashboard-options .panel-section-card ion-card-content{background:var(--ion-color-light, #f4f5f8);min-height:60px;max-height:380px;overflow-y:auto;padding:8px;flex:1}.dashboard-options .panel-section-card ion-card-content .grupos-list,.dashboard-options .panel-section-card ion-card-content .casos-especiales-list{background:transparent;padding:0}.dashboard-options .panel-section-card ion-card-content .grupos-list .placeholder-item,.dashboard-options .panel-section-card ion-card-content .casos-especiales-list .placeholder-item{--background: white;--border-radius: 4px;--padding-start: 8px;--padding-end: 8px;margin-bottom:0;box-shadow:0 .6px 1.8px #0000000d}.dashboard-options .panel-section-card ion-card-content .grupos-list .placeholder-item ion-icon,.dashboard-options .panel-section-card ion-card-content .casos-especiales-list .placeholder-item ion-icon{font-size:1rem}.dashboard-options .panel-section-card ion-card-content .grupos-list .placeholder-item ion-label p,.dashboard-options .panel-section-card ion-card-content .casos-especiales-list .placeholder-item ion-label p{margin:1px 0;font-size:.5rem;line-height:1.3}.dashboard-options .panel-section-card ion-card-content .grupos-list .placeholder-item ion-label p:first-child,.dashboard-options .panel-section-card ion-card-content .casos-especiales-list .placeholder-item ion-label p:first-child{font-weight:600}.dashboard-options .grupo-especifico-card{margin:0}.dashboard-options .grupo-especifico-card ion-card-content{min-height:60px;padding:0}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table{width:100%;overflow-x:auto}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table ion-grid{padding:0}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .estudiantes-list .list-header{background:var(--ion-color-light);border-bottom:2px solid var(--ion-color-medium);font-weight:600}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .estudiantes-list .list-header .header-label{font-size:.75rem;text-transform:uppercase;letter-spacing:.5px;color:var(--ion-color-dark)}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .estudiantes-list .student-row{cursor:pointer;transition:background-color .2s;min-height:48px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .estudiantes-list .student-row:hover{background-color:var(--ion-color-light)}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .estudiantes-list .student-row .student-info-label{flex:1;min-width:0}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .estudiantes-list .student-row .student-name{font-size:.85rem;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .estudiantes-list .student-row ion-badge.grade-badge{min-width:45px;max-width:45px;text-align:center;font-size:.8rem;margin-left:4px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .estudiantes-list .student-row ion-chip.total-chip{min-width:50px;max-width:50px;height:24px;font-size:.85rem;font-weight:600;margin-left:4px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .estudiantes-list .student-row ion-chip.total-chip ion-label{margin:0}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-header{background:linear-gradient(135deg,var(--azul-oscuro) 0%,var(--azul-claro) 100%);border-bottom:2px solid var(--azul-oscuro);padding:7.2px 0}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-header .header-cell{display:flex;align-items:center;justify-content:center;gap:3.6px;padding:4.8px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-header .header-cell ion-icon{font-size:.72rem}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-header .header-cell ion-text{color:#fff;font-size:.54rem;font-weight:600;text-transform:uppercase;letter-spacing:.3px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-header .header-cell:first-child{justify-content:flex-start;padding-left:9.6px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row{border-bottom:1px solid var(--ion-color-light-shade, #e0e0e0);transition:background-color .2s ease}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row:hover{background-color:var(--ion-color-light, #f4f5f8)}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row:last-child{border-bottom:none}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell{padding:7.2px 4.8px;display:flex;align-items:center;justify-content:center}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell:first-child{justify-content:flex-start;padding-left:9.6px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell .estudiante-info{display:flex;align-items:center;gap:6px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell .estudiante-info ion-icon{font-size:1.2rem;flex-shrink:0}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell .estudiante-info div{display:flex;flex-direction:column;gap:1.2px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell .estudiante-info div .estudiante-nombre{font-size:.54rem;font-weight:600;color:var(--azul-oscuro);line-height:1.1}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell .estudiante-info div .estudiante-email{font-size:.45rem;color:var(--ion-color-medium);line-height:1.1}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell ion-badge{font-size:.54rem;font-weight:600;padding:3.6px 7.2px;min-width:30px;text-align:center}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell ion-chip{margin:0;font-size:.6rem;font-weight:700;min-width:36px;justify-content:center}@media (max-width: 768px){.dashboard-options .panel-section-card{margin-bottom:9.6px}.dashboard-options .panel-section-card .section-header-ionic{padding:6px}.dashboard-options .panel-section-card .section-header-ionic ion-card-subtitle{gap:3.6px;font-size:.51rem}.dashboard-options .panel-section-card .section-header-ionic ion-card-subtitle ion-icon{font-size:.72rem}.dashboard-options .panel-section-card .section-header-ionic ion-card-subtitle ion-badge{font-size:.45rem}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-header .header-cell{padding:3.6px 2.4px;font-size:.45rem}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-header .header-cell ion-icon{font-size:.6rem}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-header .header-cell ion-text{font-size:.45rem}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-header .header-cell:first-child{padding-left:4.8px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell{padding:4.8px 2.4px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell:first-child{padding-left:4.8px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell .estudiante-info{gap:3.6px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell .estudiante-info ion-icon{font-size:.9rem}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell .estudiante-info div .estudiante-nombre{font-size:.48rem}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell .estudiante-info div .estudiante-email{font-size:.42rem}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell ion-badge{font-size:.45rem;padding:2.4px 4.8px;min-width:24px}.dashboard-options .grupo-especifico-card .calificaciones-grupo-table .table-row .data-cell ion-chip{font-size:.51rem;min-width:30px}.dashboard-options .grupo-info-card ion-card-content{padding:18px 9px}.dashboard-options .grupo-info-card ion-card-content ion-text h2{font-size:.72rem}}.grupos-list{background:transparent;padding:0}.grupos-list.compact .grupo-item{--min-height: 32px;--padding-start: 6px;--padding-end: 6px;--padding-top: 4px;--padding-bottom: 4px;margin-bottom:4px}.grupos-list.compact .grupo-item:hover{--background: #f8f9fa}.grupos-list.compact .grupo-item ion-label{margin:0}.grupos-list.compact .grupo-item .grupo-header{display:flex;align-items:center;gap:6px;font-size:.5rem}.grupos-list.compact .grupo-item .grupo-header .grupo-numero{font-weight:700;color:var(--azul-oscuro);min-width:22px;font-size:.55rem}.grupos-list.compact .grupo-item .grupo-header .grupo-integrantes{font-size:.48rem;color:#6c757d;min-width:18px}.grupos-list.compact .grupo-item .grupo-header .entregas-inline{display:flex;gap:var(--spacing-xs);flex:1}.grupos-list.compact .grupo-item .grupo-header .entregas-inline .mini-badge{font-size:var(--badge-size);padding:1px var(--spacing-xs);height:clamp(16px,4vw,18px);min-width:clamp(24px,5vw,26px);font-weight:600}.grupos-list.compact .grupo-item .grupo-header .porcentaje-badge{font-size:var(--badge-size);padding:var(--spacing-xs) var(--spacing-sm);height:clamp(18px,4.5vw,20px);min-width:clamp(32px,7vw,36px);font-weight:700}.grupos-list.compact .placeholder-item{--min-height: clamp(44px, 10vw, 50px);--padding-top: var(--spacing-md);--padding-bottom: var(--spacing-md);border:1px dashed #dee2e6;border-radius:6px;margin:var(--spacing-xs)}.grupos-list.compact .placeholder-item ion-label p{font-size:var(--fs-sm);margin:0}.grupos-list ion-item{--background: white;--padding-start: 12px;--padding-end: 12px;--min-height: 60px;border-bottom:1px solid #e9ecef;transition:all .2s ease}.grupos-list ion-item:hover{--background: #f8f9fa;transform:translate(4px)}.grupos-list ion-item:last-child{border-bottom:none}.grupos-list ion-item ion-label h3{font-weight:600;font-size:.95rem;color:var(--azul-oscuro);margin:0 0 4px}.grupos-list ion-item ion-label p{font-size:.8rem;color:#6c757d;margin:2px 0}.grupos-list ion-item ion-label .entregas-status{display:flex;gap:4px;margin-top:6px}.grupos-list ion-item ion-label .entregas-status .entrega-badge{font-size:.7rem;padding:2px 6px;min-width:32px;text-align:center;font-weight:600}.grupos-list ion-item ion-chip{font-size:.75rem;font-weight:600;height:26px;min-width:60px}.grupos-list .placeholder-item{--background: #f8f9fa;--min-height: 80px;border:1px dashed #dee2e6;border-radius:8px;margin:8px 0}.grupos-list .placeholder-item ion-icon{font-size:1.5rem;opacity:.6}.grupos-list .placeholder-item ion-label p{font-size:.85rem;line-height:1.4;margin:4px 0}.course-menu-btn{--padding-start: 6px;--padding-end: 6px;--border-radius: 8px;margin:0 0 0 8px;min-width:32px;height:32px}.course-menu-btn:hover{--background: rgba(0, 0, 0, .06)}.course-menu-btn ion-icon{font-size:20px;color:#666}.estudiantes-list{background:transparent;padding:0}.estudiantes-list .list-header{--background: var(--azul-oscuro);--color: white;--padding-start: 12px;--padding-end: 12px;--min-height: 40px;font-weight:600;font-size:.75rem}.estudiantes-list .list-header .header-label{font-size:.75rem;font-weight:600;margin:0}.estudiantes-list .list-header .header-label ion-icon{font-size:1rem;margin-bottom:2px}.estudiantes-list .list-header .header-label div{margin-top:2px}.estudiantes-list .student-row{--background: white;--padding-start: 12px;--padding-end: 12px;--min-height: 50px;border-bottom:1px solid #e0e0e0;cursor:pointer}.estudiantes-list .student-row:hover{--background: #f5f5f5}.estudiantes-list .student-row .student-info-label{flex:1;max-width:45%}.estudiantes-list .student-row .grade-badge{margin:0 4px;min-width:45px;text-align:center;font-weight:600}.estudiantes-list .student-row .total-chip{margin:0;height:28px;min-width:40px}.panel-section-card{margin:var(--spacing-sm) 0;box-shadow:0 2px 8px #00000014}.panel-section-card.compact{margin:var(--spacing-xs) 0}.panel-section-card.compact .section-header-ionic{padding:var(--spacing-sm) var(--spacing-md)}.panel-section-card.compact .section-header-ionic ion-card-subtitle{font-size:var(--fs-sm)}.panel-section-card.compact .section-header-ionic ion-card-subtitle ion-icon{font-size:var(--fs-lg)}.panel-section-card.compact .section-header-ionic ion-card-subtitle ion-badge{font-size:var(--badge-size);padding:var(--spacing-xs) var(--spacing-sm)}.panel-section-card .section-header-ionic{padding:var(--spacing-md);background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-bottom:2px solid #dee2e6}.panel-section-card .section-header-ionic ion-card-subtitle{display:flex;align-items:center;gap:var(--spacing-sm);margin:0;font-size:var(--fs-md);font-weight:600}.panel-section-card .section-header-ionic ion-card-subtitle ion-icon{font-size:var(--fs-xl)}.panel-section-card .section-header-ionic ion-card-subtitle ion-text{flex:1;font-weight:600}.panel-section-card .section-header-ionic ion-card-subtitle ion-badge{font-size:var(--badge-size);font-weight:700}.panel-section-card ion-card-content{padding:0}
`],encapsulation:2,changeDetection:0});let c=b;return c})();export{Tt as InicioPage};
